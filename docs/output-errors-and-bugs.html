<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2 Output, Errors, and Bugs | Intermediate R</title>
  <meta name="description" content="2 Output, Errors, and Bugs | Intermediate R" />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="2 Output, Errors, and Bugs | Intermediate R" />
  <meta property="og:type" content="book" />
  
  
  <meta name="github-repo" content="ucdavisdatalab/workshop_intermediate_r" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2 Output, Errors, and Bugs | Intermediate R" />
  
  
  

<meta name="author" content="Nick Ulle and Wesley Brooks" />


<meta name="date" content="2023-04-19" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="language-fundamentals.html"/>
<link rel="next" href="string-date-processing.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://datalab.ucdavis.edu/">
  <img src="https://datalab.ucdavis.edu/wp-content/uploads/2019/07/datalab-logo-full-color-rgb-1.png" style="height: 100%; width: 100%; object-fit: contain" />
</a></li>
<li><a href="./" style="font-size: 18px">Intermediate R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Overview</a></li>
<li class="part"><span><b>I Thinking in R</b></span></li>
<li class="chapter" data-level="1" data-path="language-fundamentals.html"><a href="language-fundamentals.html"><i class="fa fa-check"></i><b>1</b> Language Fundamentals</a>
<ul>
<li class="chapter" data-level="1.1" data-path="language-fundamentals.html"><a href="language-fundamentals.html#variables-environments"><i class="fa fa-check"></i><b>1.1</b> Variables &amp; Environments</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="language-fundamentals.html"><a href="language-fundamentals.html#whats-an-environment"><i class="fa fa-check"></i><b>1.1.1</b> What’s an Environment?</a></li>
<li class="chapter" data-level="1.1.2" data-path="language-fundamentals.html"><a href="language-fundamentals.html#reference-objects"><i class="fa fa-check"></i><b>1.1.2</b> Reference Objects</a></li>
<li class="chapter" data-level="1.1.3" data-path="language-fundamentals.html"><a href="language-fundamentals.html#the-local-environment"><i class="fa fa-check"></i><b>1.1.3</b> The Local Environment</a></li>
<li class="chapter" data-level="1.1.4" data-path="language-fundamentals.html"><a href="language-fundamentals.html#call-environments"><i class="fa fa-check"></i><b>1.1.4</b> Call Environments</a></li>
<li class="chapter" data-level="1.1.5" data-path="language-fundamentals.html"><a href="language-fundamentals.html#lexical-scoping"><i class="fa fa-check"></i><b>1.1.5</b> Lexical Scoping</a></li>
<li class="chapter" data-level="1.1.6" data-path="language-fundamentals.html"><a href="language-fundamentals.html#variable-lookup"><i class="fa fa-check"></i><b>1.1.6</b> Variable Lookup</a></li>
<li class="chapter" data-level="1.1.7" data-path="language-fundamentals.html"><a href="language-fundamentals.html#the-search-path"><i class="fa fa-check"></i><b>1.1.7</b> The Search Path</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="language-fundamentals.html"><a href="language-fundamentals.html#closures"><i class="fa fa-check"></i><b>1.2</b> Closures</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="language-fundamentals.html"><a href="language-fundamentals.html#tidy-closures"><i class="fa fa-check"></i><b>1.2.1</b> Tidy Closures</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="language-fundamentals.html"><a href="language-fundamentals.html#attributes"><i class="fa fa-check"></i><b>1.3</b> Attributes</a></li>
<li class="chapter" data-level="1.4" data-path="language-fundamentals.html"><a href="language-fundamentals.html#s3"><i class="fa fa-check"></i><b>1.4</b> S3</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="language-fundamentals.html"><a href="language-fundamentals.html#method-dispatch"><i class="fa fa-check"></i><b>1.4.1</b> Method Dispatch</a></li>
<li class="chapter" data-level="1.4.2" data-path="language-fundamentals.html"><a href="language-fundamentals.html#creating-objects"><i class="fa fa-check"></i><b>1.4.2</b> Creating Objects</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="language-fundamentals.html"><a href="language-fundamentals.html#other-object-systems"><i class="fa fa-check"></i><b>1.5</b> Other Object Systems</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="output-errors-and-bugs.html"><a href="output-errors-and-bugs.html"><i class="fa fa-check"></i><b>2</b> Output, Errors, and Bugs</a>
<ul>
<li class="chapter" data-level="2.1" data-path="output-errors-and-bugs.html"><a href="output-errors-and-bugs.html#printing-output"><i class="fa fa-check"></i><b>2.1</b> Printing Output</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="output-errors-and-bugs.html"><a href="output-errors-and-bugs.html#the-print-function"><i class="fa fa-check"></i><b>2.1.1</b> The <code>print</code> Function</a></li>
<li class="chapter" data-level="2.1.2" data-path="output-errors-and-bugs.html"><a href="output-errors-and-bugs.html#the-message-function"><i class="fa fa-check"></i><b>2.1.2</b> The <code>message</code> Function</a></li>
<li class="chapter" data-level="2.1.3" data-path="output-errors-and-bugs.html"><a href="output-errors-and-bugs.html#the-cat-function"><i class="fa fa-check"></i><b>2.1.3</b> The <code>cat</code> Function</a></li>
<li class="chapter" data-level="2.1.4" data-path="output-errors-and-bugs.html"><a href="output-errors-and-bugs.html#formatting-output"><i class="fa fa-check"></i><b>2.1.4</b> Formatting Output</a></li>
<li class="chapter" data-level="2.1.5" data-path="output-errors-and-bugs.html"><a href="output-errors-and-bugs.html#logging-output"><i class="fa fa-check"></i><b>2.1.5</b> Logging Output</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="output-errors-and-bugs.html"><a href="output-errors-and-bugs.html#the-conditions-system"><i class="fa fa-check"></i><b>2.2</b> The Conditions System</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="output-errors-and-bugs.html"><a href="output-errors-and-bugs.html#raising-conditions"><i class="fa fa-check"></i><b>2.2.1</b> Raising Conditions</a></li>
<li class="chapter" data-level="2.2.2" data-path="output-errors-and-bugs.html"><a href="output-errors-and-bugs.html#handling-conditions"><i class="fa fa-check"></i><b>2.2.2</b> Handling Conditions</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="output-errors-and-bugs.html"><a href="output-errors-and-bugs.html#global-options"><i class="fa fa-check"></i><b>2.3</b> Global Options</a></li>
<li class="chapter" data-level="2.4" data-path="output-errors-and-bugs.html"><a href="output-errors-and-bugs.html#debugging"><i class="fa fa-check"></i><b>2.4</b> Debugging</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="output-errors-and-bugs.html"><a href="output-errors-and-bugs.html#other-functions"><i class="fa fa-check"></i><b>2.4.1</b> Other Functions</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="output-errors-and-bugs.html"><a href="output-errors-and-bugs.html#measuring-performance"><i class="fa fa-check"></i><b>2.5</b> Measuring Performance</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="output-errors-and-bugs.html"><a href="output-errors-and-bugs.html#estimating-memory-usage"><i class="fa fa-check"></i><b>2.5.1</b> Estimating Memory Usage</a></li>
<li class="chapter" data-level="2.5.2" data-path="output-errors-and-bugs.html"><a href="output-errors-and-bugs.html#benchmarking"><i class="fa fa-check"></i><b>2.5.2</b> Benchmarking</a></li>
<li class="chapter" data-level="2.5.3" data-path="output-errors-and-bugs.html"><a href="output-errors-and-bugs.html#profiling"><i class="fa fa-check"></i><b>2.5.3</b> Profiling</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Cleaning Data &amp; Automating Tasks</b></span></li>
<li class="chapter" data-level="3" data-path="string-date-processing.html"><a href="string-date-processing.html"><i class="fa fa-check"></i><b>3</b> String &amp; Date Processing</a>
<ul>
<li class="chapter" data-level="3.1" data-path="string-date-processing.html"><a href="string-date-processing.html#the-tidyverse"><i class="fa fa-check"></i><b>3.1</b> The Tidyverse</a></li>
<li class="chapter" data-level="3.2" data-path="string-date-processing.html"><a href="string-date-processing.html#parsing-dates-times"><i class="fa fa-check"></i><b>3.2</b> Parsing Dates &amp; Times</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="string-date-processing.html"><a href="string-date-processing.html#the-lubridate-package"><i class="fa fa-check"></i><b>3.2.1</b> The lubridate Package</a></li>
<li class="chapter" data-level="3.2.2" data-path="string-date-processing.html"><a href="string-date-processing.html#case-study-ocean-temperatures"><i class="fa fa-check"></i><b>3.2.2</b> Case Study: Ocean Temperatures</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="string-date-processing.html"><a href="string-date-processing.html#string-fundamentals"><i class="fa fa-check"></i><b>3.3</b> String Fundamentals</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="string-date-processing.html"><a href="string-date-processing.html#printing"><i class="fa fa-check"></i><b>3.3.1</b> Printing</a></li>
<li class="chapter" data-level="3.3.2" data-path="string-date-processing.html"><a href="string-date-processing.html#escape-sequences-1"><i class="fa fa-check"></i><b>3.3.2</b> Escape Sequences</a></li>
<li class="chapter" data-level="3.3.3" data-path="string-date-processing.html"><a href="string-date-processing.html#raw-strings"><i class="fa fa-check"></i><b>3.3.3</b> Raw Strings</a></li>
<li class="chapter" data-level="3.3.4" data-path="string-date-processing.html"><a href="string-date-processing.html#character-encodings"><i class="fa fa-check"></i><b>3.3.4</b> Character Encodings</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="string-date-processing.html"><a href="string-date-processing.html#processing-strings"><i class="fa fa-check"></i><b>3.4</b> Processing Strings</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="string-date-processing.html"><a href="string-date-processing.html#the-stringr-package"><i class="fa fa-check"></i><b>3.4.1</b> The stringr Package</a></li>
<li class="chapter" data-level="3.4.2" data-path="string-date-processing.html"><a href="string-date-processing.html#regular-expressions"><i class="fa fa-check"></i><b>3.4.2</b> Regular Expressions</a></li>
<li class="chapter" data-level="3.4.3" data-path="string-date-processing.html"><a href="string-date-processing.html#replacing-parts-of-strings"><i class="fa fa-check"></i><b>3.4.3</b> Replacing Parts of Strings</a></li>
<li class="chapter" data-level="3.4.4" data-path="string-date-processing.html"><a href="string-date-processing.html#splitting-strings"><i class="fa fa-check"></i><b>3.4.4</b> Splitting Strings</a></li>
<li class="chapter" data-level="3.4.5" data-path="string-date-processing.html"><a href="string-date-processing.html#extracting-matches"><i class="fa fa-check"></i><b>3.4.5</b> Extracting Matches</a></li>
<li class="chapter" data-level="3.4.6" data-path="string-date-processing.html"><a href="string-date-processing.html#case-study-u.s.-warehouse-stocks"><i class="fa fa-check"></i><b>3.4.6</b> Case Study: U.S. Warehouse Stocks</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="string-date-processing.html"><a href="string-date-processing.html#regular-expression-examples"><i class="fa fa-check"></i><b>3.5</b> Regular Expression Examples</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="string-date-processing.html"><a href="string-date-processing.html#the-wildcard"><i class="fa fa-check"></i><b>3.5.1</b> The Wildcard</a></li>
<li class="chapter" data-level="3.5.2" data-path="string-date-processing.html"><a href="string-date-processing.html#escape-sequences-2"><i class="fa fa-check"></i><b>3.5.2</b> Escape Sequences</a></li>
<li class="chapter" data-level="3.5.3" data-path="string-date-processing.html"><a href="string-date-processing.html#anchors"><i class="fa fa-check"></i><b>3.5.3</b> Anchors</a></li>
<li class="chapter" data-level="3.5.4" data-path="string-date-processing.html"><a href="string-date-processing.html#character-classes"><i class="fa fa-check"></i><b>3.5.4</b> Character Classes</a></li>
<li class="chapter" data-level="3.5.5" data-path="string-date-processing.html"><a href="string-date-processing.html#quantifiers"><i class="fa fa-check"></i><b>3.5.5</b> Quantifiers</a></li>
<li class="chapter" data-level="3.5.6" data-path="string-date-processing.html"><a href="string-date-processing.html#groups"><i class="fa fa-check"></i><b>3.5.6</b> Groups</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="reshaping-data-automating-tasks.html"><a href="reshaping-data-automating-tasks.html"><i class="fa fa-check"></i><b>4</b> Reshaping Data &amp; Automating Tasks</a>
<ul>
<li class="chapter" data-level="4.1" data-path="reshaping-data-automating-tasks.html"><a href="reshaping-data-automating-tasks.html#tidy-datasets"><i class="fa fa-check"></i><b>4.1</b> Tidy Datasets</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="reshaping-data-automating-tasks.html"><a href="reshaping-data-automating-tasks.html#the-tidyr-package"><i class="fa fa-check"></i><b>4.1.1</b> The tidyr Package</a></li>
<li class="chapter" data-level="4.1.2" data-path="reshaping-data-automating-tasks.html"><a href="reshaping-data-automating-tasks.html#rows-into-columns"><i class="fa fa-check"></i><b>4.1.2</b> Rows into Columns</a></li>
<li class="chapter" data-level="4.1.3" data-path="reshaping-data-automating-tasks.html"><a href="reshaping-data-automating-tasks.html#columns-into-rows"><i class="fa fa-check"></i><b>4.1.3</b> Columns into Rows</a></li>
<li class="chapter" data-level="4.1.4" data-path="reshaping-data-automating-tasks.html"><a href="reshaping-data-automating-tasks.html#separating-values"><i class="fa fa-check"></i><b>4.1.4</b> Separating Values</a></li>
<li class="chapter" data-level="4.1.5" data-path="reshaping-data-automating-tasks.html"><a href="reshaping-data-automating-tasks.html#case-study-smart-ridership"><i class="fa fa-check"></i><b>4.1.5</b> Case Study: SMART Ridership</a></li>
<li class="chapter" data-level="4.1.6" data-path="reshaping-data-automating-tasks.html"><a href="reshaping-data-automating-tasks.html#without-tidyr"><i class="fa fa-check"></i><b>4.1.6</b> Without tidyr</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="reshaping-data-automating-tasks.html"><a href="reshaping-data-automating-tasks.html#iteration-strategies"><i class="fa fa-check"></i><b>4.2</b> Iteration Strategies</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="reshaping-data-automating-tasks.html"><a href="reshaping-data-automating-tasks.html#for-loops"><i class="fa fa-check"></i><b>4.2.1</b> For-loops</a></li>
<li class="chapter" data-level="4.2.2" data-path="reshaping-data-automating-tasks.html"><a href="reshaping-data-automating-tasks.html#while-loops"><i class="fa fa-check"></i><b>4.2.2</b> While-loops</a></li>
<li class="chapter" data-level="4.2.3" data-path="reshaping-data-automating-tasks.html"><a href="reshaping-data-automating-tasks.html#saving-multiple-results"><i class="fa fa-check"></i><b>4.2.3</b> Saving Multiple Results</a></li>
<li class="chapter" data-level="4.2.4" data-path="reshaping-data-automating-tasks.html"><a href="reshaping-data-automating-tasks.html#break-next"><i class="fa fa-check"></i><b>4.2.4</b> Break &amp; Next</a></li>
<li class="chapter" data-level="4.2.5" data-path="reshaping-data-automating-tasks.html"><a href="reshaping-data-automating-tasks.html#planning-for-iteration"><i class="fa fa-check"></i><b>4.2.5</b> Planning for Iteration</a></li>
<li class="chapter" data-level="4.2.6" data-path="reshaping-data-automating-tasks.html"><a href="reshaping-data-automating-tasks.html#case-study-the-collatz-conjecture"><i class="fa fa-check"></i><b>4.2.6</b> Case Study: The Collatz Conjecture</a></li>
<li class="chapter" data-level="4.2.7" data-path="reshaping-data-automating-tasks.html"><a href="reshaping-data-automating-tasks.html#case-study-u.s.-fruit-prices"><i class="fa fa-check"></i><b>4.2.7</b> Case Study: U.S. Fruit Prices</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html"><i class="fa fa-check"></i><b>5</b> Data Visualization in R</a>
<ul>
<li class="chapter" data-level="5.1" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#the-grammar-of-graphics"><i class="fa fa-check"></i><b>5.1</b> The Grammar of Graphics</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#example-distance-to-stop-a-car"><i class="fa fa-check"></i><b>5.1.1</b> Example: Distance to Stop A Car</a></li>
<li class="chapter" data-level="5.1.2" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#layers"><i class="fa fa-check"></i><b>5.1.2</b> Layers</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#guidelines-for-graphics"><i class="fa fa-check"></i><b>5.2</b> Guidelines for Graphics</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#data"><i class="fa fa-check"></i><b>5.2.1</b> Data</a></li>
<li class="chapter" data-level="5.2.2" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#feature-types"><i class="fa fa-check"></i><b>5.2.2</b> Feature Types</a></li>
<li class="chapter" data-level="5.2.3" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#theme-guidelines"><i class="fa fa-check"></i><b>5.2.3</b> Theme Guidelines</a></li>
<li class="chapter" data-level="5.2.4" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#scale-guidelines"><i class="fa fa-check"></i><b>5.2.4</b> Scale Guidelines</a></li>
<li class="chapter" data-level="5.2.5" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#facet-guidelines"><i class="fa fa-check"></i><b>5.2.5</b> Facet Guidelines</a></li>
<li class="chapter" data-level="5.2.6" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#example-revisited"><i class="fa fa-check"></i><b>5.2.6</b> Example, Revisited</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#examples"><i class="fa fa-check"></i><b>5.3</b> Examples</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#bird-flu-mortality"><i class="fa fa-check"></i><b>5.3.1</b> Bird Flu Mortality</a></li>
<li class="chapter" data-level="5.3.2" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#small-business-loans"><i class="fa fa-check"></i><b>5.3.2</b> Small Business Loans</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Backmatter</b></span></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="chapter" data-level="" data-path="assessment.html"><a href="assessment.html"><i class="fa fa-check"></i>Assessment</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Intermediate R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="output-errors-and-bugs" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">2</span> Output, Errors, and Bugs<a href="output-errors-and-bugs.html#output-errors-and-bugs" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This chapter is part 2 (of 2) of <em>Thinking in R</em>, a workshop series about how R
works and how to examine code critically. The major topics of this chapter are
how to print output, how R’s conditions system for warnings and errors works,
how to use the R debugger, and how to estimate the performance of R code.</p>
<div id="learning-objectives-1" class="section level4 unnumbered hasAnchor">
<h4>Learning Objectives<a href="output-errors-and-bugs.html#learning-objectives-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>Identify and explain the difference between R’s various printing functions</li>
<li>Use R’s conditions system to raise and catch messages, warnings, and errors</li>
<li>Use R’s debugging functions to diagnose bugs in code</li>
<li>Estimate the amount of memory a data set will require</li>
<li>Use the lobstr package to get memory usage for an R object</li>
<li>Describe what a profiler is and why you would use one</li>
<li>Describe what kinds of profiling tools R provides</li>
</ul>
</div>
<div id="printing-output" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> Printing Output<a href="output-errors-and-bugs.html#printing-output" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Perhaps the simplest thing you can do to get a better understanding of some
code is make it print out lots of information about what’s happening as it
runs. This section introduces several different functions for printing output
and making that output easier to read.</p>
<div id="the-print-function" class="section level3 hasAnchor" number="2.1.1">
<h3><span class="header-section-number">2.1.1</span> The <code>print</code> Function<a href="output-errors-and-bugs.html#the-print-function" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>print</code> function prints a <strong>string representation</strong> of an object to the
console. The string representation is usually formatted in a way that exposes
detail important programmers rather than users.</p>
<p>For example, when printing a vector, the function prints the position of the
first element on each line in square brackets <code>[ ]</code>:</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="output-errors-and-bugs.html#cb180-1" tabindex="-1"></a><span class="fu">print</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>)</span></code></pre></div>
<pre><code>##   [1]   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18
##  [19]  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35  36
##  [37]  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53  54
##  [55]  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71  72
##  [73]  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89  90
##  [91]  91  92  93  94  95  96  97  98  99 100</code></pre>
<p>The <code>print</code> function also prints quotes around strings:</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="output-errors-and-bugs.html#cb182-1" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;Hi&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Hi&quot;</code></pre>
<p>These features make the <code>print</code> function ideal for printing information when
you’re trying to understand some code or diagnose a bug. On the other hand,
these features also make <code>print</code> a bad choice for printing output or status
messages for users (including you).</p>
<p>R calls the <code>print</code> function automatically anytime a result is returned at the
prompt. Thus it’s not necessary to call <code>print</code> to print something when you’re
working directly in the console—only from within loops, functions, scripts,
and other code that runs non-interactively.</p>
<p>The <code>print</code> function is an S3 generic (see Section <a href="language-fundamentals.html#s3">1.4</a>), so you if you
create an S3 class, you can define a custom print method for it. For S4
objects, R uses the S4 generic <code>show</code> instead of <code>print</code>.</p>
</div>
<div id="the-message-function" class="section level3 hasAnchor" number="2.1.2">
<h3><span class="header-section-number">2.1.2</span> The <code>message</code> Function<a href="output-errors-and-bugs.html#the-message-function" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To print output for users, the <code>message</code> function is the one you should use.
The main reason for this is that the <code>message</code> function is part of R’s
<strong>conditions system</strong> for reporting status information as code runs. This makes
it easier for other code to detect, record, respond to, or suppress the output.
Section <a href="output-errors-and-bugs.html#the-conditions-system">2.2</a> will explain the conditions system in more
detail.</p>
<p>The <code>message</code> function prints its argument(s) and a newline to the console:</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="output-errors-and-bugs.html#cb184-1" tabindex="-1"></a><span class="fu">message</span>(<span class="st">&quot;Hello world!&quot;</span>)</span></code></pre></div>
<pre><code>## Hello world!</code></pre>
<p>If an argument isn’t a string, the function automatically and silently attempts
to coerce it to one:</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="output-errors-and-bugs.html#cb186-1" tabindex="-1"></a><span class="fu">message</span>(<span class="dv">4</span>)</span></code></pre></div>
<pre><code>## 4</code></pre>
<p>Some types of objects can’t be coerced to a string:</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="output-errors-and-bugs.html#cb188-1" tabindex="-1"></a><span class="fu">message</span>(sqrt)</span></code></pre></div>
<pre><code>## Error in FUN(X[[i]], ...): cannot coerce type &#39;builtin&#39; to vector of type &#39;character&#39;</code></pre>
<p>For objects with multiple elements, the function pastes together the string
representations of the elements with no separators in between:</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="output-errors-and-bugs.html#cb190-1" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb190-2"><a href="output-errors-and-bugs.html#cb190-2" tabindex="-1"></a><span class="fu">message</span>(x)</span></code></pre></div>
<pre><code>## 123</code></pre>
<p>Similarly, if you pass the <code>message</code> function multiple arguments, it pastes
them together with no separators:</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="output-errors-and-bugs.html#cb192-1" tabindex="-1"></a>name <span class="ot">=</span> <span class="st">&quot;R&quot;</span></span>
<span id="cb192-2"><a href="output-errors-and-bugs.html#cb192-2" tabindex="-1"></a><span class="fu">message</span>(<span class="st">&quot;Hi, my name is &quot;</span>, name, <span class="st">&quot; and x is &quot;</span>, x)</span></code></pre></div>
<pre><code>## Hi, my name is R and x is 123</code></pre>
<p>This is a convenient way to print names or descriptions alongside values from
your code without having to call a formatting function like <code>paste</code>.</p>
<p>You can make the message function print something without adding a newline at
the end by setting the argument <code>appendLF = FALSE</code>. The difference can be easy
to miss unless you make several calls to <code>message</code>, so the <code>say_hello</code> function
in this example calls <code>message</code> twice:</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="output-errors-and-bugs.html#cb194-1" tabindex="-1"></a>say_hello <span class="ot">=</span> <span class="cf">function</span>(appendLF) {</span>
<span id="cb194-2"><a href="output-errors-and-bugs.html#cb194-2" tabindex="-1"></a>  <span class="fu">message</span>(<span class="st">&quot;Hello&quot;</span>, <span class="at">appendLF =</span> appendLF)</span>
<span id="cb194-3"><a href="output-errors-and-bugs.html#cb194-3" tabindex="-1"></a>  <span class="fu">message</span>(<span class="st">&quot; world!&quot;</span>)</span>
<span id="cb194-4"><a href="output-errors-and-bugs.html#cb194-4" tabindex="-1"></a>}</span>
<span id="cb194-5"><a href="output-errors-and-bugs.html#cb194-5" tabindex="-1"></a></span>
<span id="cb194-6"><a href="output-errors-and-bugs.html#cb194-6" tabindex="-1"></a><span class="fu">say_hello</span>(<span class="at">appendLF =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## Hello</code></pre>
<pre><code>##  world!</code></pre>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="output-errors-and-bugs.html#cb197-1" tabindex="-1"></a><span class="fu">say_hello</span>(<span class="at">appendLF =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## Hello world!</code></pre>
<p>Note that RStudio always adds a newline in front of the prompt, so making an
isolated call to <code>message</code> with <code>appendLF = FALSE</code> appears to produce the same
output as with <code>appendLF = TRUE</code>. This is an example of a situation where
RStudio leads you astray: in an ordinary R console, the two are clearly
different.</p>
</div>
<div id="the-cat-function" class="section level3 hasAnchor" number="2.1.3">
<h3><span class="header-section-number">2.1.3</span> The <code>cat</code> Function<a href="output-errors-and-bugs.html#the-cat-function" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>cat</code> function, whose name stands for “concatenate and print,” is a
low-level way to print output to the console or a file. The <code>message</code> function
prints output by calling <code>cat</code>, but <code>cat</code> is not part of R’s conditions system.</p>
<p>The <code>cat</code> function prints its argument(s) to the console. It does not add a
newline at the end:</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="output-errors-and-bugs.html#cb199-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Hello&quot;</span>)</span></code></pre></div>
<pre><code>## Hello</code></pre>
<p>As with <code>message</code>, RStudio hides the fact that there’s no newline if you make
an isolated call to <code>cat</code>.</p>
<p>The <code>cat</code> function coerces its arguments to strings and concatenates them. By
default, a space <code></code> is inserted between arguments and their elements:</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="output-errors-and-bugs.html#cb201-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="dv">4</span>)</span></code></pre></div>
<pre><code>## 4</code></pre>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="output-errors-and-bugs.html#cb203-1" tabindex="-1"></a><span class="fu">cat</span>(x)</span></code></pre></div>
<pre><code>## 1 2 3</code></pre>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="output-errors-and-bugs.html#cb205-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Hello&quot;</span>, <span class="st">&quot;Nick&quot;</span>)</span></code></pre></div>
<pre><code>## Hello Nick</code></pre>
<p>You can set the <code>sep</code> parameter to control the separator <code>cat</code> inserts:</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="output-errors-and-bugs.html#cb207-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Hello&quot;</span>, <span class="st">&quot;world&quot;</span>, x, <span class="at">sep =</span> <span class="st">&quot;|&quot;</span>)</span></code></pre></div>
<pre><code>## Hello|world|1|2|3</code></pre>
<p>If you want to write output to a file rather than to the console, you can call
<code>cat</code> with the <code>file</code> parameter set. However, it’s preferable to use functions
tailored to writing specific kinds of data, such as <code>writeLines</code> (for text) or
<code>write.table</code> (for tabular data), since they provide additional options to
control the output.</p>
<p>Many scripts and packages still use <code>cat</code> to print output, but the <code>message</code>
function provides more flexibility and control to people running the code. Thus
it’s generally preferable to use <code>message</code> in new code. Nevertheless, there are
a few specific cases where <code>cat</code> is useful—for example, if you want to pipe
data to a UNIX shell command. See <code>?cat</code> for details.</p>
</div>
<div id="formatting-output" class="section level3 hasAnchor" number="2.1.4">
<h3><span class="header-section-number">2.1.4</span> Formatting Output<a href="output-errors-and-bugs.html#formatting-output" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>R provides a variety of ways to format data before you print it. Taking the
time to format output carefully makes it easier to read and understand, as well
as making your scripts seem more professional.</p>
<div id="escape-sequences" class="section level4 hasAnchor" number="2.1.4.1">
<h4><span class="header-section-number">2.1.4.1</span> Escape Sequences<a href="output-errors-and-bugs.html#escape-sequences" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>One way to format strings is by adding (or removing) <strong>escape sequences</strong>. An
escape sequence is a sequence of characters that represents some other
character, usually one that’s invisible (such as whitespace) or doesn’t appear
on a standard keyboard.</p>
<p>In R, escape sequences always begin with a backslash. For example, <code>\n</code> is a
newline. The <code>message</code> and <code>cat</code> functions automatically convert escape
sequences to the characters they represent:</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="output-errors-and-bugs.html#cb209-1" tabindex="-1"></a>x <span class="ot">=</span> <span class="st">&quot;Hello</span><span class="sc">\n</span><span class="st">world!&quot;</span></span>
<span id="cb209-2"><a href="output-errors-and-bugs.html#cb209-2" tabindex="-1"></a><span class="fu">message</span>(x)</span></code></pre></div>
<pre><code>## Hello
## world!</code></pre>
<p>The <code>print</code> function doesn’t convert escape sequences:</p>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="output-errors-and-bugs.html#cb211-1" tabindex="-1"></a><span class="fu">print</span>(x)</span></code></pre></div>
<pre><code>## [1] &quot;Hello\nworld!&quot;</code></pre>
<p>Some escape sequences trigger special behavior in the console. For example,
ending a line with a carriage return <code>\r</code> makes the console print the next line
over the line. Try running this code in a console (it’s not possible to see the
result in a static book):</p>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="output-errors-and-bugs.html#cb213-1" tabindex="-1"></a><span class="co"># Run this in an R console.</span></span>
<span id="cb213-2"><a href="output-errors-and-bugs.html#cb213-2" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) {</span>
<span id="cb213-3"><a href="output-errors-and-bugs.html#cb213-3" tabindex="-1"></a>  <span class="fu">message</span>(i, <span class="st">&quot;</span><span class="sc">\r</span><span class="st">&quot;</span>, <span class="at">appendLF =</span> <span class="cn">FALSE</span>)</span>
<span id="cb213-4"><a href="output-errors-and-bugs.html#cb213-4" tabindex="-1"></a>  <span class="co"># Wait 0.5 seconds.</span></span>
<span id="cb213-5"><a href="output-errors-and-bugs.html#cb213-5" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(<span class="fl">0.5</span>)</span>
<span id="cb213-6"><a href="output-errors-and-bugs.html#cb213-6" tabindex="-1"></a>}</span></code></pre></div>
<p>You can find a complete list of escape sequences in <code>?Quotes</code>.</p>
</div>
<div id="formatting-functions" class="section level4 hasAnchor" number="2.1.4.2">
<h4><span class="header-section-number">2.1.4.2</span> Formatting Functions<a href="output-errors-and-bugs.html#formatting-functions" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>You can use the <code>sprintf</code> function to apply specific formatting to values and
substitute them into strings. The function uses a mini-language to describe the
formatting and substitutions. The <code>sprintf</code> function (or something like it) is
available in many programming languages, so being familiar with it will serve
you well on your programming journey.</p>
<p>The key idea is that substitutions are marked by a percent sign <code>%</code> and a
character. The character indicates the kind of data to be substituted: <code>s</code> for
strings, <code>i</code> for integers, <code>f</code> for floating point numbers, and so on.</p>
<p>The first argument to <code>sprintf</code> must be a string, and subsequent arguments are
values to substitute into the string (from left to right). For example:</p>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="output-errors-and-bugs.html#cb214-1" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">&quot;My age is %i, and my name is %s&quot;</span>, <span class="dv">32</span>, <span class="st">&quot;Nick&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;My age is 32, and my name is Nick&quot;</code></pre>
<p>You can use the mini-language to do things like specify how many digits to
print after a decimal point. Format settings for a substituted value go between
the percent sign <code>%</code> and the character. For instance, here’s how to print <code>pi</code>
with 2 digits after the decimal:</p>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="output-errors-and-bugs.html#cb216-1" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">&quot;%.2f&quot;</span>, pi)</span></code></pre></div>
<pre><code>## [1] &quot;3.14&quot;</code></pre>
<p>You can learn more by reading <code>?sprintf</code>.</p>
<p>Much simpler are the <code>paste</code> and <code>paste0</code> functions, which coerce their
arguments to strings and concatenate (or “paste together”) them. The <code>paste</code>
function inserts a space <code></code> between each argument, while the <code>paste0</code>
function doesn’t:</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="output-errors-and-bugs.html#cb218-1" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">&quot;Hello&quot;</span>, <span class="st">&quot;world&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Hello world&quot;</code></pre>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="output-errors-and-bugs.html#cb220-1" tabindex="-1"></a><span class="fu">paste0</span>(<span class="st">&quot;Hello&quot;</span>,  <span class="st">&quot;world&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Helloworld&quot;</code></pre>
<p>You can control the character inserted between arguments with the <code>sep</code>
parameter.</p>
<p>By setting an argument for the <code>collapse</code> parameter, you can also use the
<code>paste</code> and <code>paste0</code> functions to concatenate the elements of a vector. The
argument to <code>collapse</code> is inserted between the elements. For example, suppose
you want to paste together elements of a vector inserting a comma and space
<code>,</code> in between:</p>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="output-errors-and-bugs.html#cb222-1" tabindex="-1"></a><span class="fu">paste</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">collapse =</span> <span class="st">&quot;, &quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;1, 2, 3&quot;</code></pre>
<p>Members of the R community have developed many packages to make formatting
strings easier:</p>
<ul>
<li><a href="https://cli.r-lib.org/">cli</a> – helper functions for developing command-line interfaces,
including functions to add color, progress bars, and more.</li>
<li><a href="https://glue.tidyverse.org/">glue</a> – alternatives to <code>sprintf</code> for string iterpolation.</li>
<li><a href="https://stringr.tidyverse.org/">stringr</a> – a collection of general-purpose string manipulation functions.</li>
</ul>
</div>
</div>
<div id="logging-output" class="section level3 hasAnchor" number="2.1.5">
<h3><span class="header-section-number">2.1.5</span> Logging Output<a href="output-errors-and-bugs.html#logging-output" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Logging</strong> means saving the output from some code to a file as the code runs.
The file where the output is saved is called a <strong>log file</strong> or log, but this
name isn’t indicative of a specific format (unlike, say, a “CSV file”).</p>
<p>It’s a good idea to set up some kind of logging for any code that takes more
than a few minutes to run, because then if something goes wrong you can inspect
the log to diagnose the problem. Think of any output that’s not logged as
ephemeral: it could disappear if someone reboots the computer, or there’s a
power outage, or some other, unforeseen event.</p>
<p>R’s built-in tools for logging are rudimentary, but members of the community
have developed a variety of packages for logging. Here are a few that are still
actively maintained as of January 2023:</p>
<ul>
<li><a href="https://github.com/daroczig/logger">logger</a> – a relatively new package that aims to improve aspects of other
logging packages that R users find confusing.</li>
<li><a href="https://github.com/zatonovo/futile.logger">futile.logger</a> – a popular, mature logging package based on Apache’s
Log4j utility and on R idioms.</li>
<li><a href="https://github.com/WLOGSolutions/r-logging">logging</a> – a mature logging package based on Python’s <code>logging</code> module.</li>
<li><a href="https://github.com/ryapric/loggit">loggit</a> – integrates with R’s conditions system and writes logs in
JavaScript Object Notation (JSON) format so they are easy to inspect
programmatically.</li>
<li><a href="https://github.com/johnmyleswhite/log4r">log4r</a> – another package based on Log4j with an object-oriented
programming approach.</li>
</ul>
</div>
</div>
<div id="the-conditions-system" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> The Conditions System<a href="output-errors-and-bugs.html#the-conditions-system" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>R’s conditions system provides a way to signal and handle unusual conditions
that arise while code runs. With the conditions system, you can make R print
status, warning, and error messages that make it easier for users to understand
what your code is doing and whether they’re using it as intended. The condition
system also makes it possible to safely run code that might cause an error, and
respond appropriately in the event that it does. In short, understanding the
conditions system will enable you write code that’s easier to use and more
robust.</p>
<div id="raising-conditions" class="section level3 hasAnchor" number="2.2.1">
<h3><span class="header-section-number">2.2.1</span> Raising Conditions<a href="output-errors-and-bugs.html#raising-conditions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>message</code>, <code>warning</code>, and <code>stop</code> functions are the primary ways to
<strong>raise</strong>, or signal, conditions.</p>
<p>The <code>message</code> function was described in Section <a href="output-errors-and-bugs.html#the-message-function">2.1.2</a>. A
message provides status information about running code, but does not
necessarily indicate that something has gone wrong. You can use messages to
print out any information you think might be relevant to users.</p>
<p>The <code>warning</code> function raises a <strong>warning</strong>. Warnings indicate that something
unexpected happened, but that it didn’t stop the code from running. By default,
R doesn’t print warnings to the console until code finishes running, which can
make it difficult to understand their cause; Section <a href="output-errors-and-bugs.html#global-options">2.3</a>
explains how to change this setting.</p>
<p>Unnamed arguments to the <code>warning</code> function are concatenated with no separator
between them, in the same way as arguments to the <code>message</code> function. For
example:</p>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="output-errors-and-bugs.html#cb224-1" tabindex="-1"></a><span class="fu">warning</span>(<span class="st">&quot;Objects in mirror&quot;</span>, <span class="st">&quot; may be closer than they appear.&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: Objects in mirror may be closer than they appear.</code></pre>
<p>Warnings are always printed with <code>Warning:</code> before the message. By default,
calling <code>warning</code> from the body of a function also prints the name of the
function:</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="output-errors-and-bugs.html#cb226-1" tabindex="-1"></a>f <span class="ot">=</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb226-2"><a href="output-errors-and-bugs.html#cb226-2" tabindex="-1"></a>  <span class="fu">warning</span>(<span class="st">&quot;This is a warning!&quot;</span>)</span>
<span id="cb226-3"><a href="output-errors-and-bugs.html#cb226-3" tabindex="-1"></a>  x <span class="sc">+</span> y</span>
<span id="cb226-4"><a href="output-errors-and-bugs.html#cb226-4" tabindex="-1"></a>}</span>
<span id="cb226-5"><a href="output-errors-and-bugs.html#cb226-5" tabindex="-1"></a><span class="fu">f</span>(<span class="dv">3</span>, <span class="dv">4</span>)</span></code></pre></div>
<pre><code>## Warning in f(3, 4): This is a warning!</code></pre>
<pre><code>## [1] 7</code></pre>
<p>The name of the function that raised the warning is generally useful
information for users that want to correct whatever caused the warning.
Occasionally, you might want to disable this behavior, which you can do by
setting <code>call. = FALSE</code>:</p>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="output-errors-and-bugs.html#cb229-1" tabindex="-1"></a>f <span class="ot">=</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb229-2"><a href="output-errors-and-bugs.html#cb229-2" tabindex="-1"></a>  <span class="fu">warning</span>(<span class="st">&quot;This is a warning!&quot;</span>, <span class="at">call. =</span> <span class="cn">FALSE</span>)</span>
<span id="cb229-3"><a href="output-errors-and-bugs.html#cb229-3" tabindex="-1"></a>  x <span class="sc">+</span> y</span>
<span id="cb229-4"><a href="output-errors-and-bugs.html#cb229-4" tabindex="-1"></a>}</span>
<span id="cb229-5"><a href="output-errors-and-bugs.html#cb229-5" tabindex="-1"></a></span>
<span id="cb229-6"><a href="output-errors-and-bugs.html#cb229-6" tabindex="-1"></a><span class="fu">f</span>(<span class="dv">3</span>, <span class="dv">4</span>)</span></code></pre></div>
<pre><code>## Warning: This is a warning!</code></pre>
<pre><code>## [1] 7</code></pre>
<p>The <code>warning</code> function also has several other parameters that control when and
how warnings are displayed.</p>
<p>The <code>stop</code> function raises an <strong>error</strong>, which indicates that something
unexpected happened that prevents the code from running, and immediately stops
the evaluation of code. As a result, R prints errors as soon as they’re raised.
For instance, in this function, the line <code>x + y</code> never runs:</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="output-errors-and-bugs.html#cb232-1" tabindex="-1"></a>f <span class="ot">=</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb232-2"><a href="output-errors-and-bugs.html#cb232-2" tabindex="-1"></a>  <span class="fu">stop</span>()</span>
<span id="cb232-3"><a href="output-errors-and-bugs.html#cb232-3" tabindex="-1"></a>  x <span class="sc">+</span> y</span>
<span id="cb232-4"><a href="output-errors-and-bugs.html#cb232-4" tabindex="-1"></a>}</span>
<span id="cb232-5"><a href="output-errors-and-bugs.html#cb232-5" tabindex="-1"></a></span>
<span id="cb232-6"><a href="output-errors-and-bugs.html#cb232-6" tabindex="-1"></a><span class="fu">f</span>(<span class="dv">3</span>, <span class="dv">4</span>)</span></code></pre></div>
<pre><code>## Error in f(3, 4):</code></pre>
<p>Like <code>message</code> and <code>warning</code>, the <code>stop</code> function concatenates its unnamed
arguments into a message to print:</p>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="output-errors-and-bugs.html#cb234-1" tabindex="-1"></a><span class="fu">stop</span>(<span class="st">&quot;I&#39;m afraid something has gone terribly wrong.&quot;</span>)</span></code></pre></div>
<pre><code>## Error in eval(expr, envir, enclos): I&#39;m afraid something has gone terribly wrong.</code></pre>
<p>Errors are always printed with <code>Error:</code> before the error message. You can use
the <code>call.</code> parameter to control whether the error message also includes the
name of the function from which <code>stop</code> was called.</p>
<p>When writing code—especially functions, executable scripts, and
packages—it’s a good habit to include tests for unexpected conditions such as
invalid arguments and impossible results. If the tests detect a problem, use
the <code>warning</code> or <code>stop</code> function (depending on severity) to signal what the
problem is. Try to provide a concise but descriptive warning or error message
so that users can easily understand what went wrong.</p>
</div>
<div id="handling-conditions" class="section level3 hasAnchor" number="2.2.2">
<h3><span class="header-section-number">2.2.2</span> Handling Conditions<a href="output-errors-and-bugs.html#handling-conditions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In some cases, you can anticipate the problems likely to occur when code runs
and can even devise ways to work around them. As an example, suppose your code
is supposed to load parameters from a configuration file, but the path to the
file provided by the user is invalid. It might still be possible for your code
to run by falling back on a set of default parameters. R’s conditions system
provides a way to handle or “catch” messages, warnings, and errors, and to run
alternative code in response.</p>
<p>You can use the <code>try</code> function to safely run code that might produce an error.
If no error occurs, the <code>try</code> function returns whatever the result of the code
was. If an error does occur, the <code>try</code> function prints the error message and
returns an object of class <code>try-error</code>, but evaluation does not stop. For
example:</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="output-errors-and-bugs.html#cb236-1" tabindex="-1"></a>bad_add <span class="ot">=</span> <span class="cf">function</span>(x) {</span>
<span id="cb236-2"><a href="output-errors-and-bugs.html#cb236-2" tabindex="-1"></a>  <span class="co"># No error</span></span>
<span id="cb236-3"><a href="output-errors-and-bugs.html#cb236-3" tabindex="-1"></a>  x1 <span class="ot">=</span> <span class="fu">try</span>(<span class="dv">5</span> <span class="sc">+</span> x)</span>
<span id="cb236-4"><a href="output-errors-and-bugs.html#cb236-4" tabindex="-1"></a>  <span class="co"># Error</span></span>
<span id="cb236-5"><a href="output-errors-and-bugs.html#cb236-5" tabindex="-1"></a>  x2 <span class="ot">=</span> <span class="fu">try</span>(<span class="st">&quot;yay&quot;</span> <span class="sc">+</span> x)</span>
<span id="cb236-6"><a href="output-errors-and-bugs.html#cb236-6" tabindex="-1"></a></span>
<span id="cb236-7"><a href="output-errors-and-bugs.html#cb236-7" tabindex="-1"></a>  <span class="fu">list</span>(x1, x2)</span>
<span id="cb236-8"><a href="output-errors-and-bugs.html#cb236-8" tabindex="-1"></a>}</span>
<span id="cb236-9"><a href="output-errors-and-bugs.html#cb236-9" tabindex="-1"></a></span>
<span id="cb236-10"><a href="output-errors-and-bugs.html#cb236-10" tabindex="-1"></a><span class="fu">bad_add</span>(<span class="dv">10</span>)</span></code></pre></div>
<pre><code>## Error in &quot;yay&quot; + x : non-numeric argument to binary operator</code></pre>
<pre><code>## [[1]]
## [1] 15
## 
## [[2]]
## [1] &quot;Error in \&quot;yay\&quot; + x : non-numeric argument to binary operator\n&quot;
## attr(,&quot;class&quot;)
## [1] &quot;try-error&quot;
## attr(,&quot;condition&quot;)
## &lt;simpleError in &quot;yay&quot; + x: non-numeric argument to binary operator&gt;</code></pre>
<p>The simplest thing you can do in response to an error is ignore it. This is
usually not a good idea, but if you understand exactly what went wrong, can’t
fix it easily, and know it won’t affect the rest of your code, doing so might
be the best option.</p>
<p>A more robust approach is to inspect the result from a call to <code>try</code> to see if
an error occurred, and then take some appropriate action if one did. You can
use the <code>inherits</code> function to check whether an object has a specific class, so
here’s a template for how to run code that might cause an error, check for the
error, and respond to it:</p>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="output-errors-and-bugs.html#cb239-1" tabindex="-1"></a>result <span class="ot">=</span> <span class="fu">try</span>({</span>
<span id="cb239-2"><a href="output-errors-and-bugs.html#cb239-2" tabindex="-1"></a>  <span class="co"># Code that might cause an error.</span></span>
<span id="cb239-3"><a href="output-errors-and-bugs.html#cb239-3" tabindex="-1"></a>})</span>
<span id="cb239-4"><a href="output-errors-and-bugs.html#cb239-4" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">inherits</span>(result, <span class="st">&quot;try-error&quot;</span>)) {</span>
<span id="cb239-5"><a href="output-errors-and-bugs.html#cb239-5" tabindex="-1"></a>  <span class="co"># Code to respond to the error.</span></span>
<span id="cb239-6"><a href="output-errors-and-bugs.html#cb239-6" tabindex="-1"></a>}</span></code></pre></div>
<p>You can prevent the <code>try</code> function from printing error messages by setting
<code>silent = TRUE</code>. This is useful when your code is designed to detect and handle
the error, so you don’t users to think an error occurred.</p>
<p>The <code>tryCatch</code> function provides another way to handle conditions raised by a
piece of code. It requires that you provide a <strong>handler function</strong> for each
kind of condition you want to handle. The kinds of conditions are:</p>
<ul>
<li><code>message</code></li>
<li><code>warning</code></li>
<li><code>error</code></li>
<li><code>interrupt</code> – when the user interrupts the code (for example, by
pressing Ctrl-C)</li>
</ul>
<p>Each handler function must accept exactly one argument.</p>
<p>When you call <code>tryCatch</code>, if the suspect code raises a condition, then it calls
the associated handler function and returns whatever the handler returns.
Otherwise, <code>tryCatch</code> returns the result of the code.</p>
<p>Here’s an example of using <code>tryCatch</code> to catch an error:</p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="output-errors-and-bugs.html#cb240-1" tabindex="-1"></a>bad_fn <span class="ot">=</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb240-2"><a href="output-errors-and-bugs.html#cb240-2" tabindex="-1"></a>  <span class="fu">stop</span>(<span class="st">&quot;Hi&quot;</span>)</span>
<span id="cb240-3"><a href="output-errors-and-bugs.html#cb240-3" tabindex="-1"></a>  x <span class="sc">+</span> y</span>
<span id="cb240-4"><a href="output-errors-and-bugs.html#cb240-4" tabindex="-1"></a>}</span>
<span id="cb240-5"><a href="output-errors-and-bugs.html#cb240-5" tabindex="-1"></a></span>
<span id="cb240-6"><a href="output-errors-and-bugs.html#cb240-6" tabindex="-1"></a>err <span class="ot">=</span> <span class="fu">tryCatch</span>(<span class="fu">bad_fn</span>(<span class="dv">3</span>, <span class="dv">4</span>), <span class="at">error =</span> <span class="cf">function</span>(e) e)</span></code></pre></div>
<p>And here’s an example of using <code>tryCatch</code> to catch a message:</p>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="output-errors-and-bugs.html#cb241-1" tabindex="-1"></a>msg_fn <span class="ot">=</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb241-2"><a href="output-errors-and-bugs.html#cb241-2" tabindex="-1"></a>  <span class="fu">message</span>(<span class="st">&quot;Hi&quot;</span>)</span>
<span id="cb241-3"><a href="output-errors-and-bugs.html#cb241-3" tabindex="-1"></a>  x <span class="sc">+</span> y</span>
<span id="cb241-4"><a href="output-errors-and-bugs.html#cb241-4" tabindex="-1"></a>}</span>
<span id="cb241-5"><a href="output-errors-and-bugs.html#cb241-5" tabindex="-1"></a></span>
<span id="cb241-6"><a href="output-errors-and-bugs.html#cb241-6" tabindex="-1"></a>msg <span class="ot">=</span> <span class="fu">tryCatch</span>(<span class="fu">msg_fn</span>(<span class="dv">3</span>, <span class="dv">4</span>), <span class="at">message =</span> <span class="cf">function</span>(e) e)</span></code></pre></div>
<p>The <code>tryCatch</code> function always silences conditions. Details about raised
conditions are provided in the object passed to the handler function, which has
class <code>condition</code> (and a more specific class that indicates what kind of
condition it is).</p>
<p>If you want to learn more about R’s conditions system, start by reading
<code>?conditions</code>.</p>
</div>
</div>
<div id="global-options" class="section level2 hasAnchor" number="2.3">
<h2><span class="header-section-number">2.3</span> Global Options<a href="output-errors-and-bugs.html#global-options" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>R’s <strong>global options</strong> to control many different aspects of how R works.
They’re relevant to the theme of this chapter because some of them control when
and how R displays warnings and errors.</p>
<p>You can use the <code>options</code> function to get or set global options. If you call
the function with no arguments, it returns the current settings:</p>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="output-errors-and-bugs.html#cb242-1" tabindex="-1"></a>opts <span class="ot">=</span> <span class="fu">options</span>()</span>
<span id="cb242-2"><a href="output-errors-and-bugs.html#cb242-2" tabindex="-1"></a><span class="co"># Display the first 6 options.</span></span>
<span id="cb242-3"><a href="output-errors-and-bugs.html#cb242-3" tabindex="-1"></a><span class="fu">head</span>(opts)</span></code></pre></div>
<pre><code>## $add.smooth
## [1] TRUE
## 
## $bitmapType
## [1] &quot;quartz&quot;
## 
## $browser
## [1] &quot;/usr/bin/open&quot;
## 
## $browserNLdisabled
## [1] FALSE
## 
## $callr.condition_handler_cli_message
## function (msg) 
## {
##     custom_handler &lt;- getOption(&quot;cli.default_handler&quot;)
##     if (is.function(custom_handler)) {
##         custom_handler(msg)
##     }
##     else {
##         cli_server_default(msg)
##     }
## }
## &lt;bytecode: 0x7fd40145bf10&gt;
## &lt;environment: namespace:cli&gt;
## 
## $CBoundsCheck
## [1] FALSE</code></pre>
<p>This section only explains a few of the options, but you can read about all of
them in <code>?options</code>.</p>
<p>The <code>warn</code> option controls how R handles warnings. It can be set to three
different values:</p>
<ul>
<li><p><code>0</code> – (the default) warnings are only displayed after code finishes
running.</p></li>
<li><p><code>1</code> – warnings are displayed immediately.</p></li>
<li><p><code>2</code> – warnings stop code from running, like errors.</p></li>
</ul>
<p>Setting <code>warn = 2</code> is useful for pinpointing expressions that raise warnings.
Setting <code>warn = 1</code> makes it easier to determine which expressions raise
warnings, without the inconvenience of stopping code from running. That makes
it a good default (better than the actual default). You can use the <code>option</code>
function to change the value of the <code>warn</code> option:</p>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="output-errors-and-bugs.html#cb244-1" tabindex="-1"></a><span class="fu">options</span>(<span class="at">warn =</span> <span class="dv">1</span>)</span></code></pre></div>
<p>When you set an option this way, the change only lasts until you quit R. Next
time you start R, the option will go back to its default value. Fortunately,
there is a way override the default options every time R starts.</p>
<p>When R starts, it searches for a <code>.Rprofile</code> file. The file is usually in your
system’s home directory (see <a href="https://ucdavisdatalab.github.io/workshop_r_basics/getting-started.html#absolute-relative-paths">this section</a> of the R Basics Reader for
how to locate your home directory). Customizing your <code>.Rprofile</code> file is one of
the marks of an experienced R user. If you define a <code>.First</code> function in your
<code>.Rprofile</code>, R will call it automatically during startup. Here’s an example
<code>.First</code> function:</p>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="output-errors-and-bugs.html#cb245-1" tabindex="-1"></a>.First <span class="ot">=</span> <span class="cf">function</span>() {</span>
<span id="cb245-2"><a href="output-errors-and-bugs.html#cb245-2" tabindex="-1"></a>  <span class="co"># Only change options if R is running interactively.</span></span>
<span id="cb245-3"><a href="output-errors-and-bugs.html#cb245-3" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">interactive</span>())</span>
<span id="cb245-4"><a href="output-errors-and-bugs.html#cb245-4" tabindex="-1"></a>    <span class="fu">return</span>()</span>
<span id="cb245-5"><a href="output-errors-and-bugs.html#cb245-5" tabindex="-1"></a></span>
<span id="cb245-6"><a href="output-errors-and-bugs.html#cb245-6" tabindex="-1"></a>  <span class="fu">options</span>(</span>
<span id="cb245-7"><a href="output-errors-and-bugs.html#cb245-7" tabindex="-1"></a>    <span class="co"># Don&#39;t print more than 1000 elements of anything.</span></span>
<span id="cb245-8"><a href="output-errors-and-bugs.html#cb245-8" tabindex="-1"></a>    <span class="at">max.print =</span> <span class="dv">1000</span>,</span>
<span id="cb245-9"><a href="output-errors-and-bugs.html#cb245-9" tabindex="-1"></a>    <span class="co"># Warn on partial matches.</span></span>
<span id="cb245-10"><a href="output-errors-and-bugs.html#cb245-10" tabindex="-1"></a>    <span class="at">warnPartialMatchAttr =</span> <span class="cn">TRUE</span>,</span>
<span id="cb245-11"><a href="output-errors-and-bugs.html#cb245-11" tabindex="-1"></a>    <span class="at">warnPartialMatchDollar =</span> <span class="cn">TRUE</span>,</span>
<span id="cb245-12"><a href="output-errors-and-bugs.html#cb245-12" tabindex="-1"></a>    <span class="at">warnPartialMatchArgs =</span> <span class="cn">TRUE</span>,</span>
<span id="cb245-13"><a href="output-errors-and-bugs.html#cb245-13" tabindex="-1"></a>    <span class="co"># Print warnings immediately (2 = warnings are errors).</span></span>
<span id="cb245-14"><a href="output-errors-and-bugs.html#cb245-14" tabindex="-1"></a>    <span class="at">warn =</span> <span class="dv">1</span></span>
<span id="cb245-15"><a href="output-errors-and-bugs.html#cb245-15" tabindex="-1"></a>  )</span>
<span id="cb245-16"><a href="output-errors-and-bugs.html#cb245-16" tabindex="-1"></a>}</span></code></pre></div>
<p>You can learn more about the <code>.Rprofile</code> file and R’s startup process at
<code>?Startup</code>.</p>
</div>
<div id="debugging" class="section level2 hasAnchor" number="2.4">
<h2><span class="header-section-number">2.4</span> Debugging<a href="output-errors-and-bugs.html#debugging" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Debugging</strong> code is the process of confirming, step-by-step, that what you
believe the code does is what the code actually does. The key idea is to check
each step (or expression) in the code. There are two different strategies for
doing this:</p>
<ul>
<li>Work forward through the code from the beginning.</li>
<li>Work backward from the source of an error.</li>
</ul>
<p>R has built-in functions to help with debugging. The <code>browser()</code> function
pauses the running code and starts R’s debugging system.</p>
<p>For example:</p>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="output-errors-and-bugs.html#cb246-1" tabindex="-1"></a><span class="co"># Run this in an R console.</span></span>
<span id="cb246-2"><a href="output-errors-and-bugs.html#cb246-2" tabindex="-1"></a>f <span class="ot">=</span> <span class="cf">function</span>(n) {</span>
<span id="cb246-3"><a href="output-errors-and-bugs.html#cb246-3" tabindex="-1"></a>  total <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb246-4"><a href="output-errors-and-bugs.html#cb246-4" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb246-5"><a href="output-errors-and-bugs.html#cb246-5" tabindex="-1"></a>    <span class="fu">browser</span>()</span>
<span id="cb246-6"><a href="output-errors-and-bugs.html#cb246-6" tabindex="-1"></a>    total <span class="ot">=</span> total <span class="sc">+</span> i</span>
<span id="cb246-7"><a href="output-errors-and-bugs.html#cb246-7" tabindex="-1"></a>  }</span>
<span id="cb246-8"><a href="output-errors-and-bugs.html#cb246-8" tabindex="-1"></a>  total</span>
<span id="cb246-9"><a href="output-errors-and-bugs.html#cb246-9" tabindex="-1"></a>}</span>
<span id="cb246-10"><a href="output-errors-and-bugs.html#cb246-10" tabindex="-1"></a></span>
<span id="cb246-11"><a href="output-errors-and-bugs.html#cb246-11" tabindex="-1"></a><span class="fu">f</span>(<span class="dv">10</span>)</span></code></pre></div>
<p>The most important debugger commands are:</p>
<ul>
<li><code>n</code> to run the next line</li>
<li><code>s</code> to “step into” a call</li>
<li><code>c</code> to continue running the code</li>
<li><code>Q</code> to quit the debugger</li>
<li><code>where</code> to print call stack</li>
<li><code>help</code> to print debugger help</li>
</ul>
<p>Another example:</p>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="output-errors-and-bugs.html#cb247-1" tabindex="-1"></a><span class="co"># Run this in an R console.</span></span>
<span id="cb247-2"><a href="output-errors-and-bugs.html#cb247-2" tabindex="-1"></a>g <span class="ot">=</span> <span class="cf">function</span>(x, y) (<span class="dv">1</span> <span class="sc">+</span> x) <span class="sc">*</span> y</span>
<span id="cb247-3"><a href="output-errors-and-bugs.html#cb247-3" tabindex="-1"></a></span>
<span id="cb247-4"><a href="output-errors-and-bugs.html#cb247-4" tabindex="-1"></a>f <span class="ot">=</span> <span class="cf">function</span>(n) {</span>
<span id="cb247-5"><a href="output-errors-and-bugs.html#cb247-5" tabindex="-1"></a>  total <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb247-6"><a href="output-errors-and-bugs.html#cb247-6" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb247-7"><a href="output-errors-and-bugs.html#cb247-7" tabindex="-1"></a>    <span class="fu">browser</span>()</span>
<span id="cb247-8"><a href="output-errors-and-bugs.html#cb247-8" tabindex="-1"></a>    total <span class="ot">=</span> total <span class="sc">+</span> <span class="fu">g</span>(i, i)</span>
<span id="cb247-9"><a href="output-errors-and-bugs.html#cb247-9" tabindex="-1"></a>  }</span>
<span id="cb247-10"><a href="output-errors-and-bugs.html#cb247-10" tabindex="-1"></a></span>
<span id="cb247-11"><a href="output-errors-and-bugs.html#cb247-11" tabindex="-1"></a>  total</span>
<span id="cb247-12"><a href="output-errors-and-bugs.html#cb247-12" tabindex="-1"></a>}</span>
<span id="cb247-13"><a href="output-errors-and-bugs.html#cb247-13" tabindex="-1"></a></span>
<span id="cb247-14"><a href="output-errors-and-bugs.html#cb247-14" tabindex="-1"></a><span class="fu">f</span>(<span class="dv">11</span>)</span></code></pre></div>
<div id="other-functions" class="section level3 hasAnchor" number="2.4.1">
<h3><span class="header-section-number">2.4.1</span> Other Functions<a href="output-errors-and-bugs.html#other-functions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>debug()</code> function places a call to <code>browser()</code> at the beginning
of a function. Use <code>debug()</code> to debug functions that you can’t or don’t want to
edit. For example:</p>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="output-errors-and-bugs.html#cb248-1" tabindex="-1"></a><span class="co"># Run this in an R console.</span></span>
<span id="cb248-2"><a href="output-errors-and-bugs.html#cb248-2" tabindex="-1"></a>f <span class="ot">=</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb248-3"><a href="output-errors-and-bugs.html#cb248-3" tabindex="-1"></a>  x <span class="sc">+</span> y</span>
<span id="cb248-4"><a href="output-errors-and-bugs.html#cb248-4" tabindex="-1"></a>}</span>
<span id="cb248-5"><a href="output-errors-and-bugs.html#cb248-5" tabindex="-1"></a></span>
<span id="cb248-6"><a href="output-errors-and-bugs.html#cb248-6" tabindex="-1"></a><span class="fu">debug</span>(f)</span>
<span id="cb248-7"><a href="output-errors-and-bugs.html#cb248-7" tabindex="-1"></a><span class="fu">f</span>(<span class="dv">5</span>, <span class="dv">5</span>)</span></code></pre></div>
<p>You can use <code>undebug()</code> to reverse the effect of <code>debug()</code>:</p>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="output-errors-and-bugs.html#cb249-1" tabindex="-1"></a><span class="co"># Run this in an R console.</span></span>
<span id="cb249-2"><a href="output-errors-and-bugs.html#cb249-2" tabindex="-1"></a><span class="fu">undebug</span>(f)</span>
<span id="cb249-3"><a href="output-errors-and-bugs.html#cb249-3" tabindex="-1"></a><span class="fu">f</span>(<span class="dv">10</span>, <span class="dv">20</span>)</span></code></pre></div>
<p>The <code>debugonce()</code> function places a call to <code>browser()</code> at the beginning of a
function for the next call only. The idea is that you then don’t have to call
<code>undebug()</code>. For instance:</p>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="output-errors-and-bugs.html#cb250-1" tabindex="-1"></a><span class="co"># Run this in an R console.</span></span>
<span id="cb250-2"><a href="output-errors-and-bugs.html#cb250-2" tabindex="-1"></a><span class="fu">debugonce</span>(f)</span>
<span id="cb250-3"><a href="output-errors-and-bugs.html#cb250-3" tabindex="-1"></a><span class="fu">f</span>(<span class="dv">10</span>, <span class="dv">20</span>)</span>
<span id="cb250-4"><a href="output-errors-and-bugs.html#cb250-4" tabindex="-1"></a><span class="fu">f</span>(<span class="dv">3</span>, <span class="dv">4</span>)</span></code></pre></div>
<p>Finally, the global option <code>error</code> can be used to make R enter the debugger any
time an error occurs. Set the option to <code>error = recover</code>:</p>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="output-errors-and-bugs.html#cb251-1" tabindex="-1"></a><span class="fu">options</span>(<span class="at">error =</span> recover)</span></code></pre></div>
<p>Then try this example:</p>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="output-errors-and-bugs.html#cb252-1" tabindex="-1"></a><span class="co"># Run this in an R console.</span></span>
<span id="cb252-2"><a href="output-errors-and-bugs.html#cb252-2" tabindex="-1"></a>bad_fn <span class="ot">=</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb252-3"><a href="output-errors-and-bugs.html#cb252-3" tabindex="-1"></a>  <span class="fu">stop</span>(<span class="st">&quot;Hi&quot;</span>)</span>
<span id="cb252-4"><a href="output-errors-and-bugs.html#cb252-4" tabindex="-1"></a>  x <span class="sc">+</span> y</span>
<span id="cb252-5"><a href="output-errors-and-bugs.html#cb252-5" tabindex="-1"></a>}</span>
<span id="cb252-6"><a href="output-errors-and-bugs.html#cb252-6" tabindex="-1"></a></span>
<span id="cb252-7"><a href="output-errors-and-bugs.html#cb252-7" tabindex="-1"></a><span class="fu">bad_fn</span>(<span class="dv">3</span>, <span class="dv">4</span>)</span></code></pre></div>
</div>
</div>
<div id="measuring-performance" class="section level2 hasAnchor" number="2.5">
<h2><span class="header-section-number">2.5</span> Measuring Performance<a href="output-errors-and-bugs.html#measuring-performance" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>How quickly code runs and how much memory it uses can be just as much of an
obstacle to research computing tasks as errors and bugs. This section describes
some of the strategies you can use to estimate or measure the performance
characteristics of code, so that you can identify potential problems and fix
them.</p>
<div id="estimating-memory-usage" class="section level3 hasAnchor" number="2.5.1">
<h3><span class="header-section-number">2.5.1</span> Estimating Memory Usage<a href="output-errors-and-bugs.html#estimating-memory-usage" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Running out of memory can be extremely frustrating, because it can slow down
your code or prevent it from running at all.</p>
<p>It’s useful to know how to estimate how much memory a given data structure will
use so that you can determine whether a programming strategy is feasible before
you even start writing code. The <a href="https://en.wikipedia.org/wiki/Central_processing_unit">central processing units</a> (CPUs) in most
modern computers are designed to work most efficiently with <a href="https://en.wikipedia.org/wiki/64-bit_computing">64 bits</a>
of data at a time. Consequently, R and other programming languages typically
use 64 bits to store each number (regardless of type). While the data
structures R uses create some additional overhead, you can use this fact to do
<a href="https://en.wikipedia.org/wiki/Back-of-the-envelope_calculation">back-of-the-envelope</a> calculations about how much memory a vector or
matrix of numbers will require.</p>
<p>Start by determining how many elements the data structure will contain. Then
multiply by 64 bits and divide by 8 to convert bits to bytes. You can then
repeatedly divide by 1024 to convert to kilobytes, megabytes, gigabytes, or
terabytes. For instance, an vector of 2 million numbers will require
approximately this many megabytes:</p>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="output-errors-and-bugs.html#cb253-1" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">2000000</span></span>
<span id="cb253-2"><a href="output-errors-and-bugs.html#cb253-2" tabindex="-1"></a>n <span class="sc">*</span> (<span class="dv">64</span> <span class="sc">/</span> <span class="dv">8</span>) <span class="sc">/</span> <span class="dv">1024</span><span class="sc">^</span><span class="dv">2</span></span></code></pre></div>
<pre><code>## [1] 15.25879</code></pre>
<p>You can even write an R function to do these calculations for you! If you’re
not sure whether a particular programming strategy is realistic, do the memory
calculations <em>before</em> you start writing code. This is a simple way to avoid
strategies that are inefficient.</p>
<p>If you’ve already written some code and it runs out of memory, the first step
to fixing the problem is identifying the cause. The <a href="https://lobstr.r-lib.org/">lobstr</a> package provides
functions to explore how R is using memory.</p>
<p>You can use the <code>mem_used</code> function to get the amount of memory R is currently
using:</p>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="output-errors-and-bugs.html#cb255-1" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;lobstr&quot;</span>)</span>
<span id="cb255-2"><a href="output-errors-and-bugs.html#cb255-2" tabindex="-1"></a><span class="fu">mem_used</span>()</span></code></pre></div>
<pre><code>## 41.43 MB</code></pre>
<p>Sometimes the culprit isn’t your code, but other applications on your computer.
Modern web browsers are especially memory-intensive, and closing yours while
you run code can make a big difference.</p>
<p>If you’ve determined that your code is the reason R runs out of memory, you can
use the <code>obj_size</code> function to get how much memory objects in your code
actually use:</p>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="output-errors-and-bugs.html#cb257-1" tabindex="-1"></a><span class="fu">obj_size</span>(<span class="dv">1</span>)</span></code></pre></div>
<pre><code>## 56 B</code></pre>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="output-errors-and-bugs.html#cb259-1" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">runif</span>(n)</span>
<span id="cb259-2"><a href="output-errors-and-bugs.html#cb259-2" tabindex="-1"></a><span class="fu">obj_size</span>(x)</span></code></pre></div>
<pre><code>## 16.00 MB</code></pre>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="output-errors-and-bugs.html#cb261-1" tabindex="-1"></a><span class="fu">obj_size</span>(mtcars)</span></code></pre></div>
<pre><code>## 7.21 kB</code></pre>
<p>If a specific object created by your code uses a lot of memory, think about
ways you might change the code to avoid creating the object or avoid creating
the entire object at once. For instance, consider whether it’s possible to
create part of the object, save that to disk, remove it from memory, and then
create the another part.</p>
</div>
<div id="benchmarking" class="section level3 hasAnchor" number="2.5.2">
<h3><span class="header-section-number">2.5.2</span> Benchmarking<a href="output-errors-and-bugs.html#benchmarking" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Benchmarking</strong> means timing how long code takes to run. Benchmarking is
useful for evaluating different strategies to solve a computational problem and
for understanding how quickly (or slowly) your code runs. When you benchmark
code, it’s important to collect and aggregate multiple data points so that your
estimates reflect how the code performs on average.</p>
<p>R has built-in functions for timing code, but several packages provide
functions that are more convenient for benchmarking, because they automatically
run the code multiple times and return summary statistics. The two most mature
packages for benchmarking are:</p>
<ul>
<li><a href="https://cran.r-project.org/web/packages/microbenchmark/index.html">microbenchmark</a></li>
<li><a href="https://bench.r-lib.org/">bench</a></li>
</ul>
<p>The microbenchmark package is simpler to use. It provides a single function,
<code>microbenchmark</code>, for carrying out benchmarks. The function accepts any number
of expressions to benchmark as arguments. For example, to compare the speed of
<code>runif</code> and <code>rnorm</code> (as <code>A</code> and <code>B</code> respectively):</p>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="output-errors-and-bugs.html#cb263-1" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;microbenchmark&quot;</span>)</span>
<span id="cb263-2"><a href="output-errors-and-bugs.html#cb263-2" tabindex="-1"></a><span class="fu">microbenchmark</span>(<span class="at">A =</span> <span class="fu">runif</span>(<span class="fl">1e5</span>), <span class="at">B =</span> <span class="fu">rnorm</span>(<span class="fl">1e5</span>))</span></code></pre></div>
<pre><code>## Unit: milliseconds
##  expr      min       lq     mean   median       uq      max neval
##     A 2.159849 2.436111 2.732723 2.510633 2.990191 5.546843   100
##     B 5.091763 5.454950 6.049992 5.544690 6.496486 9.960501   100</code></pre>
<p>The <code>microbenchmark</code> has parameters to control the number of times each
expression runs, the units for the timings, and more. You can find the details
in <code>?microbenchmark</code>.</p>
</div>
<div id="profiling" class="section level3 hasAnchor" number="2.5.3">
<h3><span class="header-section-number">2.5.3</span> Profiling<a href="output-errors-and-bugs.html#profiling" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Profiling</strong> code means collecting data about the code as it runs, and a
<strong>profiler</strong> is a program that profiles code. A typical profiler estimates how
much time is spent on each expression (as actual time or as a percentage of
total runtime) and how much memory the code uses over time. Profiling is a good
way to determine which parts of your code are performance bottlenecks, so that
you can target them when you try to optimize your code.</p>
<p>R has a built-in profiler. You can use the <code>Rprof</code> function to enable or
disable the profiler. Essential parameters for the function are:</p>
<ul>
<li><code>filename</code> – a path to a file for storing results. Defaults to <code>Rprof.out</code>.</li>
<li><code>interval</code> – the time between samples, in seconds.</li>
<li><code>memory.profiling</code> – whether to track memory in addition to time.</li>
</ul>
<p>Set these parameters in the first call you make to <code>Rprof</code>, which will enable
the profiler. Then run the code you want to profile. At the end of the code,
call <code>Rprof(NULL)</code> to disable the profiler.</p>
<p>The profiler saves the collected data to a file. You can use the <code>summaryRprof</code>
function to read the profile data and get a summary. Essential parameters for
this function are:</p>
<ul>
<li><code>filename</code> – the path to the results file. Defaults to <code>Rprof.out</code>.</li>
<li><code>memory</code> – how to display memory information. Use <code>"both"</code> to see total
changes.</li>
</ul>
<p>The summary lists times in seconds and memory in bytes.</p>
<p>The <a href="https://rstudio.github.io/profvis/">profvis</a> package provides an interactive graphical interface for
exploring profile data collected with <code>Rprof</code>. Examining profile data
graphically makes it easier to interpret the results and to identify patterns.</p>

</div>
</div>
</div>



            </section>

          </div>
        </div>
      </div>
<a href="language-fundamentals.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="string-date-processing.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/ucdavisdatalab/workshop_intermediate_r/edit/master/02_debugging.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/ucdavisdatalab/workshop_intermediate_r/blob/master/02_debugging.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
