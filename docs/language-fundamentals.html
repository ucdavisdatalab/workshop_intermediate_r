<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6 Language Fundamentals | Intermediate R</title>
  <meta name="description" content="6 Language Fundamentals | Intermediate R" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="6 Language Fundamentals | Intermediate R" />
  <meta property="og:type" content="book" />
  
  
  <meta name="github-repo" content="ucdavisdatalab/workshop_intermediate_r" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6 Language Fundamentals | Intermediate R" />
  
  
  

<meta name="author" content="Nick Ulle and Wesley Brooks" />


<meta name="date" content="2024-01-19" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-visualization-in-r.html"/>
<link rel="next" href="part-2.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://datalab.ucdavis.edu/">
  <img src="https://datalab.ucdavis.edu/wp-content/uploads/2019/07/datalab-logo-full-color-rgb-1.png" style="height: 100%; width: 100%; object-fit: contain" />
</a></li>
<li><a href="./" style="font-size: 18px">Intermediate R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Overview</a></li>
<li class="part"><span><b>I Cleaning &amp; Reshaping Data</b></span></li>
<li class="chapter" data-level="1" data-path="string-date-processing.html"><a href="string-date-processing.html"><i class="fa fa-check"></i><b>1</b> String &amp; Date Processing</a>
<ul>
<li class="chapter" data-level="1.1" data-path="string-date-processing.html"><a href="string-date-processing.html#the-tidyverse"><i class="fa fa-check"></i><b>1.1</b> The Tidyverse</a></li>
<li class="chapter" data-level="1.2" data-path="string-date-processing.html"><a href="string-date-processing.html#parsing-dates-times"><i class="fa fa-check"></i><b>1.2</b> Parsing Dates &amp; Times</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="string-date-processing.html"><a href="string-date-processing.html#the-lubridate-package"><i class="fa fa-check"></i><b>1.2.1</b> The lubridate Package</a></li>
<li class="chapter" data-level="1.2.2" data-path="string-date-processing.html"><a href="string-date-processing.html#case-study-ocean-temperatures"><i class="fa fa-check"></i><b>1.2.2</b> Case Study: Ocean Temperatures</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="string-date-processing.html"><a href="string-date-processing.html#string-fundamentals"><i class="fa fa-check"></i><b>1.3</b> String Fundamentals</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="string-date-processing.html"><a href="string-date-processing.html#printing"><i class="fa fa-check"></i><b>1.3.1</b> Printing</a></li>
<li class="chapter" data-level="1.3.2" data-path="string-date-processing.html"><a href="string-date-processing.html#escape-sequences"><i class="fa fa-check"></i><b>1.3.2</b> Escape Sequences</a></li>
<li class="chapter" data-level="1.3.3" data-path="string-date-processing.html"><a href="string-date-processing.html#raw-strings"><i class="fa fa-check"></i><b>1.3.3</b> Raw Strings</a></li>
<li class="chapter" data-level="1.3.4" data-path="string-date-processing.html"><a href="string-date-processing.html#character-encodings"><i class="fa fa-check"></i><b>1.3.4</b> Character Encodings</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="string-date-processing.html"><a href="string-date-processing.html#processing-strings"><i class="fa fa-check"></i><b>1.4</b> Processing Strings</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="string-date-processing.html"><a href="string-date-processing.html#the-stringr-package"><i class="fa fa-check"></i><b>1.4.1</b> The stringr Package</a></li>
<li class="chapter" data-level="1.4.2" data-path="string-date-processing.html"><a href="string-date-processing.html#regular-expressions"><i class="fa fa-check"></i><b>1.4.2</b> Regular Expressions</a></li>
<li class="chapter" data-level="1.4.3" data-path="string-date-processing.html"><a href="string-date-processing.html#replacing-parts-of-strings"><i class="fa fa-check"></i><b>1.4.3</b> Replacing Parts of Strings</a></li>
<li class="chapter" data-level="1.4.4" data-path="string-date-processing.html"><a href="string-date-processing.html#splitting-strings"><i class="fa fa-check"></i><b>1.4.4</b> Splitting Strings</a></li>
<li class="chapter" data-level="1.4.5" data-path="string-date-processing.html"><a href="string-date-processing.html#extracting-matches"><i class="fa fa-check"></i><b>1.4.5</b> Extracting Matches</a></li>
<li class="chapter" data-level="1.4.6" data-path="string-date-processing.html"><a href="string-date-processing.html#case-study-u.s.-warehouse-stocks"><i class="fa fa-check"></i><b>1.4.6</b> Case Study: U.S. Warehouse Stocks</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="string-date-processing.html"><a href="string-date-processing.html#regular-expression-examples"><i class="fa fa-check"></i><b>1.5</b> Regular Expression Examples</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="string-date-processing.html"><a href="string-date-processing.html#the-wildcard"><i class="fa fa-check"></i><b>1.5.1</b> The Wildcard</a></li>
<li class="chapter" data-level="1.5.2" data-path="string-date-processing.html"><a href="string-date-processing.html#escape-sequences-1"><i class="fa fa-check"></i><b>1.5.2</b> Escape Sequences</a></li>
<li class="chapter" data-level="1.5.3" data-path="string-date-processing.html"><a href="string-date-processing.html#anchors"><i class="fa fa-check"></i><b>1.5.3</b> Anchors</a></li>
<li class="chapter" data-level="1.5.4" data-path="string-date-processing.html"><a href="string-date-processing.html#character-classes"><i class="fa fa-check"></i><b>1.5.4</b> Character Classes</a></li>
<li class="chapter" data-level="1.5.5" data-path="string-date-processing.html"><a href="string-date-processing.html#quantifiers"><i class="fa fa-check"></i><b>1.5.5</b> Quantifiers</a></li>
<li class="chapter" data-level="1.5.6" data-path="string-date-processing.html"><a href="string-date-processing.html#groups"><i class="fa fa-check"></i><b>1.5.6</b> Groups</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="tidy-relational-data.html"><a href="tidy-relational-data.html"><i class="fa fa-check"></i><b>2</b> Tidy &amp; Relational Data</a>
<ul>
<li class="chapter" data-level="2.1" data-path="tidy-relational-data.html"><a href="tidy-relational-data.html#tidy-datasets"><i class="fa fa-check"></i><b>2.1</b> Tidy Datasets</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="tidy-relational-data.html"><a href="tidy-relational-data.html#the-tidyr-package"><i class="fa fa-check"></i><b>2.1.1</b> The tidyr Package</a></li>
<li class="chapter" data-level="2.1.2" data-path="tidy-relational-data.html"><a href="tidy-relational-data.html#rows-into-columns"><i class="fa fa-check"></i><b>2.1.2</b> Rows into Columns</a></li>
<li class="chapter" data-level="2.1.3" data-path="tidy-relational-data.html"><a href="tidy-relational-data.html#columns-into-rows"><i class="fa fa-check"></i><b>2.1.3</b> Columns into Rows</a></li>
<li class="chapter" data-level="2.1.4" data-path="tidy-relational-data.html"><a href="tidy-relational-data.html#separating-values"><i class="fa fa-check"></i><b>2.1.4</b> Separating Values</a></li>
<li class="chapter" data-level="2.1.5" data-path="tidy-relational-data.html"><a href="tidy-relational-data.html#case-study-smart-ridership"><i class="fa fa-check"></i><b>2.1.5</b> Case Study: SMART Ridership</a></li>
<li class="chapter" data-level="2.1.6" data-path="tidy-relational-data.html"><a href="tidy-relational-data.html#without-tidyr"><i class="fa fa-check"></i><b>2.1.6</b> Without <code>tidyr</code></a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="tidy-relational-data.html"><a href="tidy-relational-data.html#relational-datasets"><i class="fa fa-check"></i><b>2.2</b> Relational Datasets</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="tidy-relational-data.html"><a href="tidy-relational-data.html#the-dplyr-package"><i class="fa fa-check"></i><b>2.2.1</b> The dplyr Package</a></li>
<li class="chapter" data-level="2.2.2" data-path="tidy-relational-data.html"><a href="tidy-relational-data.html#gradebook-dataset"><i class="fa fa-check"></i><b>2.2.2</b> Gradebook Dataset</a></li>
<li class="chapter" data-level="2.2.3" data-path="tidy-relational-data.html"><a href="tidy-relational-data.html#left-joins"><i class="fa fa-check"></i><b>2.2.3</b> Left Joins</a></li>
<li class="chapter" data-level="2.2.4" data-path="tidy-relational-data.html"><a href="tidy-relational-data.html#other-joins"><i class="fa fa-check"></i><b>2.2.4</b> Other Joins</a></li>
<li class="chapter" data-level="2.2.5" data-path="tidy-relational-data.html"><a href="tidy-relational-data.html#getting-clever-with-join_by"><i class="fa fa-check"></i><b>2.2.5</b> Getting Clever with <code>join_by</code></a></li>
<li class="chapter" data-level="2.2.6" data-path="tidy-relational-data.html"><a href="tidy-relational-data.html#examples"><i class="fa fa-check"></i><b>2.2.6</b> Examples</a></li>
<li class="chapter" data-level="2.2.7" data-path="tidy-relational-data.html"><a href="tidy-relational-data.html#be-explicit"><i class="fa fa-check"></i><b>2.2.7</b> Be Explicit</a></li>
<li class="chapter" data-level="2.2.8" data-path="tidy-relational-data.html"><a href="tidy-relational-data.html#conclusion"><i class="fa fa-check"></i><b>2.2.8</b> Conclusion</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Writing &amp; Debugging R Code</b></span></li>
<li class="chapter" data-level="3" data-path="best-practices-for-writing-r-scripts.html"><a href="best-practices-for-writing-r-scripts.html"><i class="fa fa-check"></i><b>3</b> Best Practices for Writing R Scripts</a>
<ul>
<li class="chapter" data-level="3.1" data-path="best-practices-for-writing-r-scripts.html"><a href="best-practices-for-writing-r-scripts.html#scripting-your-code"><i class="fa fa-check"></i><b>3.1</b> Scripting Your Code</a></li>
<li class="chapter" data-level="3.2" data-path="best-practices-for-writing-r-scripts.html"><a href="best-practices-for-writing-r-scripts.html#printing-output"><i class="fa fa-check"></i><b>3.2</b> Printing Output</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="best-practices-for-writing-r-scripts.html"><a href="best-practices-for-writing-r-scripts.html#the-print-function"><i class="fa fa-check"></i><b>3.2.1</b> The <code>print</code> Function</a></li>
<li class="chapter" data-level="3.2.2" data-path="best-practices-for-writing-r-scripts.html"><a href="best-practices-for-writing-r-scripts.html#the-message-function"><i class="fa fa-check"></i><b>3.2.2</b> The <code>message</code> Function</a></li>
<li class="chapter" data-level="3.2.3" data-path="best-practices-for-writing-r-scripts.html"><a href="best-practices-for-writing-r-scripts.html#the-cat-function"><i class="fa fa-check"></i><b>3.2.3</b> The <code>cat</code> Function</a></li>
<li class="chapter" data-level="3.2.4" data-path="best-practices-for-writing-r-scripts.html"><a href="best-practices-for-writing-r-scripts.html#formatting-output"><i class="fa fa-check"></i><b>3.2.4</b> Formatting Output</a></li>
<li class="chapter" data-level="3.2.5" data-path="best-practices-for-writing-r-scripts.html"><a href="best-practices-for-writing-r-scripts.html#logging-output"><i class="fa fa-check"></i><b>3.2.5</b> Logging Output</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="best-practices-for-writing-r-scripts.html"><a href="best-practices-for-writing-r-scripts.html#reading-input"><i class="fa fa-check"></i><b>3.3</b> Reading Input</a></li>
<li class="chapter" data-level="3.4" data-path="best-practices-for-writing-r-scripts.html"><a href="best-practices-for-writing-r-scripts.html#managing-packages"><i class="fa fa-check"></i><b>3.4</b> Managing Packages</a></li>
<li class="chapter" data-level="3.5" data-path="best-practices-for-writing-r-scripts.html"><a href="best-practices-for-writing-r-scripts.html#iteration-strategies"><i class="fa fa-check"></i><b>3.5</b> Iteration Strategies</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="best-practices-for-writing-r-scripts.html"><a href="best-practices-for-writing-r-scripts.html#for-loops"><i class="fa fa-check"></i><b>3.5.1</b> For-loops</a></li>
<li class="chapter" data-level="3.5.2" data-path="best-practices-for-writing-r-scripts.html"><a href="best-practices-for-writing-r-scripts.html#while-loops"><i class="fa fa-check"></i><b>3.5.2</b> While-loops</a></li>
<li class="chapter" data-level="3.5.3" data-path="best-practices-for-writing-r-scripts.html"><a href="best-practices-for-writing-r-scripts.html#saving-multiple-results"><i class="fa fa-check"></i><b>3.5.3</b> Saving Multiple Results</a></li>
<li class="chapter" data-level="3.5.4" data-path="best-practices-for-writing-r-scripts.html"><a href="best-practices-for-writing-r-scripts.html#break-next"><i class="fa fa-check"></i><b>3.5.4</b> Break &amp; Next</a></li>
<li class="chapter" data-level="3.5.5" data-path="best-practices-for-writing-r-scripts.html"><a href="best-practices-for-writing-r-scripts.html#planning-for-iteration"><i class="fa fa-check"></i><b>3.5.5</b> Planning for Iteration</a></li>
<li class="chapter" data-level="3.5.6" data-path="best-practices-for-writing-r-scripts.html"><a href="best-practices-for-writing-r-scripts.html#case-study-the-collatz-conjecture"><i class="fa fa-check"></i><b>3.5.6</b> Case Study: The Collatz Conjecture</a></li>
<li class="chapter" data-level="3.5.7" data-path="best-practices-for-writing-r-scripts.html"><a href="best-practices-for-writing-r-scripts.html#case-study-u.s.-fruit-prices"><i class="fa fa-check"></i><b>3.5.7</b> Case Study: U.S. Fruit Prices</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="squashing-bugs-with-rs-debugging-tools.html"><a href="squashing-bugs-with-rs-debugging-tools.html"><i class="fa fa-check"></i><b>4</b> Squashing Bugs with R’s Debugging Tools</a>
<ul>
<li class="chapter" data-level="4.1" data-path="squashing-bugs-with-rs-debugging-tools.html"><a href="squashing-bugs-with-rs-debugging-tools.html#printing-1"><i class="fa fa-check"></i><b>4.1</b> Printing</a></li>
<li class="chapter" data-level="4.2" data-path="squashing-bugs-with-rs-debugging-tools.html"><a href="squashing-bugs-with-rs-debugging-tools.html#the-conditions-system"><i class="fa fa-check"></i><b>4.2</b> The Conditions System</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="squashing-bugs-with-rs-debugging-tools.html"><a href="squashing-bugs-with-rs-debugging-tools.html#raising-conditions"><i class="fa fa-check"></i><b>4.2.1</b> Raising Conditions</a></li>
<li class="chapter" data-level="4.2.2" data-path="squashing-bugs-with-rs-debugging-tools.html"><a href="squashing-bugs-with-rs-debugging-tools.html#handling-conditions"><i class="fa fa-check"></i><b>4.2.2</b> Handling Conditions</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="squashing-bugs-with-rs-debugging-tools.html"><a href="squashing-bugs-with-rs-debugging-tools.html#global-options"><i class="fa fa-check"></i><b>4.3</b> Global Options</a></li>
<li class="chapter" data-level="4.4" data-path="squashing-bugs-with-rs-debugging-tools.html"><a href="squashing-bugs-with-rs-debugging-tools.html#debugging"><i class="fa fa-check"></i><b>4.4</b> Debugging</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="squashing-bugs-with-rs-debugging-tools.html"><a href="squashing-bugs-with-rs-debugging-tools.html#read-your-errors-and-warnings"><i class="fa fa-check"></i><b>4.4.1</b> Read Your Errors and Warnings</a></li>
<li class="chapter" data-level="4.4.2" data-path="squashing-bugs-with-rs-debugging-tools.html"><a href="squashing-bugs-with-rs-debugging-tools.html#workflow-debugging"><i class="fa fa-check"></i><b>4.4.2</b> Workflow Debugging</a></li>
<li class="chapter" data-level="4.4.3" data-path="squashing-bugs-with-rs-debugging-tools.html"><a href="squashing-bugs-with-rs-debugging-tools.html#isolate-the-problem"><i class="fa fa-check"></i><b>4.4.3</b> Isolate the Problem</a></li>
<li class="chapter" data-level="4.4.4" data-path="squashing-bugs-with-rs-debugging-tools.html"><a href="squashing-bugs-with-rs-debugging-tools.html#other-functions"><i class="fa fa-check"></i><b>4.4.4</b> Other Functions</a></li>
<li class="chapter" data-level="4.4.5" data-path="squashing-bugs-with-rs-debugging-tools.html"><a href="squashing-bugs-with-rs-debugging-tools.html#debugging-case-study-boottrapping-average-penguin-mass"><i class="fa fa-check"></i><b>4.4.5</b> Debugging Case Study: Boottrapping Average Penguin Mass</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="squashing-bugs-with-rs-debugging-tools.html"><a href="squashing-bugs-with-rs-debugging-tools.html#measuring-performance"><i class="fa fa-check"></i><b>4.5</b> Measuring Performance</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="squashing-bugs-with-rs-debugging-tools.html"><a href="squashing-bugs-with-rs-debugging-tools.html#estimating-memory-usage"><i class="fa fa-check"></i><b>4.5.1</b> Estimating Memory Usage</a></li>
<li class="chapter" data-level="4.5.2" data-path="squashing-bugs-with-rs-debugging-tools.html"><a href="squashing-bugs-with-rs-debugging-tools.html#benchmarking"><i class="fa fa-check"></i><b>4.5.2</b> Benchmarking</a></li>
<li class="chapter" data-level="4.5.3" data-path="squashing-bugs-with-rs-debugging-tools.html"><a href="squashing-bugs-with-rs-debugging-tools.html#profiling"><i class="fa fa-check"></i><b>4.5.3</b> Profiling</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Data Visualization &amp; Analysis in R</b></span></li>
<li class="chapter" data-level="5" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html"><i class="fa fa-check"></i><b>5</b> Data Visualization in R</a>
<ul>
<li class="chapter" data-level="5.1" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#our-friend-ggplot2"><i class="fa fa-check"></i><b>5.1</b> Our Friend <code>ggplot2</code></a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#the-grammar-of-graphics"><i class="fa fa-check"></i><b>5.1.1</b> The Grammar of Graphics</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#example-palmer-penguins"><i class="fa fa-check"></i><b>5.2</b> Example: Palmer Penguins</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#examining-the-plot"><i class="fa fa-check"></i><b>5.2.1</b> Examining the Plot</a></li>
<li class="chapter" data-level="5.2.2" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#duplicating-the-palmer-penguins-plot"><i class="fa fa-check"></i><b>5.2.2</b> Duplicating the Palmer Penguins Plot</a></li>
<li class="chapter" data-level="5.2.3" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#analysis"><i class="fa fa-check"></i><b>5.2.3</b> Analysis</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#layers"><i class="fa fa-check"></i><b>5.3</b> Layers</a></li>
<li class="chapter" data-level="5.4" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#guidelines-for-graphics"><i class="fa fa-check"></i><b>5.4</b> Guidelines for Graphics</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#data"><i class="fa fa-check"></i><b>5.4.1</b> Data</a></li>
<li class="chapter" data-level="5.4.2" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#feature-types"><i class="fa fa-check"></i><b>5.4.2</b> Feature Types</a></li>
<li class="chapter" data-level="5.4.3" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#theme-guidelines"><i class="fa fa-check"></i><b>5.4.3</b> Theme Guidelines</a></li>
<li class="chapter" data-level="5.4.4" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#scale-guidelines"><i class="fa fa-check"></i><b>5.4.4</b> Scale Guidelines</a></li>
<li class="chapter" data-level="5.4.5" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#facet-guidelines"><i class="fa fa-check"></i><b>5.4.5</b> Facet Guidelines</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#case-studies"><i class="fa fa-check"></i><b>5.5</b> Case Studies</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#counting-penguins"><i class="fa fa-check"></i><b>5.5.1</b> Counting Penguins</a></li>
<li class="chapter" data-level="5.5.2" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#experimental-data-with-error-bars"><i class="fa fa-check"></i><b>5.5.2</b> Experimental Data with Error Bars</a></li>
<li class="chapter" data-level="5.5.3" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#bird-flu-mortality"><i class="fa fa-check"></i><b>5.5.3</b> Bird Flu Mortality</a></li>
<li class="chapter" data-level="5.5.4" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#small-business-loans"><i class="fa fa-check"></i><b>5.5.4</b> Small Business Loans</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV Thinking in R</b></span></li>
<li class="chapter" data-level="6" data-path="language-fundamentals.html"><a href="language-fundamentals.html"><i class="fa fa-check"></i><b>6</b> Language Fundamentals</a>
<ul>
<li class="chapter" data-level="6.1" data-path="language-fundamentals.html"><a href="language-fundamentals.html#variables-environments"><i class="fa fa-check"></i><b>6.1</b> Variables &amp; Environments</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="language-fundamentals.html"><a href="language-fundamentals.html#whats-an-environment"><i class="fa fa-check"></i><b>6.1.1</b> What’s an Environment?</a></li>
<li class="chapter" data-level="6.1.2" data-path="language-fundamentals.html"><a href="language-fundamentals.html#reference-objects"><i class="fa fa-check"></i><b>6.1.2</b> Reference Objects</a></li>
<li class="chapter" data-level="6.1.3" data-path="language-fundamentals.html"><a href="language-fundamentals.html#the-local-environment"><i class="fa fa-check"></i><b>6.1.3</b> The Local Environment</a></li>
<li class="chapter" data-level="6.1.4" data-path="language-fundamentals.html"><a href="language-fundamentals.html#call-environments"><i class="fa fa-check"></i><b>6.1.4</b> Call Environments</a></li>
<li class="chapter" data-level="6.1.5" data-path="language-fundamentals.html"><a href="language-fundamentals.html#lexical-scoping"><i class="fa fa-check"></i><b>6.1.5</b> Lexical Scoping</a></li>
<li class="chapter" data-level="6.1.6" data-path="language-fundamentals.html"><a href="language-fundamentals.html#variable-lookup"><i class="fa fa-check"></i><b>6.1.6</b> Variable Lookup</a></li>
<li class="chapter" data-level="6.1.7" data-path="language-fundamentals.html"><a href="language-fundamentals.html#the-search-path"><i class="fa fa-check"></i><b>6.1.7</b> The Search Path</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="language-fundamentals.html"><a href="language-fundamentals.html#closures"><i class="fa fa-check"></i><b>6.2</b> Closures</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="language-fundamentals.html"><a href="language-fundamentals.html#tidy-closures"><i class="fa fa-check"></i><b>6.2.1</b> Tidy Closures</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="language-fundamentals.html"><a href="language-fundamentals.html#attributes"><i class="fa fa-check"></i><b>6.3</b> Attributes</a></li>
<li class="chapter" data-level="6.4" data-path="language-fundamentals.html"><a href="language-fundamentals.html#s3"><i class="fa fa-check"></i><b>6.4</b> S3</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="language-fundamentals.html"><a href="language-fundamentals.html#method-dispatch"><i class="fa fa-check"></i><b>6.4.1</b> Method Dispatch</a></li>
<li class="chapter" data-level="6.4.2" data-path="language-fundamentals.html"><a href="language-fundamentals.html#creating-objects"><i class="fa fa-check"></i><b>6.4.2</b> Creating Objects</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="language-fundamentals.html"><a href="language-fundamentals.html#other-object-systems"><i class="fa fa-check"></i><b>6.5</b> Other Object Systems</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="part-2.html"><a href="part-2.html"><i class="fa fa-check"></i><b>7</b> Part 2</a></li>
<li class="part"><span><b>V Backmatter</b></span></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="chapter" data-level="" data-path="assessment.html"><a href="assessment.html"><i class="fa fa-check"></i>Assessment</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Intermediate R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="language-fundamentals" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">6</span> Language Fundamentals<a href="language-fundamentals.html#language-fundamentals" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This chapter is part 1 (of 2) of <em>Thinking in R</em>, a workshop series about how R
works and how to examine code critically. The major topics of this chapter are
how R stores and locates variables (including functions) defined in your code
and in packages, and how some of R’s object-oriented programming systems work.</p>
<div id="learning-objectives-4" class="section level4 unnumbered hasAnchor">
<h4>Learning Objectives<a href="language-fundamentals.html#learning-objectives-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>After completing this session, learners should be able to:</p>
<ul>
<li>Explain what an environment is and how R uses them</li>
<li>Explain how R looks up variables</li>
<li>Explain what attributes are and how R uses them</li>
<li>Get and set attributes</li>
<li>Explain what (S3) classes are and how R uses them</li>
<li>Explain R’s (S3) method dispatch system</li>
<li>Create an (S3) class</li>
<li>Describe R’s other object-oriented programming systems at a high level</li>
</ul>
</div>
<div id="variables-environments" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> Variables &amp; Environments<a href="language-fundamentals.html#variables-environments" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Assigning and looking up values of variables are fundamental operations in R,
as in most programming languages. They were likely among the first operations
you learned, and now you use them instictively. This section is a deep dive
into what R actually does when you assign a variables and how R looks up the
values of those variables later. Understanding the process and the data
structures involved will introduce you to new programming strategies, make it
easier to reason about code, and help you identify potential bugs.</p>
<div id="whats-an-environment" class="section level3 hasAnchor" number="6.1.1">
<h3><span class="header-section-number">6.1.1</span> What’s an Environment?<a href="language-fundamentals.html#whats-an-environment" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The foundation of how R stores and looks up variables is a data structure
called an <strong>environment</strong>. Every environment has two parts:</p>
<ol style="list-style-type: decimal">
<li>A <strong>frame</strong>, which is a collection of names and associated R objects.</li>
<li>A <strong>parent</strong> or <strong>enclosing</strong> environment, which must be another
environment.</li>
</ol>
<p>For now, you’ll learn how to create environments and how to assign and get
values from their frames. Parent environments will be explained in a later
section.</p>
<p>You can use the <code>new.env</code> function to create a new environment:</p>
<div class="sourceCode" id="cb452"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb452-1"><a href="language-fundamentals.html#cb452-1" tabindex="-1"></a>e <span class="ot">=</span> <span class="fu">new.env</span>()</span>
<span id="cb452-2"><a href="language-fundamentals.html#cb452-2" tabindex="-1"></a>e</span></code></pre></div>
<pre><code>## &lt;environment: 0x7fb171d1c938&gt;</code></pre>
<p>Unlike most objects, printing an environment doesn’t print its contents.
Instead, R prints its type (which is <code>environment</code>) and a unique identifier
(<code>0x7fb171d1c938</code> in this case).</p>
<p>The unique identifier is actually the <strong>memory address</strong> of the environment.
Every object you use in R is stored as a series of <a href="https://en.wikipedia.org/wiki/Byte">bytes</a> in your computer’s
<a href="https://en.wikipedia.org/wiki/Random-access_memory">random-access memory (RAM)</a>. Each byte in memory has a unique address,
similar to how each house on a street has a unique address. Memory addresses
are usually just numbers counting up from 0, but they’re often written in
<a href="https://en.wikipedia.org/wiki/Hexadecimal">hexadecimal (base 16)</a> (indicated by the prefix <code>0x</code>) because it’s more
concise. For the purposes of this reader, you can just think of the memory
address as a unique identifier.</p>
<p>To see the names in an environment’s frame, you can call the <code>ls</code> or <code>names</code>
function on the environment:</p>
<div class="sourceCode" id="cb454"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb454-1"><a href="language-fundamentals.html#cb454-1" tabindex="-1"></a><span class="fu">ls</span>(e)</span></code></pre></div>
<pre><code>## character(0)</code></pre>
<div class="sourceCode" id="cb456"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb456-1"><a href="language-fundamentals.html#cb456-1" tabindex="-1"></a><span class="fu">names</span>(e)</span></code></pre></div>
<pre><code>## character(0)</code></pre>
<p>You just created the environment <code>e</code>, so its frame is currently empty. The
printout <code>character(0)</code> means R returned a character vector of length 0.</p>
<p>You can assign an R object to a name in an environment’s frame with the dollar
sign <code>$</code> operator or the double square bracket <code>[[</code> operator, similar to how
you would assign a named element of a list. For example, one way to assign the
number <code>8</code> to the name <code>"lucky"</code> in the environment <code>e</code>’s frame is:</p>
<div class="sourceCode" id="cb458"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb458-1"><a href="language-fundamentals.html#cb458-1" tabindex="-1"></a>e<span class="sc">$</span>lucky <span class="ot">=</span> <span class="dv">8</span></span></code></pre></div>
<p>Now there’s a name defined in the environment:</p>
<div class="sourceCode" id="cb459"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb459-1"><a href="language-fundamentals.html#cb459-1" tabindex="-1"></a><span class="fu">ls</span>(e)</span></code></pre></div>
<pre><code>## [1] &quot;lucky&quot;</code></pre>
<div class="sourceCode" id="cb461"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb461-1"><a href="language-fundamentals.html#cb461-1" tabindex="-1"></a><span class="fu">names</span>(e)</span></code></pre></div>
<pre><code>## [1] &quot;lucky&quot;</code></pre>
<p>Here’s another example of assigning an object to a name in the environment:</p>
<div class="sourceCode" id="cb463"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb463-1"><a href="language-fundamentals.html#cb463-1" tabindex="-1"></a>e[[<span class="st">&quot;my_message&quot;</span>]] <span class="ot">=</span> <span class="st">&quot;May your coffee kick in before reality does.&quot;</span></span></code></pre></div>
<p>You can assign any type of R object to a name in an environment, including
other environments.</p>
<p>The <code>ls</code> function ignores names that begin with a dot <code>.</code> by default. For
example:</p>
<div class="sourceCode" id="cb464"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb464-1"><a href="language-fundamentals.html#cb464-1" tabindex="-1"></a>e<span class="sc">$</span>.x <span class="ot">=</span> <span class="fu">list</span>(<span class="dv">1</span>, sin)</span>
<span id="cb464-2"><a href="language-fundamentals.html#cb464-2" tabindex="-1"></a><span class="fu">ls</span>(e)</span></code></pre></div>
<pre><code>## [1] &quot;lucky&quot;      &quot;my_message&quot;</code></pre>
<p>You can pass the argument <code>all.names = TRUE</code> to make the function return all
names in the frame:</p>
<div class="sourceCode" id="cb466"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb466-1"><a href="language-fundamentals.html#cb466-1" tabindex="-1"></a><span class="fu">ls</span>(e, <span class="at">all.names =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] &quot;.x&quot;         &quot;lucky&quot;      &quot;my_message&quot;</code></pre>
<p>Alternatively, you can just use the <code>names</code> function, which always prints all
names in an environment’s frame.</p>
<p>Objects in an environment’s frame don’t have positions or any particular order,
so they must always be assigned to a name. R raises an error if you try to
assign an object to a position:</p>
<div class="sourceCode" id="cb468"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb468-1"><a href="language-fundamentals.html#cb468-1" tabindex="-1"></a>e[[<span class="dv">3</span>]] <span class="ot">=</span> <span class="dv">10</span></span></code></pre></div>
<pre><code>## Error in e[[3]] = 10: wrong args for environment subassignment</code></pre>
<p>As you might expect, you can also use the dollar sign operator and double
square bracket operator to get objects in an environment by name:</p>
<div class="sourceCode" id="cb470"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb470-1"><a href="language-fundamentals.html#cb470-1" tabindex="-1"></a>e<span class="sc">$</span>my_message</span></code></pre></div>
<pre><code>## [1] &quot;May your coffee kick in before reality does.&quot;</code></pre>
<div class="sourceCode" id="cb472"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb472-1"><a href="language-fundamentals.html#cb472-1" tabindex="-1"></a>e[[<span class="st">&quot;lucky&quot;</span>]]</span></code></pre></div>
<pre><code>## [1] 8</code></pre>
<p>You can use the <code>exists</code> function to check whether a specific name exists in an
environment’s frame:</p>
<div class="sourceCode" id="cb474"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb474-1"><a href="language-fundamentals.html#cb474-1" tabindex="-1"></a><span class="fu">exists</span>(<span class="st">&quot;hi&quot;</span>, e)</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb476"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb476-1"><a href="language-fundamentals.html#cb476-1" tabindex="-1"></a><span class="fu">exists</span>(<span class="st">&quot;lucky&quot;</span>, e)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>Finally, you can remove a name and object from an environment’s frame with the
<code>rm</code> function. Make sure to pass the environment as the argument to the <code>envir</code>
parameter when you do this:</p>
<div class="sourceCode" id="cb478"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb478-1"><a href="language-fundamentals.html#cb478-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="st">&quot;lucky&quot;</span>, <span class="at">envir =</span> e)</span>
<span id="cb478-2"><a href="language-fundamentals.html#cb478-2" tabindex="-1"></a><span class="fu">exists</span>(<span class="st">&quot;lucky&quot;</span>, e)</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
</div>
<div id="reference-objects" class="section level3 hasAnchor" number="6.1.2">
<h3><span class="header-section-number">6.1.2</span> Reference Objects<a href="language-fundamentals.html#reference-objects" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Environments are <strong>reference objects</strong>, which means they don’t follow R’s
<strong>copy-on-write rule</strong>: for most types of objects, if you modify the object, R
automatically and silently makes a copy, so that any other variables that refer
to the object remain unchanged.</p>
<p>As an example, lists follow the copy-on-write rule. Suppose you assign a list
to variable <code>x</code>, assign <code>x</code> to <code>y</code>, and then make a change to <code>x</code>:</p>
<div class="sourceCode" id="cb480"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb480-1"><a href="language-fundamentals.html#cb480-1" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">list</span>()</span>
<span id="cb480-2"><a href="language-fundamentals.html#cb480-2" tabindex="-1"></a>x<span class="sc">$</span>a <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb480-3"><a href="language-fundamentals.html#cb480-3" tabindex="-1"></a>x</span></code></pre></div>
<pre><code>## $a
## [1] 10</code></pre>
<div class="sourceCode" id="cb482"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb482-1"><a href="language-fundamentals.html#cb482-1" tabindex="-1"></a>y <span class="ot">=</span> x</span>
<span id="cb482-2"><a href="language-fundamentals.html#cb482-2" tabindex="-1"></a>x<span class="sc">$</span>a <span class="ot">=</span> <span class="dv">20</span></span>
<span id="cb482-3"><a href="language-fundamentals.html#cb482-3" tabindex="-1"></a>y</span></code></pre></div>
<pre><code>## $a
## [1] 10</code></pre>
<p>When you run <code>y = x</code>, R makes <code>y</code> refer to the same object as <code>x</code>, without
using any additional memory. When you run <code>x$a = 20</code>, the copy-on-write rule
applies, so R creates and modifies a copy of the object. From then on, <code>x</code>
refers to the modified copy and <code>y</code> refers to the original.</p>
<p>Environments don’t follow the copy-on-write rule, so repeating the example with
an enviroment produces a different result:</p>
<div class="sourceCode" id="cb484"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb484-1"><a href="language-fundamentals.html#cb484-1" tabindex="-1"></a>e_x <span class="ot">=</span> <span class="fu">new.env</span>()</span>
<span id="cb484-2"><a href="language-fundamentals.html#cb484-2" tabindex="-1"></a>e_x<span class="sc">$</span>a <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb484-3"><a href="language-fundamentals.html#cb484-3" tabindex="-1"></a>e_x<span class="sc">$</span>a</span></code></pre></div>
<pre><code>## [1] 10</code></pre>
<div class="sourceCode" id="cb486"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb486-1"><a href="language-fundamentals.html#cb486-1" tabindex="-1"></a>e_y <span class="ot">=</span> e_x</span>
<span id="cb486-2"><a href="language-fundamentals.html#cb486-2" tabindex="-1"></a>e_x<span class="sc">$</span>a <span class="ot">=</span> <span class="dv">20</span></span>
<span id="cb486-3"><a href="language-fundamentals.html#cb486-3" tabindex="-1"></a>e_y<span class="sc">$</span>a</span></code></pre></div>
<pre><code>## [1] 20</code></pre>
<p>As before, <code>e_y = e_x</code> makes both <code>e_y</code> and <code>e_x</code> refer to the same object. The
difference is that when you run <code>e_x$a = 20</code>, the copy-on-write rule does not
apply and R does not create a copy of the environment. As a result, the change
to <code>e_x</code> is also reflected in <code>e_y</code>.</p>
<p>Environments and other reference objects can be confusing since they behave
differently from most objects. You usually won’t need to construct or
manipulate environments directly, but it’s useful to know how to inspect them.</p>
</div>
<div id="the-local-environment" class="section level3 hasAnchor" number="6.1.3">
<h3><span class="header-section-number">6.1.3</span> The Local Environment<a href="language-fundamentals.html#the-local-environment" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Think of environments as containers for variables. Whenever you assign a
variable, R assigns it to the frame of an environment. Whenever you get a
variable, R searches through one or more environments for its value.</p>
<p>When you start R, R creates a special environment called the <strong>global
environment</strong> to store variables you assign at the prompt or the top level of a
script. You can use the <code>globalenv</code> function to get the global environment:</p>
<div class="sourceCode" id="cb488"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb488-1"><a href="language-fundamentals.html#cb488-1" tabindex="-1"></a>g <span class="ot">=</span> <span class="fu">globalenv</span>()</span>
<span id="cb488-2"><a href="language-fundamentals.html#cb488-2" tabindex="-1"></a>g</span></code></pre></div>
<pre><code>## &lt;environment: R_GlobalEnv&gt;</code></pre>
<p>The global environment is easy to recognize because its unique identifier is
<code>R_GlobalEnv</code> rather than its memory address (even though it’s stored in your
computer’s memory like any other object).</p>
<p>The <strong>local environment</strong> is the environment where the assignment operators
<code>&lt;-</code> and <code>=</code> assign variables. Think of the local environment as the
environment that’s currently active. The local environment varies depending on
the context where you run an expression. You can get the local environment with
the <code>environment</code> function:</p>
<div class="sourceCode" id="cb490"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb490-1"><a href="language-fundamentals.html#cb490-1" tabindex="-1"></a>loc <span class="ot">=</span> <span class="fu">environment</span>()</span>
<span id="cb490-2"><a href="language-fundamentals.html#cb490-2" tabindex="-1"></a>loc</span></code></pre></div>
<pre><code>## &lt;environment: R_GlobalEnv&gt;</code></pre>
<p>As you can see, at the R prompt or the top level of an R script, the local
environment is just the global environment.</p>
<p>Except for <code>names</code>, the functions introduced in Section
<a href="language-fundamentals.html#whats-an-environment">6.1.1</a> default to the local environment if you don’t set
the <code>envir</code> parameter. This makes them convenient for inspecting or modifying
the local environment’s frame:</p>
<div class="sourceCode" id="cb492"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb492-1"><a href="language-fundamentals.html#cb492-1" tabindex="-1"></a><span class="fu">ls</span>(loc)</span></code></pre></div>
<pre><code>## [1] &quot;e&quot;   &quot;e_x&quot; &quot;e_y&quot; &quot;g&quot;   &quot;loc&quot; &quot;x&quot;   &quot;y&quot;</code></pre>
<div class="sourceCode" id="cb494"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb494-1"><a href="language-fundamentals.html#cb494-1" tabindex="-1"></a><span class="fu">ls</span>()</span></code></pre></div>
<pre><code>## [1] &quot;e&quot;   &quot;e_x&quot; &quot;e_y&quot; &quot;g&quot;   &quot;loc&quot; &quot;x&quot;   &quot;y&quot;</code></pre>
<p>If you assign a variable, it appears in the local environment’s frame:</p>
<div class="sourceCode" id="cb496"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb496-1"><a href="language-fundamentals.html#cb496-1" tabindex="-1"></a>coffee <span class="ot">=</span> <span class="st">&quot;Right. No coffee. This is a terrible planet.&quot;</span></span>
<span id="cb496-2"><a href="language-fundamentals.html#cb496-2" tabindex="-1"></a><span class="fu">ls</span>()</span></code></pre></div>
<pre><code>## [1] &quot;coffee&quot; &quot;e&quot;      &quot;e_x&quot;    &quot;e_y&quot;    &quot;g&quot;      &quot;loc&quot;    &quot;x&quot;      &quot;y&quot;</code></pre>
<div class="sourceCode" id="cb498"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb498-1"><a href="language-fundamentals.html#cb498-1" tabindex="-1"></a>loc<span class="sc">$</span>coffee</span></code></pre></div>
<pre><code>## [1] &quot;Right. No coffee. This is a terrible planet.&quot;</code></pre>
<p>Conversely, if you assign an object in the local environment’s frame, you can
access it as a variable:</p>
<div class="sourceCode" id="cb500"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb500-1"><a href="language-fundamentals.html#cb500-1" tabindex="-1"></a>loc<span class="sc">$</span>tea <span class="ot">=</span> <span class="st">&quot;Tea isn&#39;t coffee!&quot;</span></span>
<span id="cb500-2"><a href="language-fundamentals.html#cb500-2" tabindex="-1"></a>tea</span></code></pre></div>
<pre><code>## [1] &quot;Tea isn&#39;t coffee!&quot;</code></pre>
</div>
<div id="call-environments" class="section level3 hasAnchor" number="6.1.4">
<h3><span class="header-section-number">6.1.4</span> Call Environments<a href="language-fundamentals.html#call-environments" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Every time you <em>call</em> (not define) a function, R creates a new environment.
R uses this <strong>call environment</strong> as the local environment while the code in the
body of the function runs. As a result, assigning variables in a function
doesn’t affect the global environment, and they generally can’t be accessed
from outside of the function.</p>
<p>For example, consider this function which assigns the variable <code>hello</code>:</p>
<div class="sourceCode" id="cb502"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb502-1"><a href="language-fundamentals.html#cb502-1" tabindex="-1"></a>my_hello <span class="ot">=</span> <span class="cf">function</span>() {</span>
<span id="cb502-2"><a href="language-fundamentals.html#cb502-2" tabindex="-1"></a>  hello <span class="ot">=</span> <span class="st">&quot;from the other side&quot;</span></span>
<span id="cb502-3"><a href="language-fundamentals.html#cb502-3" tabindex="-1"></a>}</span></code></pre></div>
<p>Even after calling the function, there’s no variable <code>hello</code> in the global
environment:</p>
<div class="sourceCode" id="cb503"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb503-1"><a href="language-fundamentals.html#cb503-1" tabindex="-1"></a><span class="fu">my_hello</span>()</span>
<span id="cb503-2"><a href="language-fundamentals.html#cb503-2" tabindex="-1"></a><span class="fu">names</span>(g)</span></code></pre></div>
<pre><code>##  [1] &quot;loc&quot;      &quot;my_hello&quot; &quot;tea&quot;      &quot;e_x&quot;      &quot;x&quot;        &quot;e_y&quot;     
##  [7] &quot;y&quot;        &quot;coffee&quot;   &quot;e&quot;        &quot;g&quot;</code></pre>
<p>As further demonstration, consider this modified version of <code>my_hello</code>, which
returns the call environment:</p>
<div class="sourceCode" id="cb505"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb505-1"><a href="language-fundamentals.html#cb505-1" tabindex="-1"></a>my_hello <span class="ot">=</span> <span class="cf">function</span>() {</span>
<span id="cb505-2"><a href="language-fundamentals.html#cb505-2" tabindex="-1"></a>  hello <span class="ot">=</span> <span class="st">&quot;from the other side&quot;</span></span>
<span id="cb505-3"><a href="language-fundamentals.html#cb505-3" tabindex="-1"></a>  <span class="fu">environment</span>()</span>
<span id="cb505-4"><a href="language-fundamentals.html#cb505-4" tabindex="-1"></a>}</span></code></pre></div>
<p>The call environment is not the global environment:</p>
<div class="sourceCode" id="cb506"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb506-1"><a href="language-fundamentals.html#cb506-1" tabindex="-1"></a>e <span class="ot">=</span> <span class="fu">my_hello</span>()</span>
<span id="cb506-2"><a href="language-fundamentals.html#cb506-2" tabindex="-1"></a>e</span></code></pre></div>
<pre><code>## &lt;environment: 0x7fb16cf87470&gt;</code></pre>
<p>And the variable <code>hello</code> exists in the call environment, but not in the global
environment:</p>
<div class="sourceCode" id="cb508"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb508-1"><a href="language-fundamentals.html#cb508-1" tabindex="-1"></a><span class="fu">exists</span>(<span class="st">&quot;hello&quot;</span>, g)</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb510"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb510-1"><a href="language-fundamentals.html#cb510-1" tabindex="-1"></a><span class="fu">exists</span>(<span class="st">&quot;hello&quot;</span>, e)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb512"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb512-1"><a href="language-fundamentals.html#cb512-1" tabindex="-1"></a>e<span class="sc">$</span>hello</span></code></pre></div>
<pre><code>## [1] &quot;from the other side&quot;</code></pre>
<p>Each call to a function creates a new call environment. So if you call
<code>my_hello</code> again, it returns a different environment (pay attention to the
memory address):</p>
<div class="sourceCode" id="cb514"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb514-1"><a href="language-fundamentals.html#cb514-1" tabindex="-1"></a>e2 <span class="ot">=</span> <span class="fu">my_hello</span>()</span>
<span id="cb514-2"><a href="language-fundamentals.html#cb514-2" tabindex="-1"></a>e</span></code></pre></div>
<pre><code>## &lt;environment: 0x7fb16cf87470&gt;</code></pre>
<div class="sourceCode" id="cb516"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb516-1"><a href="language-fundamentals.html#cb516-1" tabindex="-1"></a>e2</span></code></pre></div>
<pre><code>## &lt;environment: 0x7fb172d278d0&gt;</code></pre>
<p>By creating a new environment for every call, R isolates code in the function
body from code outside of the body. As a result, most R functions have no
<strong>side effects</strong>. This is a good thing, since it means you generally don’t have
to worry about calls assigning, reassigning, or removing variables in other
environments (such as the global environment!).</p>
<p>The <code>local</code> function provides another way to create a new local environment in
which to run code. However, it’s usually preferable to define and call a
function, since that makes it easier to test and reuse the code.</p>
</div>
<div id="lexical-scoping" class="section level3 hasAnchor" number="6.1.5">
<h3><span class="header-section-number">6.1.5</span> Lexical Scoping<a href="language-fundamentals.html#lexical-scoping" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A function can access variables outside of its local environment, but only if
those variables exist in the environment where the function was <em>defined</em> (not
called). This property is called <strong>lexical scoping</strong>.</p>
<p>For example, assign a variable <code>tea</code> and function <code>get_tea</code> in the global
environment:</p>
<div class="sourceCode" id="cb518"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb518-1"><a href="language-fundamentals.html#cb518-1" tabindex="-1"></a>tea <span class="ot">=</span> <span class="st">&quot;Tea isn&#39;t coffee!&quot;</span></span>
<span id="cb518-2"><a href="language-fundamentals.html#cb518-2" tabindex="-1"></a>get_tea <span class="ot">=</span> <span class="cf">function</span>() {</span>
<span id="cb518-3"><a href="language-fundamentals.html#cb518-3" tabindex="-1"></a>  tea</span>
<span id="cb518-4"><a href="language-fundamentals.html#cb518-4" tabindex="-1"></a>}</span></code></pre></div>
<p>Then the <code>get_tea</code> function can access the <code>tea</code> variable:</p>
<div class="sourceCode" id="cb519"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb519-1"><a href="language-fundamentals.html#cb519-1" tabindex="-1"></a><span class="fu">get_tea</span>()</span></code></pre></div>
<pre><code>## [1] &quot;Tea isn&#39;t coffee!&quot;</code></pre>
<p>Note that variable lookup takes place when a function is <em>called</em>, not when
it’s defined. This is called <strong>dynamic lookup</strong>.</p>
<p>For example, the result from <code>get_tea</code> changes if you change the value of
<code>tea</code>:</p>
<div class="sourceCode" id="cb521"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb521-1"><a href="language-fundamentals.html#cb521-1" tabindex="-1"></a>tea <span class="ot">=</span> <span class="st">&quot;Tea for two.&quot;</span></span>
<span id="cb521-2"><a href="language-fundamentals.html#cb521-2" tabindex="-1"></a><span class="fu">get_tea</span>()</span></code></pre></div>
<pre><code>## [1] &quot;Tea for two.&quot;</code></pre>
<div class="sourceCode" id="cb523"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb523-1"><a href="language-fundamentals.html#cb523-1" tabindex="-1"></a>tea <span class="ot">=</span> <span class="st">&quot;Tea isn&#39;t coffee!&quot;</span></span>
<span id="cb523-2"><a href="language-fundamentals.html#cb523-2" tabindex="-1"></a><span class="fu">get_tea</span>()</span></code></pre></div>
<pre><code>## [1] &quot;Tea isn&#39;t coffee!&quot;</code></pre>
<p>When a <strong>local variable</strong> (a variable in the local environment) and a non-local
variable have the same name, R almost always prioritizes the local variable.
For instance:</p>
<div class="sourceCode" id="cb525"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb525-1"><a href="language-fundamentals.html#cb525-1" tabindex="-1"></a>get_local_tea <span class="ot">=</span> <span class="cf">function</span>() {</span>
<span id="cb525-2"><a href="language-fundamentals.html#cb525-2" tabindex="-1"></a>  tea <span class="ot">=</span> <span class="st">&quot;Earl grey is tea!&quot;</span></span>
<span id="cb525-3"><a href="language-fundamentals.html#cb525-3" tabindex="-1"></a>  tea</span>
<span id="cb525-4"><a href="language-fundamentals.html#cb525-4" tabindex="-1"></a>}</span>
<span id="cb525-5"><a href="language-fundamentals.html#cb525-5" tabindex="-1"></a></span>
<span id="cb525-6"><a href="language-fundamentals.html#cb525-6" tabindex="-1"></a><span class="fu">get_local_tea</span>()</span></code></pre></div>
<pre><code>## [1] &quot;Earl grey is tea!&quot;</code></pre>
<p>The function body assigns the local variable <code>tea</code> to <code>"Earl grey is tea!"</code>, so
R returns that value rather than <code>"Tea isn't coffee!"</code>. In other words, local
variables <strong>mask</strong>, or hide, non-local variables with the same name.</p>
<p>There’s only one case where R doesn’t prioritize local variables. To see it,
consider this call:</p>
<div class="sourceCode" id="cb527"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb527-1"><a href="language-fundamentals.html#cb527-1" tabindex="-1"></a><span class="fu">mean</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>)</span></code></pre></div>
<pre><code>## [1] 10.5</code></pre>
<p>The variable <code>mean</code> must refer to a function, because it’s being called—it’s
followed by parentheses <code>( )</code>, the call syntax. In this situation, R ignores
local variables that aren’t functions, so you can write code such as:</p>
<div class="sourceCode" id="cb529"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb529-1"><a href="language-fundamentals.html#cb529-1" tabindex="-1"></a>mean <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb529-2"><a href="language-fundamentals.html#cb529-2" tabindex="-1"></a><span class="fu">mean</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span></code></pre></div>
<pre><code>## [1] 5.5</code></pre>
<p>That said, defining a local variable with the same name as a function can still
be confusing, so it’s usually considered a bad practice.</p>
<p>To help you reason about lexical scoping, you can get the environment where a
function was defined by calling the <code>environment</code> function on the function
itself. For example, the <code>get_tea</code> function was defined in the global
environment:</p>
<div class="sourceCode" id="cb531"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb531-1"><a href="language-fundamentals.html#cb531-1" tabindex="-1"></a><span class="fu">environment</span>(get_tea)</span></code></pre></div>
<pre><code>## &lt;environment: R_GlobalEnv&gt;</code></pre>
</div>
<div id="variable-lookup" class="section level3 hasAnchor" number="6.1.6">
<h3><span class="header-section-number">6.1.6</span> Variable Lookup<a href="language-fundamentals.html#variable-lookup" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The key to how R looks up variables and how lexical scoping works is that in
addition to a frame, every environment has a parent environment.</p>
<p>When R evaluates a variable in an expression, it starts by looking for the
variable in the local environment’s frame.</p>
<p>For example, at the prompt, <code>tea</code> is a local variable because that’s where you
assigned it. If you enter <code>tea</code> at the prompt, R finds <code>tea</code> in the local
environment’s frame and returns the value:</p>
<div class="sourceCode" id="cb533"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb533-1"><a href="language-fundamentals.html#cb533-1" tabindex="-1"></a>tea</span></code></pre></div>
<pre><code>## [1] &quot;Tea isn&#39;t coffee!&quot;</code></pre>
<p>On the other hand, in the <code>get_tea</code> function from Section
<a href="language-fundamentals.html#lexical-scoping">6.1.5</a>, <code>tea</code> is not a local variable:</p>
<div class="sourceCode" id="cb535"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb535-1"><a href="language-fundamentals.html#cb535-1" tabindex="-1"></a>get_tea <span class="ot">=</span> <span class="cf">function</span>() {</span>
<span id="cb535-2"><a href="language-fundamentals.html#cb535-2" tabindex="-1"></a>  tea</span>
<span id="cb535-3"><a href="language-fundamentals.html#cb535-3" tabindex="-1"></a>}</span></code></pre></div>
<p>To make this more concrete, consider a function which just returns its call
environment:</p>
<div class="sourceCode" id="cb536"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb536-1"><a href="language-fundamentals.html#cb536-1" tabindex="-1"></a>get_call_env <span class="ot">=</span> <span class="cf">function</span>() {</span>
<span id="cb536-2"><a href="language-fundamentals.html#cb536-2" tabindex="-1"></a>  <span class="fu">environment</span>()</span>
<span id="cb536-3"><a href="language-fundamentals.html#cb536-3" tabindex="-1"></a>}</span></code></pre></div>
<p>The call environment clearly doesn’t contain the <code>tea</code> variable:</p>
<div class="sourceCode" id="cb537"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb537-1"><a href="language-fundamentals.html#cb537-1" tabindex="-1"></a>e <span class="ot">=</span> <span class="fu">get_call_env</span>()</span>
<span id="cb537-2"><a href="language-fundamentals.html#cb537-2" tabindex="-1"></a><span class="fu">ls</span>(e)</span></code></pre></div>
<pre><code>## character(0)</code></pre>
<p>When a variable doesn’t exist in the local environment’s frame, then R gets the
parent environment of the local environment.</p>
<p>You can use the <code>parent.env</code> function to get the parent environment of an
environment. For the call environment <code>e</code>, the parent environment is the global
environment, because that’s where <code>get_call_env</code> was defined:</p>
<div class="sourceCode" id="cb539"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb539-1"><a href="language-fundamentals.html#cb539-1" tabindex="-1"></a><span class="fu">parent.env</span>(e)</span></code></pre></div>
<pre><code>## &lt;environment: R_GlobalEnv&gt;</code></pre>
<p>When R can’t find <code>tea</code> in the call environment’s frame, R gets the parent
environment, which is the global environment. Then R searches for <code>tea</code> in the
global environment, finds it, and returns the value.</p>
<p>R repeats the lookup process for as many parents as necessary to find the
variable, stopping only when it finds the variable or a special environment
called the <strong>empty environment</strong> which will be explained in Section
<a href="language-fundamentals.html#the-search-path">6.1.7</a>.</p>
<p>The lookup process also hints at how R finds variables and functions such as
<code>pi</code> and <code>sqrt</code> that clearly aren’t defined in the global environment. They’re
defined in parent environments of the global environment.</p>
<p>The <code>get</code> function looks up a variable by name:</p>
<div class="sourceCode" id="cb541"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb541-1"><a href="language-fundamentals.html#cb541-1" tabindex="-1"></a><span class="fu">get</span>(<span class="st">&quot;pi&quot;</span>)</span></code></pre></div>
<pre><code>## [1] 3.141593</code></pre>
<p>You can use the <code>get</code> function to look up a variable starting from a specific
environment or to control how R does the lookup the variable. For example, if
you set <code>inherits = FALSE</code>, R will not search any parent environments:</p>
<div class="sourceCode" id="cb543"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb543-1"><a href="language-fundamentals.html#cb543-1" tabindex="-1"></a><span class="fu">get</span>(<span class="st">&quot;pi&quot;</span>, <span class="at">inherits =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## Error in get(&quot;pi&quot;, inherits = FALSE): object &#39;pi&#39; not found</code></pre>
<p>As with most functions for inspecting and modifying environments, use the <code>get</code>
function sparingly. R already provides a much simpler way to get a variable:
the variable’s name.</p>
</div>
<div id="the-search-path" class="section level3 hasAnchor" number="6.1.7">
<h3><span class="header-section-number">6.1.7</span> The Search Path<a href="language-fundamentals.html#the-search-path" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>R also uses environments to manage packages. Each time you load a package with
<code>library</code> or <code>require</code>, R creates a new environment:</p>
<ul>
<li>The frame contains the package’s local variables.</li>
<li>The parent environment is the environment of the previous package loaded.</li>
<li>This new environment becomes the parent of the global environment.</li>
</ul>
<p>R always loads several built-in packages at startup, which contain variables
and functions such as <code>pi</code> and <code>sqrt</code>. Thus the global environment is never the
top-level environment. For instance:</p>
<div class="sourceCode" id="cb545"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb545-1"><a href="language-fundamentals.html#cb545-1" tabindex="-1"></a>g <span class="ot">=</span> <span class="fu">globalenv</span>()</span>
<span id="cb545-2"><a href="language-fundamentals.html#cb545-2" tabindex="-1"></a>e <span class="ot">=</span> <span class="fu">parent.env</span>(g)</span>
<span id="cb545-3"><a href="language-fundamentals.html#cb545-3" tabindex="-1"></a>e</span></code></pre></div>
<pre><code>## &lt;environment: package:stats&gt;
## attr(,&quot;name&quot;)
## [1] &quot;package:stats&quot;
## attr(,&quot;path&quot;)
## [1] &quot;/Library/Frameworks/R.framework/Versions/4.3-x86_64/Resources/library/stats&quot;</code></pre>
<div class="sourceCode" id="cb547"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb547-1"><a href="language-fundamentals.html#cb547-1" tabindex="-1"></a>e <span class="ot">=</span> <span class="fu">parent.env</span>(e)</span>
<span id="cb547-2"><a href="language-fundamentals.html#cb547-2" tabindex="-1"></a>e</span></code></pre></div>
<pre><code>## &lt;environment: package:graphics&gt;
## attr(,&quot;name&quot;)
## [1] &quot;package:graphics&quot;
## attr(,&quot;path&quot;)
## [1] &quot;/Library/Frameworks/R.framework/Versions/4.3-x86_64/Resources/library/graphics&quot;</code></pre>
<p>Notice that package environments use <code>package:</code> and the name of the package as
their unique identifier rather than their memory address.</p>
<p>The chain of package environments is called the <strong>search path</strong>. The <code>search</code>
function returns the search path:</p>
<div class="sourceCode" id="cb549"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb549-1"><a href="language-fundamentals.html#cb549-1" tabindex="-1"></a><span class="fu">search</span>()</span></code></pre></div>
<pre><code>## [1] &quot;.GlobalEnv&quot;        &quot;package:stats&quot;     &quot;package:graphics&quot; 
## [4] &quot;package:grDevices&quot; &quot;package:utils&quot;     &quot;package:datasets&quot; 
## [7] &quot;package:methods&quot;   &quot;Autoloads&quot;         &quot;package:base&quot;</code></pre>
<p>The <strong>base environment</strong> (identified by <code>base</code>) is the always topmost
environment. You can use the <code>baseenv</code> function to get the base environment:</p>
<div class="sourceCode" id="cb551"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb551-1"><a href="language-fundamentals.html#cb551-1" tabindex="-1"></a><span class="fu">baseenv</span>()</span></code></pre></div>
<pre><code>## &lt;environment: base&gt;</code></pre>
<p>The base environment’s parent is the special empty environment (identified by
<code>R_EmptyEnv</code>), which contains no variables and has no parent. You can use the
<code>emptyenv</code> function to get the empty environment:</p>
<div class="sourceCode" id="cb553"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb553-1"><a href="language-fundamentals.html#cb553-1" tabindex="-1"></a><span class="fu">emptyenv</span>()</span></code></pre></div>
<pre><code>## &lt;environment: R_EmptyEnv&gt;</code></pre>
<p>Understanding R’s process for looking up variables and the search path is
helpful for resolving conflicts between the names of variables in packages.</p>
<div id="the-colon-operators" class="section level4 hasAnchor" number="6.1.7.1">
<h4><span class="header-section-number">6.1.7.1</span> The Colon Operators<a href="language-fundamentals.html#the-colon-operators" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The double-colon operator <code>::</code> gets a variable in a specific package. Two
common uses:</p>
<ol style="list-style-type: decimal">
<li>Disambiguate which package you mean when several packages have variables
with the same names.</li>
<li>Get a variable from a package without loading the package.</li>
</ol>
<p>For example:</p>
<div class="sourceCode" id="cb555"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb555-1"><a href="language-fundamentals.html#cb555-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;dplyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     intersect, setdiff, setequal, union</code></pre>
<div class="sourceCode" id="cb559"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb559-1"><a href="language-fundamentals.html#cb559-1" tabindex="-1"></a>stats<span class="sc">::</span>filter</span></code></pre></div>
<pre><code>## function (x, filter, method = c(&quot;convolution&quot;, &quot;recursive&quot;), 
##     sides = 2L, circular = FALSE, init = NULL) 
## {
##     method &lt;- match.arg(method)
##     x &lt;- as.ts(x)
##     storage.mode(x) &lt;- &quot;double&quot;
##     xtsp &lt;- tsp(x)
##     n &lt;- as.integer(NROW(x))
##     if (is.na(n)) 
##         stop(gettextf(&quot;invalid value of %s&quot;, &quot;NROW(x)&quot;), domain = NA)
##     nser &lt;- NCOL(x)
##     filter &lt;- as.double(filter)
##     nfilt &lt;- as.integer(length(filter))
##     if (is.na(nfilt)) 
##         stop(gettextf(&quot;invalid value of %s&quot;, &quot;length(filter)&quot;), 
##             domain = NA)
##     if (anyNA(filter)) 
##         stop(&quot;missing values in &#39;filter&#39;&quot;)
##     if (method == &quot;convolution&quot;) {
##         if (nfilt &gt; n) 
##             stop(&quot;&#39;filter&#39; is longer than time series&quot;)
##         sides &lt;- as.integer(sides)
##         if (is.na(sides) || (sides != 1L &amp;&amp; sides != 2L)) 
##             stop(&quot;argument &#39;sides&#39; must be 1 or 2&quot;)
##         circular &lt;- as.logical(circular)
##         if (is.na(circular)) 
##             stop(&quot;&#39;circular&#39; must be logical and not NA&quot;)
##         if (is.matrix(x)) {
##             y &lt;- matrix(NA, n, nser)
##             for (i in seq_len(nser)) y[, i] &lt;- .Call(C_cfilter, 
##                 x[, i], filter, sides, circular)
##         }
##         else y &lt;- .Call(C_cfilter, x, filter, sides, circular)
##     }
##     else {
##         if (missing(init)) {
##             init &lt;- matrix(0, nfilt, nser)
##         }
##         else {
##             ni &lt;- NROW(init)
##             if (ni != nfilt) 
##                 stop(&quot;length of &#39;init&#39; must equal length of &#39;filter&#39;&quot;)
##             if (NCOL(init) != 1L &amp;&amp; NCOL(init) != nser) {
##                 stop(sprintf(ngettext(nser, &quot;&#39;init&#39; must have %d column&quot;, 
##                   &quot;&#39;init&#39; must have 1 or %d columns&quot;, domain = &quot;R-stats&quot;), 
##                   nser), domain = NA)
##             }
##             if (!is.matrix(init)) 
##                 dim(init) &lt;- c(nfilt, nser)
##         }
##         ind &lt;- seq_len(nfilt)
##         if (is.matrix(x)) {
##             y &lt;- matrix(NA, n, nser)
##             for (i in seq_len(nser)) y[, i] &lt;- .Call(C_rfilter, 
##                 x[, i], filter, c(rev(init[, i]), double(n)))[-ind]
##         }
##         else y &lt;- .Call(C_rfilter, x, filter, c(rev(init[, 1L]), 
##             double(n)))[-ind]
##     }
##     tsp(y) &lt;- xtsp
##     class(y) &lt;- if (nser &gt; 1L) 
##         c(&quot;mts&quot;, &quot;ts&quot;)
##     else &quot;ts&quot;
##     y
## }
## &lt;bytecode: 0x7fb16cf419f8&gt;
## &lt;environment: namespace:stats&gt;</code></pre>
<div class="sourceCode" id="cb561"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb561-1"><a href="language-fundamentals.html#cb561-1" tabindex="-1"></a>dplyr<span class="sc">::</span>filter</span></code></pre></div>
<pre><code>## function (.data, ..., .by = NULL, .preserve = FALSE) 
## {
##     check_by_typo(...)
##     by &lt;- enquo(.by)
##     if (!quo_is_null(by) &amp;&amp; !is_false(.preserve)) {
##         abort(&quot;Can&#39;t supply both `.by` and `.preserve`.&quot;)
##     }
##     UseMethod(&quot;filter&quot;)
## }
## &lt;bytecode: 0x7fb171d69c00&gt;
## &lt;environment: namespace:dplyr&gt;</code></pre>
<div class="sourceCode" id="cb563"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb563-1"><a href="language-fundamentals.html#cb563-1" tabindex="-1"></a>ggplot2<span class="sc">::</span>ggplot</span></code></pre></div>
<pre><code>## function (data = NULL, mapping = aes(), ..., environment = parent.frame()) 
## {
##     UseMethod(&quot;ggplot&quot;)
## }
## &lt;bytecode: 0x7fb16e838078&gt;
## &lt;environment: namespace:ggplot2&gt;</code></pre>
<p>The related triple-colon operator <code>:::</code> gets a <strong>private</strong> variable in a
package. Generally these are private for a reason! Only use <code>:::</code> if you’re
sure you know what you’re doing.</p>
</div>
</div>
</div>
<div id="closures" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> Closures<a href="language-fundamentals.html#closures" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A <strong>closure</strong> is a function together with an enclosing environment. In order to
support lexical scoping, every R function is a closure (except a few very
special built-in functions). The enclosing environment is generally the
environment where the function was defined.</p>
<p>Recall that you can use the <code>environment</code> function to get the enclosing
environment of a function:</p>
<div class="sourceCode" id="cb565"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb565-1"><a href="language-fundamentals.html#cb565-1" tabindex="-1"></a>f <span class="ot">=</span> <span class="cf">function</span>() <span class="dv">42</span></span>
<span id="cb565-2"><a href="language-fundamentals.html#cb565-2" tabindex="-1"></a><span class="fu">environment</span>(f)</span></code></pre></div>
<pre><code>## &lt;environment: R_GlobalEnv&gt;</code></pre>
<p>Since the enclosing environment exists whether or not you call the function,
you can use the enclosing environment to store and share data between calls.</p>
<p>You can use the superassignment operator <code>&lt;&lt;-</code> to assign to a variable to an
ancestor environment (if the variable already exists) or the global environment
(if the variable does not already exist).</p>
<p>For example, suppose you want to make a function that returns the number of
times it’s been called:</p>
<div class="sourceCode" id="cb567"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb567-1"><a href="language-fundamentals.html#cb567-1" tabindex="-1"></a>counter <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb567-2"><a href="language-fundamentals.html#cb567-2" tabindex="-1"></a>count <span class="ot">=</span> <span class="cf">function</span>() {</span>
<span id="cb567-3"><a href="language-fundamentals.html#cb567-3" tabindex="-1"></a>  counter <span class="ot">&lt;&lt;-</span> counter <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb567-4"><a href="language-fundamentals.html#cb567-4" tabindex="-1"></a>  counter</span>
<span id="cb567-5"><a href="language-fundamentals.html#cb567-5" tabindex="-1"></a>}</span></code></pre></div>
<p>In this example, the enclosing environment is the global environment. Each time
you call <code>count</code>, it assigns a new value to the <code>counter</code> variable <em>in the
global environment</em>.</p>
<div id="tidy-closures" class="section level3 hasAnchor" number="6.2.1">
<h3><span class="header-section-number">6.2.1</span> Tidy Closures<a href="language-fundamentals.html#tidy-closures" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>count</code> function has a side effect—it reassigns a non-local variable. As
discussed in <a href="language-fundamentals.html#call-environments">6.1.4</a>, functions with side effects make code
harder to understand and reason about. Use side effects sparingly and try to
isolate them from the global environment.</p>
<p>When side effects aren’t isolated, several things can go wrong. The function
might overwrite the user’s variables:</p>
<div class="sourceCode" id="cb568"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb568-1"><a href="language-fundamentals.html#cb568-1" tabindex="-1"></a>counter <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb568-2"><a href="language-fundamentals.html#cb568-2" tabindex="-1"></a><span class="fu">count</span>()</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<p>Or the user might overwrite the function’s variables:</p>
<div class="sourceCode" id="cb570"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb570-1"><a href="language-fundamentals.html#cb570-1" tabindex="-1"></a>counter <span class="ot">=</span> <span class="st">&quot;hi&quot;</span></span>
<span id="cb570-2"><a href="language-fundamentals.html#cb570-2" tabindex="-1"></a><span class="fu">count</span>()</span></code></pre></div>
<pre><code>## Error in counter + 1: non-numeric argument to binary operator</code></pre>
<p>For functions that rely on storing information in their enclosing environment,
there are several different ways to make sure the enclosing environment is
isolated. Two of these are:</p>
<ol style="list-style-type: decimal">
<li><p>Define and return the function from the body of another function. The second
function is called a <strong>factory function</strong> because it produces (returns) the
first. The enclosing environment of the first function is the call
environment of the second.</p></li>
<li><p>Define the function inside of a call to <code>local</code>.</p></li>
</ol>
<p>Here’s a template for the first approach:</p>
<div class="sourceCode" id="cb572"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb572-1"><a href="language-fundamentals.html#cb572-1" tabindex="-1"></a>make_fn <span class="ot">=</span> <span class="cf">function</span>() {</span>
<span id="cb572-2"><a href="language-fundamentals.html#cb572-2" tabindex="-1"></a>  <span class="co"># Define variables in the enclosing environment here:</span></span>
<span id="cb572-3"><a href="language-fundamentals.html#cb572-3" tabindex="-1"></a></span>
<span id="cb572-4"><a href="language-fundamentals.html#cb572-4" tabindex="-1"></a>  <span class="co"># Define and return the function here:</span></span>
<span id="cb572-5"><a href="language-fundamentals.html#cb572-5" tabindex="-1"></a>  <span class="cf">function</span>() {</span>
<span id="cb572-6"><a href="language-fundamentals.html#cb572-6" tabindex="-1"></a>    <span class="co"># ...</span></span>
<span id="cb572-7"><a href="language-fundamentals.html#cb572-7" tabindex="-1"></a>  }</span>
<span id="cb572-8"><a href="language-fundamentals.html#cb572-8" tabindex="-1"></a>}</span>
<span id="cb572-9"><a href="language-fundamentals.html#cb572-9" tabindex="-1"></a></span>
<span id="cb572-10"><a href="language-fundamentals.html#cb572-10" tabindex="-1"></a>f <span class="ot">=</span> <span class="fu">make_fn</span>()</span>
<span id="cb572-11"><a href="language-fundamentals.html#cb572-11" tabindex="-1"></a><span class="co"># Now you can call f() as you would any other function.</span></span></code></pre></div>
<p>For example, you can use the template for the <code>counter</code> function:</p>
<div class="sourceCode" id="cb573"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb573-1"><a href="language-fundamentals.html#cb573-1" tabindex="-1"></a>make_count <span class="ot">=</span> <span class="cf">function</span>() {</span>
<span id="cb573-2"><a href="language-fundamentals.html#cb573-2" tabindex="-1"></a>  counter <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb573-3"><a href="language-fundamentals.html#cb573-3" tabindex="-1"></a>  </span>
<span id="cb573-4"><a href="language-fundamentals.html#cb573-4" tabindex="-1"></a>  <span class="cf">function</span>() {</span>
<span id="cb573-5"><a href="language-fundamentals.html#cb573-5" tabindex="-1"></a>    counter <span class="ot">&lt;&lt;-</span> counter <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb573-6"><a href="language-fundamentals.html#cb573-6" tabindex="-1"></a>    counter</span>
<span id="cb573-7"><a href="language-fundamentals.html#cb573-7" tabindex="-1"></a>  }</span>
<span id="cb573-8"><a href="language-fundamentals.html#cb573-8" tabindex="-1"></a>}</span>
<span id="cb573-9"><a href="language-fundamentals.html#cb573-9" tabindex="-1"></a></span>
<span id="cb573-10"><a href="language-fundamentals.html#cb573-10" tabindex="-1"></a>count <span class="ot">=</span> <span class="fu">make_count</span>()</span></code></pre></div>
<p>Then calling <code>count</code> has no effect on the global environment:</p>
<div class="sourceCode" id="cb574"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb574-1"><a href="language-fundamentals.html#cb574-1" tabindex="-1"></a>counter <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb574-2"><a href="language-fundamentals.html#cb574-2" tabindex="-1"></a><span class="fu">count</span>()</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb576"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb576-1"><a href="language-fundamentals.html#cb576-1" tabindex="-1"></a>counter</span></code></pre></div>
<pre><code>## [1] 10</code></pre>
</div>
</div>
<div id="attributes" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> Attributes<a href="language-fundamentals.html#attributes" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>An <strong>attribute</strong> is named metadata attached to an R object. Attributes provide
basic information about objects and play an important role in R’s class system,
so most objects have attributes. Some common attributes are:</p>
<ul>
<li><code>class</code> – the <a href="https://ucdavisdatalab.github.io/workshop_r_basics/data-structures.html#data-types-classes">class</a></li>
<li><code>row.names</code> – row names</li>
<li><code>names</code> – element names or column names</li>
<li><code>dim</code> – dimensions (on matrices)</li>
<li><code>dimnames</code> – names of dimensions (on matrices)</li>
</ul>
<p>R provides helper functions to get and set the values of the common attributes.
These functions usually have the same name as the attribute. For example, the
<code>class</code> function gets or sets the <code>class</code> attribute:</p>
<div class="sourceCode" id="cb578"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb578-1"><a href="language-fundamentals.html#cb578-1" tabindex="-1"></a><span class="fu">class</span>(mtcars)</span></code></pre></div>
<pre><code>## [1] &quot;data.frame&quot;</code></pre>
<div class="sourceCode" id="cb580"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb580-1"><a href="language-fundamentals.html#cb580-1" tabindex="-1"></a><span class="fu">row.names</span>(mtcars)</span></code></pre></div>
<pre><code>##  [1] &quot;Mazda RX4&quot;           &quot;Mazda RX4 Wag&quot;       &quot;Datsun 710&quot;         
##  [4] &quot;Hornet 4 Drive&quot;      &quot;Hornet Sportabout&quot;   &quot;Valiant&quot;            
##  [7] &quot;Duster 360&quot;          &quot;Merc 240D&quot;           &quot;Merc 230&quot;           
## [10] &quot;Merc 280&quot;            &quot;Merc 280C&quot;           &quot;Merc 450SE&quot;         
## [13] &quot;Merc 450SL&quot;          &quot;Merc 450SLC&quot;         &quot;Cadillac Fleetwood&quot; 
## [16] &quot;Lincoln Continental&quot; &quot;Chrysler Imperial&quot;   &quot;Fiat 128&quot;           
## [19] &quot;Honda Civic&quot;         &quot;Toyota Corolla&quot;      &quot;Toyota Corona&quot;      
## [22] &quot;Dodge Challenger&quot;    &quot;AMC Javelin&quot;         &quot;Camaro Z28&quot;         
## [25] &quot;Pontiac Firebird&quot;    &quot;Fiat X1-9&quot;           &quot;Porsche 914-2&quot;      
## [28] &quot;Lotus Europa&quot;        &quot;Ford Pantera L&quot;      &quot;Ferrari Dino&quot;       
## [31] &quot;Maserati Bora&quot;       &quot;Volvo 142E&quot;</code></pre>
<p>An attribute can have any name and any value. You can use the <code>attr</code> function
to get or set an attribute by name:</p>
<div class="sourceCode" id="cb582"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb582-1"><a href="language-fundamentals.html#cb582-1" tabindex="-1"></a><span class="fu">attr</span>(mtcars, <span class="st">&quot;row.names&quot;</span>)</span></code></pre></div>
<pre><code>##  [1] &quot;Mazda RX4&quot;           &quot;Mazda RX4 Wag&quot;       &quot;Datsun 710&quot;         
##  [4] &quot;Hornet 4 Drive&quot;      &quot;Hornet Sportabout&quot;   &quot;Valiant&quot;            
##  [7] &quot;Duster 360&quot;          &quot;Merc 240D&quot;           &quot;Merc 230&quot;           
## [10] &quot;Merc 280&quot;            &quot;Merc 280C&quot;           &quot;Merc 450SE&quot;         
## [13] &quot;Merc 450SL&quot;          &quot;Merc 450SLC&quot;         &quot;Cadillac Fleetwood&quot; 
## [16] &quot;Lincoln Continental&quot; &quot;Chrysler Imperial&quot;   &quot;Fiat 128&quot;           
## [19] &quot;Honda Civic&quot;         &quot;Toyota Corolla&quot;      &quot;Toyota Corona&quot;      
## [22] &quot;Dodge Challenger&quot;    &quot;AMC Javelin&quot;         &quot;Camaro Z28&quot;         
## [25] &quot;Pontiac Firebird&quot;    &quot;Fiat X1-9&quot;           &quot;Porsche 914-2&quot;      
## [28] &quot;Lotus Europa&quot;        &quot;Ford Pantera L&quot;      &quot;Ferrari Dino&quot;       
## [31] &quot;Maserati Bora&quot;       &quot;Volvo 142E&quot;</code></pre>
<div class="sourceCode" id="cb584"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb584-1"><a href="language-fundamentals.html#cb584-1" tabindex="-1"></a><span class="fu">attr</span>(mtcars, <span class="st">&quot;foo&quot;</span>) <span class="ot">=</span> <span class="dv">42</span></span>
<span id="cb584-2"><a href="language-fundamentals.html#cb584-2" tabindex="-1"></a><span class="fu">attr</span>(mtcars, <span class="st">&quot;foo&quot;</span>)</span></code></pre></div>
<pre><code>## [1] 42</code></pre>
<p>You can get all of the attributes attached to an object with the <code>attributes</code>
function:</p>
<div class="sourceCode" id="cb586"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb586-1"><a href="language-fundamentals.html#cb586-1" tabindex="-1"></a><span class="fu">attributes</span>(mtcars)</span></code></pre></div>
<pre><code>## $names
##  [1] &quot;mpg&quot;  &quot;cyl&quot;  &quot;disp&quot; &quot;hp&quot;   &quot;drat&quot; &quot;wt&quot;   &quot;qsec&quot; &quot;vs&quot;   &quot;am&quot;   &quot;gear&quot;
## [11] &quot;carb&quot;
## 
## $row.names
##  [1] &quot;Mazda RX4&quot;           &quot;Mazda RX4 Wag&quot;       &quot;Datsun 710&quot;         
##  [4] &quot;Hornet 4 Drive&quot;      &quot;Hornet Sportabout&quot;   &quot;Valiant&quot;            
##  [7] &quot;Duster 360&quot;          &quot;Merc 240D&quot;           &quot;Merc 230&quot;           
## [10] &quot;Merc 280&quot;            &quot;Merc 280C&quot;           &quot;Merc 450SE&quot;         
## [13] &quot;Merc 450SL&quot;          &quot;Merc 450SLC&quot;         &quot;Cadillac Fleetwood&quot; 
## [16] &quot;Lincoln Continental&quot; &quot;Chrysler Imperial&quot;   &quot;Fiat 128&quot;           
## [19] &quot;Honda Civic&quot;         &quot;Toyota Corolla&quot;      &quot;Toyota Corona&quot;      
## [22] &quot;Dodge Challenger&quot;    &quot;AMC Javelin&quot;         &quot;Camaro Z28&quot;         
## [25] &quot;Pontiac Firebird&quot;    &quot;Fiat X1-9&quot;           &quot;Porsche 914-2&quot;      
## [28] &quot;Lotus Europa&quot;        &quot;Ford Pantera L&quot;      &quot;Ferrari Dino&quot;       
## [31] &quot;Maserati Bora&quot;       &quot;Volvo 142E&quot;         
## 
## $class
## [1] &quot;data.frame&quot;
## 
## $foo
## [1] 42</code></pre>
<p>You can use the <code>structure</code> function to set multiple attributes on an object:</p>
<div class="sourceCode" id="cb588"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb588-1"><a href="language-fundamentals.html#cb588-1" tabindex="-1"></a>mod_mtcars <span class="ot">=</span> <span class="fu">structure</span>(mtcars, <span class="at">foo =</span> <span class="dv">50</span>, <span class="at">bar =</span> <span class="dv">100</span>)</span>
<span id="cb588-2"><a href="language-fundamentals.html#cb588-2" tabindex="-1"></a><span class="fu">attributes</span>(mod_mtcars)</span></code></pre></div>
<pre><code>## $names
##  [1] &quot;mpg&quot;  &quot;cyl&quot;  &quot;disp&quot; &quot;hp&quot;   &quot;drat&quot; &quot;wt&quot;   &quot;qsec&quot; &quot;vs&quot;   &quot;am&quot;   &quot;gear&quot;
## [11] &quot;carb&quot;
## 
## $row.names
##  [1] &quot;Mazda RX4&quot;           &quot;Mazda RX4 Wag&quot;       &quot;Datsun 710&quot;         
##  [4] &quot;Hornet 4 Drive&quot;      &quot;Hornet Sportabout&quot;   &quot;Valiant&quot;            
##  [7] &quot;Duster 360&quot;          &quot;Merc 240D&quot;           &quot;Merc 230&quot;           
## [10] &quot;Merc 280&quot;            &quot;Merc 280C&quot;           &quot;Merc 450SE&quot;         
## [13] &quot;Merc 450SL&quot;          &quot;Merc 450SLC&quot;         &quot;Cadillac Fleetwood&quot; 
## [16] &quot;Lincoln Continental&quot; &quot;Chrysler Imperial&quot;   &quot;Fiat 128&quot;           
## [19] &quot;Honda Civic&quot;         &quot;Toyota Corolla&quot;      &quot;Toyota Corona&quot;      
## [22] &quot;Dodge Challenger&quot;    &quot;AMC Javelin&quot;         &quot;Camaro Z28&quot;         
## [25] &quot;Pontiac Firebird&quot;    &quot;Fiat X1-9&quot;           &quot;Porsche 914-2&quot;      
## [28] &quot;Lotus Europa&quot;        &quot;Ford Pantera L&quot;      &quot;Ferrari Dino&quot;       
## [31] &quot;Maserati Bora&quot;       &quot;Volvo 142E&quot;         
## 
## $class
## [1] &quot;data.frame&quot;
## 
## $foo
## [1] 50
## 
## $bar
## [1] 100</code></pre>
<p>Vectors usually don’t have attributes:</p>
<div class="sourceCode" id="cb590"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb590-1"><a href="language-fundamentals.html#cb590-1" tabindex="-1"></a><span class="fu">attributes</span>(<span class="dv">5</span>)</span></code></pre></div>
<pre><code>## NULL</code></pre>
<p>But the <code>class</code> function still returns a class:</p>
<div class="sourceCode" id="cb592"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb592-1"><a href="language-fundamentals.html#cb592-1" tabindex="-1"></a><span class="fu">class</span>(<span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [1] &quot;numeric&quot;</code></pre>
<p>When a helper function exists to get or set an attribute, use the helper
function rather than <code>attr</code>. This will make your code clearer and ensure that
attributes with special behavior and requirements, such as <code>dim</code>, are set
correctly.</p>
</div>
<div id="s3" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> S3<a href="language-fundamentals.html#s3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>R provides several systems for <a href="https://en.wikipedia.org/wiki/Object-oriented_programming"><strong>object-oriented programming</strong> (OOP)</a>, a
programming paradigm where code is organized into a collection of “objects”
that interact with each other. These systems provide a way to create new data
structures with customized behavior, and also underpin how some of R’s built-in
functions work.</p>
<p>The <strong>S3</strong> system is particularly important for understanding R, because it’s
the oldest and most widely-used. This section focuses on S3, while Section
<a href="language-fundamentals.html#other-object-systems">6.5</a> provides an overview of R’s other OOP systems.</p>
<p>The central idea of S3 is that some functions can be <strong>generic</strong>, meaning they
perform different computations (and run different code) for different
<strong>classes</strong> of objects.</p>
<p>Conversely, every object has at least one class, which dictates how the object
behaves. For most objects, the class is independent of <a href="https://ucdavisdatalab.github.io/workshop_r_basics/data-structures.html#data-types-classes">type</a> and is stored
in the <code>class</code> attribute. You can get the class of an object with the <code>class</code>
function. For example, the class of a data frame is <code>data.frame</code>:</p>
<div class="sourceCode" id="cb594"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb594-1"><a href="language-fundamentals.html#cb594-1" tabindex="-1"></a><span class="fu">class</span>(mtcars)</span></code></pre></div>
<pre><code>## [1] &quot;data.frame&quot;</code></pre>
<p>Some objects have more than one class. One example of this is matrices:</p>
<div class="sourceCode" id="cb596"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb596-1"><a href="language-fundamentals.html#cb596-1" tabindex="-1"></a>m <span class="ot">=</span> <span class="fu">matrix</span>()</span>
<span id="cb596-2"><a href="language-fundamentals.html#cb596-2" tabindex="-1"></a><span class="fu">class</span>(m)</span></code></pre></div>
<pre><code>## [1] &quot;matrix&quot; &quot;array&quot;</code></pre>
<p>When an object has multiple classes, they’re stored in the <code>class</code> attribute in
order from highest to lowest priority. So the matrix <code>m</code> will primarily behave
like a <code>matrix</code>, but it can also behave like an <code>array</code>. The priority of
classes is often described in terms of a child-parent relationship: <code>array</code> is
the <strong>parent class</strong> of <code>matrix</code>, or equivalently, the class <code>matrix</code>
<strong>inherits</strong> from the class <code>array</code>.</p>
<div id="method-dispatch" class="section level3 hasAnchor" number="6.4.1">
<h3><span class="header-section-number">6.4.1</span> Method Dispatch<a href="language-fundamentals.html#method-dispatch" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A function is generic if it selects and calls another function, called a
<strong>method</strong>, based on the class of one of its arguments. A generic function can
have any number of methods, and each must have the same <strong>signature</strong>, or
collection of parameters, as the generic. Think of a generic function’s methods
as the range of different computations it can perform, or alternatively as the
range of different classes it can accept as input.</p>
<p><strong>Method dispatch</strong>, or just dispatch, is the process of selecting a method
based on the class of an argument. You can identify S3 generics because they
always call the <code>UseMethod</code> function, which initiates S3 method dispatch.</p>
<p>Many of R’s built-in functions are generic. One example is the <code>split</code>
function, which splits a data frame or vector into groups:</p>
<div class="sourceCode" id="cb598"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb598-1"><a href="language-fundamentals.html#cb598-1" tabindex="-1"></a>split</span></code></pre></div>
<pre><code>## function (x, f, drop = FALSE, ...) 
## UseMethod(&quot;split&quot;)
## &lt;bytecode: 0x7fb16aff2b78&gt;
## &lt;environment: namespace:base&gt;</code></pre>
<p>Another is the <code>plot</code> function, which creates a plot:</p>
<div class="sourceCode" id="cb600"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb600-1"><a href="language-fundamentals.html#cb600-1" tabindex="-1"></a>plot</span></code></pre></div>
<pre><code>## function (x, y, ...) 
## UseMethod(&quot;plot&quot;)
## &lt;bytecode: 0x7fb16d4b4028&gt;
## &lt;environment: namespace:base&gt;</code></pre>
<p>The <code>UseMethod</code> function requires the name of the generic (as a string) as its
first argument. The second argument is optional and specifies the object to use
for method dispatch. By default, the first argument to the generic is used for
method dispatch. So for <code>split</code>, the argument for <code>x</code> is used for method
dispatch. R checks the class of the argument and selects a matching method.</p>
<p>You can use the <code>methods</code> function to list all of the methods of a generic. The
methods for <code>split</code> are:</p>
<div class="sourceCode" id="cb602"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb602-1"><a href="language-fundamentals.html#cb602-1" tabindex="-1"></a><span class="fu">methods</span>(split)</span></code></pre></div>
<pre><code>## [1] split.data.frame split.Date       split.default    split.POSIXct   
## see &#39;?methods&#39; for accessing help and source code</code></pre>
<p>Method names always have the form <code>GENERIC.CLASS</code>, where <code>GENERIC</code> is the name
of the generic and <code>CLASS</code> is the name of a class. For instance,
<code>split.data.frame</code> is the <code>split</code> method for objects with class <code>data.frame</code>.</p>
<p>Methods named <code>GENERIC.default</code> are a special case: they are <strong>default
methods</strong>, selected only if none of the other methods match the class during
dispatch. So <code>split.default</code> is the default method for <code>split</code>. Most generic
functions have a default method.</p>
<p>Methods are ordinary R functions. For instance, the code for <code>split.data.frame</code>
is:</p>
<div class="sourceCode" id="cb604"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb604-1"><a href="language-fundamentals.html#cb604-1" tabindex="-1"></a>split.data.frame</span></code></pre></div>
<pre><code>## function (x, f, drop = FALSE, ...) 
## {
##     if (inherits(f, &quot;formula&quot;)) 
##         f &lt;- .formula2varlist(f, x)
##     lapply(split(x = seq_len(nrow(x)), f = f, drop = drop, ...), 
##         function(ind) x[ind, , drop = FALSE])
## }
## &lt;bytecode: 0x7fb16c89ea20&gt;
## &lt;environment: namespace:base&gt;</code></pre>
<p>Sometimes methods are defined in privately packages and can’t be accessed by
typing their name at the prompt. You can use the <code>getAnywhere</code> function to get
the code for these methods. For instance, to get the code for
<code>plot.data.frame</code>:</p>
<div class="sourceCode" id="cb606"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb606-1"><a href="language-fundamentals.html#cb606-1" tabindex="-1"></a><span class="fu">getAnywhere</span>(plot.data.frame)</span></code></pre></div>
<pre><code>## A single object matching &#39;plot.data.frame&#39; was found
## It was found in the following places
##   registered S3 method for plot from namespace graphics
##   namespace:graphics
## with value
## 
## function (x, ...) 
## {
##     plot2 &lt;- function(x, xlab = names(x)[1L], ylab = names(x)[2L], 
##         ...) plot(x[[1L]], x[[2L]], xlab = xlab, ylab = ylab, 
##         ...)
##     if (!is.data.frame(x)) 
##         stop(&quot;&#39;plot.data.frame&#39; applied to non data frame&quot;)
##     if (ncol(x) == 1) {
##         x1 &lt;- x[[1L]]
##         if (class(x1)[1L] %in% c(&quot;integer&quot;, &quot;numeric&quot;)) 
##             stripchart(x1, ...)
##         else plot(x1, ...)
##     }
##     else if (ncol(x) == 2) {
##         plot2(x, ...)
##     }
##     else {
##         pairs(data.matrix(x), ...)
##     }
## }
## &lt;bytecode: 0x7fb170950618&gt;
## &lt;environment: namespace:graphics&gt;</code></pre>
<p>As a demonstration of method dispatch, consider this code to split the <code>mtcars</code>
dataset by number of cylinders:</p>
<div class="sourceCode" id="cb608"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb608-1"><a href="language-fundamentals.html#cb608-1" tabindex="-1"></a><span class="fu">split</span>(mtcars, mtcars<span class="sc">$</span>cyl)</span></code></pre></div>
<p>The <code>split</code> function is generic and dispatches on its first argument. In this
case, the first argument is <code>mtcars</code>, which has class <code>data.frame</code>. Since the
method <code>split.data.frame</code> exists, R calls <code>split.data.frame</code> with the same
arguments you used to call the generic <code>split</code> function. In other words, R
calls:</p>
<div class="sourceCode" id="cb609"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb609-1"><a href="language-fundamentals.html#cb609-1" tabindex="-1"></a><span class="fu">split.data.frame</span>(mtcars, mtcars<span class="sc">$</span>cyl)</span></code></pre></div>
<p>When an object has more than one class, method dispatch considers them from
left to right. For instance, matrices created with the <code>matrix</code> function have
class <code>matrix</code> and also class <code>array</code>. If you pass a matrix to a generic
function, R will first look for a <code>matrix</code> method. If there isn’t one, R will
look for an <code>array</code> method. If there still isn’t one, R will look for a default
method. If there’s no default method either, then R raises an error.</p>
<p>The <a href="https://sloop.r-lib.org/">sloop</a> package provides useful functions inspecting S3 classes,
generics, and methods, as well as the method dispatch process. For example, you
can use the <code>s3_dispatch</code> function to see which method will be selected when
you call a generic:</p>
<div class="sourceCode" id="cb610"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb610-1"><a href="language-fundamentals.html#cb610-1" tabindex="-1"></a><span class="co"># install.packages(&quot;sloop&quot;)</span></span>
<span id="cb610-2"><a href="language-fundamentals.html#cb610-2" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;sloop&quot;</span>)</span>
<span id="cb610-3"><a href="language-fundamentals.html#cb610-3" tabindex="-1"></a><span class="fu">s3_dispatch</span>(<span class="fu">split</span>(mtcars, mtcars<span class="sc">$</span>cyl))</span></code></pre></div>
<pre><code>## =&gt; split.data.frame
##  * split.default</code></pre>
<p>The selected method is indicated with an arrow <code>=&gt;</code>, while methods that were
not selected are indicated with a star <code>*</code>. See <code>?s3_dispatch</code> for complete
details about the output from the function.</p>
</div>
<div id="creating-objects" class="section level3 hasAnchor" number="6.4.2">
<h3><span class="header-section-number">6.4.2</span> Creating Objects<a href="language-fundamentals.html#creating-objects" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>S3 classes are defined implicitly by their associated methods. To create a new
class, decide what its structure will be and define some methods. To create an
object of the class, set an object’s class attribute to the class name.</p>
<p>For example, let’s create a generic function <code>get_age</code> that returns the
age of an animal in terms of a typical human lifespan. First define the
generic:</p>
<div class="sourceCode" id="cb612"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb612-1"><a href="language-fundamentals.html#cb612-1" tabindex="-1"></a>get_age <span class="ot">=</span> <span class="cf">function</span>(animal) {</span>
<span id="cb612-2"><a href="language-fundamentals.html#cb612-2" tabindex="-1"></a>  <span class="fu">UseMethod</span>(<span class="st">&quot;get_age&quot;</span>)</span>
<span id="cb612-3"><a href="language-fundamentals.html#cb612-3" tabindex="-1"></a>}</span></code></pre></div>
<p>Next, let’s create a class <code>Human</code> to represent a human. Since humans are
animals, let’s make each <code>Human</code> also have class <code>Animal</code>. You can use any type
of object as the foundation for a class, but lists are often a good choice
because they can store multiple named elements. Here’s how to create a <code>Human</code>
object with a field <code>age_years</code> to store the age in years:</p>
<div class="sourceCode" id="cb613"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb613-1"><a href="language-fundamentals.html#cb613-1" tabindex="-1"></a>lyra <span class="ot">=</span> <span class="fu">list</span>(<span class="at">age_years =</span> <span class="dv">13</span>)</span>
<span id="cb613-2"><a href="language-fundamentals.html#cb613-2" tabindex="-1"></a><span class="fu">class</span>(lyra) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Human&quot;</span>, <span class="st">&quot;Animal&quot;</span>)</span></code></pre></div>
<p>Class names can include any characters that are valid in R variable names. One
common convention is to make them start with an uppercase letter, to
distinguish them from variables.</p>
<p>If you want to make constructing an object of a given class less ad-hoc (and
error-prone), define a <strong>constructor function</strong> that returns a new object of a
given class. A common convention is to give the constructor function the same
name as the class:</p>
<div class="sourceCode" id="cb614"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb614-1"><a href="language-fundamentals.html#cb614-1" tabindex="-1"></a>Human <span class="ot">=</span> <span class="cf">function</span>(age_years) {</span>
<span id="cb614-2"><a href="language-fundamentals.html#cb614-2" tabindex="-1"></a>  obj <span class="ot">=</span> <span class="fu">list</span>(<span class="at">age_years =</span> age_years)</span>
<span id="cb614-3"><a href="language-fundamentals.html#cb614-3" tabindex="-1"></a>  <span class="fu">class</span>(obj) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Human&quot;</span>, <span class="st">&quot;Animal&quot;</span>)</span>
<span id="cb614-4"><a href="language-fundamentals.html#cb614-4" tabindex="-1"></a>  obj</span>
<span id="cb614-5"><a href="language-fundamentals.html#cb614-5" tabindex="-1"></a>}</span>
<span id="cb614-6"><a href="language-fundamentals.html#cb614-6" tabindex="-1"></a></span>
<span id="cb614-7"><a href="language-fundamentals.html#cb614-7" tabindex="-1"></a>asriel <span class="ot">=</span> <span class="fu">Human</span>(<span class="dv">45</span>)</span></code></pre></div>
<p>The <code>get_age</code> generic doesn’t have any methods yet, so R raises an error if you
call it (regardless of the argument’s class):</p>
<div class="sourceCode" id="cb615"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb615-1"><a href="language-fundamentals.html#cb615-1" tabindex="-1"></a><span class="fu">get_age</span>(lyra)</span></code></pre></div>
<pre><code>## Error in UseMethod(&quot;get_age&quot;): no applicable method for &#39;get_age&#39; applied to an object of class &quot;c(&#39;Human&#39;, &#39;Animal&#39;)&quot;</code></pre>
<p>Let’s define a method for <code>Animal</code> objects. The method will just return the
value of the <code>age_years</code> field:</p>
<div class="sourceCode" id="cb617"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb617-1"><a href="language-fundamentals.html#cb617-1" tabindex="-1"></a>get_age.Animal <span class="ot">=</span> <span class="cf">function</span>(animal) {</span>
<span id="cb617-2"><a href="language-fundamentals.html#cb617-2" tabindex="-1"></a>  animal<span class="sc">$</span>age_years</span>
<span id="cb617-3"><a href="language-fundamentals.html#cb617-3" tabindex="-1"></a>}</span>
<span id="cb617-4"><a href="language-fundamentals.html#cb617-4" tabindex="-1"></a></span>
<span id="cb617-5"><a href="language-fundamentals.html#cb617-5" tabindex="-1"></a><span class="fu">get_age</span>(lyra)</span></code></pre></div>
<pre><code>## [1] 13</code></pre>
<div class="sourceCode" id="cb619"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb619-1"><a href="language-fundamentals.html#cb619-1" tabindex="-1"></a><span class="fu">get_age</span>(asriel)</span></code></pre></div>
<pre><code>## [1] 45</code></pre>
<p>Notice that the <code>get_age</code> generic still raises an error for objects that don’t
have class <code>Animal</code>:</p>
<div class="sourceCode" id="cb621"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb621-1"><a href="language-fundamentals.html#cb621-1" tabindex="-1"></a><span class="fu">get_age</span>(<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## Error in UseMethod(&quot;get_age&quot;): no applicable method for &#39;get_age&#39; applied to an object of class &quot;c(&#39;double&#39;, &#39;numeric&#39;)&quot;</code></pre>
<p>Now let’s create a class <code>Dog</code> to represent dogs. Like the <code>Human</code> class, a
<code>Dog</code> is a kind of <code>Animal</code> and has an <code>age_years</code> field. Each <code>Dog</code> will also
have a <code>breed</code> field to store the breed of the dog:</p>
<div class="sourceCode" id="cb623"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb623-1"><a href="language-fundamentals.html#cb623-1" tabindex="-1"></a>Dog <span class="ot">=</span> <span class="cf">function</span>(age_years, breed) {</span>
<span id="cb623-2"><a href="language-fundamentals.html#cb623-2" tabindex="-1"></a>  obj <span class="ot">=</span> <span class="fu">list</span>(<span class="at">age_years =</span> age_years, <span class="at">breed =</span> breed)</span>
<span id="cb623-3"><a href="language-fundamentals.html#cb623-3" tabindex="-1"></a>  <span class="fu">class</span>(obj) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Dog&quot;</span>, <span class="st">&quot;Animal&quot;</span>)</span>
<span id="cb623-4"><a href="language-fundamentals.html#cb623-4" tabindex="-1"></a>  obj</span>
<span id="cb623-5"><a href="language-fundamentals.html#cb623-5" tabindex="-1"></a>}</span>
<span id="cb623-6"><a href="language-fundamentals.html#cb623-6" tabindex="-1"></a></span>
<span id="cb623-7"><a href="language-fundamentals.html#cb623-7" tabindex="-1"></a>pongo <span class="ot">=</span> <span class="fu">Dog</span>(<span class="dv">10</span>, <span class="st">&quot;dalmatian&quot;</span>)</span></code></pre></div>
<p>Since a <code>Dog</code> is an <code>Animal</code>, the <code>get_age</code> generic returns a result:</p>
<div class="sourceCode" id="cb624"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb624-1"><a href="language-fundamentals.html#cb624-1" tabindex="-1"></a><span class="fu">get_age</span>(pongo)</span></code></pre></div>
<pre><code>## [1] 10</code></pre>
<p>Recall that the goal of this example was to make <code>get_age</code> return the age of an
animal in terms of a <em>human lifespan</em>. For a dog, their age in “human years” is
about 5 times their age in actual years. You can implement a <code>get_age</code> method
for <code>Dog</code> to take this into account:</p>
<div class="sourceCode" id="cb626"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb626-1"><a href="language-fundamentals.html#cb626-1" tabindex="-1"></a>get_age.Dog <span class="ot">=</span> <span class="cf">function</span>(animal) {</span>
<span id="cb626-2"><a href="language-fundamentals.html#cb626-2" tabindex="-1"></a>  animal<span class="sc">$</span>age_years <span class="sc">*</span> <span class="dv">5</span></span>
<span id="cb626-3"><a href="language-fundamentals.html#cb626-3" tabindex="-1"></a>}</span></code></pre></div>
<p>Now the <code>get_age</code> generic returns an age in terms of a human lifespan whether
its argument is a <code>Human</code> or a <code>Dog</code>:</p>
<div class="sourceCode" id="cb627"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb627-1"><a href="language-fundamentals.html#cb627-1" tabindex="-1"></a><span class="fu">get_age</span>(lyra)</span></code></pre></div>
<pre><code>## [1] 13</code></pre>
<div class="sourceCode" id="cb629"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb629-1"><a href="language-fundamentals.html#cb629-1" tabindex="-1"></a><span class="fu">get_age</span>(pongo)</span></code></pre></div>
<pre><code>## [1] 50</code></pre>
<p>You can create new data structures in R by creating classes, and you can add
functionality to new or existing generics by creating new methods. Before
creating a class, think about whether R already provides a data structure that
suits your needs.</p>
<p>It’s uncommon to create new classes in the course of a typical data analysis,
but many packages do provide new classes. Regardless of whether you ever create
a new class, understanding the details means understanding how S3 works, and
thus how R’s many S3 generic functions work.</p>
<p>As a final note, while exploring S3 methods you may also encounter the
<code>NextMethod</code> function. The <code>NextMethod</code> function redirects dispatch to the
method that is the next closest match for an object’s class. You can learn more
by reading <code>?NextMethod</code>.</p>
</div>
</div>
<div id="other-object-systems" class="section level2 hasAnchor" number="6.5">
<h2><span class="header-section-number">6.5</span> Other Object Systems<a href="language-fundamentals.html#other-object-systems" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>R provides many systems for object-oriented programming besides S3. Some are
built into the language, while others are provided by packages. A few of the
most popular systems are:</p>
<ul>
<li><p><strong>S4</strong> – S4 is built into R and is the most widely-used system after S3.
Like S3, S4 frames OOP in terms of generic functions and methods. The major
differences are that S4 is stricter—the structure of each class must be
formally defined—and that S4 generics can dispatch on the classes of
multiple arguments instead of just one. R provides a special field operator
<code>@</code> to access fields of an S4 object. Most of the packages in the
<a href="http://bioconductor.org/">Bioconductor</a> project use S4.</p></li>
<li><p><strong>Reference classes</strong> – Objects created with the S3 and S4 systems generally
follow the <a href="language-fundamentals.html#reference-objects">copy-on-write rule</a>, but this can be inefficient for some
programming tasks. The reference class system is built into R and provides a
way to create reference objects with a formal class structure (in the spirit
of S4). This system is more like OOP systems in languages like Java and
Python than S3 or S4 are. The reference class system is sometimes jokingly
called “R5”, but that isn’t an official name.</p></li>
<li><p><a href="https://r6.r-lib.org/"><strong>R6</strong></a> – An alternative to reference classes created by Winston Chang,
a developer at <a href="https://posit.co/">Posit</a> (formerly RStudio). Claims to be simpler and faster
than reference classes.</p></li>
<li><p><a href="https://rconsortium.github.io/OOP-WG/"><strong>S7</strong></a> – A new OOP system being developed collaboratively by
representatives from several different important groups in the R community,
including the R core developers, Bioconductor, and Posit.</p></li>
</ul>
<p>Many of these systems are described in more detail in Hadley Wickham’s book
<a href="https://adv-r.hadley.nz/">Advanced R</a>.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-visualization-in-r.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="part-2.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/ucdavisdatalab/workshop_intermediate_r/edit/master/06_language_fundamentals.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/ucdavisdatalab/workshop_intermediate_r/blob/master/06_language_fundamentals.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
