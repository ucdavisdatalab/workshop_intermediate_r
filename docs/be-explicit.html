<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>14 Be Explicit | Intermediate R</title>
  <meta name="description" content="14 Be Explicit | Intermediate R" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="14 Be Explicit | Intermediate R" />
  <meta property="og:type" content="book" />
  
  
  <meta name="github-repo" content="ucdavisdatalab/workshop_intermediate_r" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="14 Be Explicit | Intermediate R" />
  
  
  

<meta name="author" content="Nick Ulle and Wesley Brooks" />


<meta name="date" content="2024-01-10" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="examples.html"/>
<link rel="next" href="conclusion.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://datalab.ucdavis.edu/">
  <img src="https://datalab.ucdavis.edu/wp-content/uploads/2019/07/datalab-logo-full-color-rgb-1.png" style="height: 100%; width: 100%; object-fit: contain" />
</a></li>
<li><a href="./" style="font-size: 18px">Intermediate R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Overview</a></li>
<li class="part"><span><b>I Thinking in R</b></span></li>
<li class="chapter" data-level="1" data-path="language-fundamentals.html"><a href="language-fundamentals.html"><i class="fa fa-check"></i><b>1</b> Language Fundamentals</a>
<ul>
<li class="chapter" data-level="1.1" data-path="language-fundamentals.html"><a href="language-fundamentals.html#variables-environments"><i class="fa fa-check"></i><b>1.1</b> Variables &amp; Environments</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="language-fundamentals.html"><a href="language-fundamentals.html#whats-an-environment"><i class="fa fa-check"></i><b>1.1.1</b> What’s an Environment?</a></li>
<li class="chapter" data-level="1.1.2" data-path="language-fundamentals.html"><a href="language-fundamentals.html#reference-objects"><i class="fa fa-check"></i><b>1.1.2</b> Reference Objects</a></li>
<li class="chapter" data-level="1.1.3" data-path="language-fundamentals.html"><a href="language-fundamentals.html#the-local-environment"><i class="fa fa-check"></i><b>1.1.3</b> The Local Environment</a></li>
<li class="chapter" data-level="1.1.4" data-path="language-fundamentals.html"><a href="language-fundamentals.html#call-environments"><i class="fa fa-check"></i><b>1.1.4</b> Call Environments</a></li>
<li class="chapter" data-level="1.1.5" data-path="language-fundamentals.html"><a href="language-fundamentals.html#lexical-scoping"><i class="fa fa-check"></i><b>1.1.5</b> Lexical Scoping</a></li>
<li class="chapter" data-level="1.1.6" data-path="language-fundamentals.html"><a href="language-fundamentals.html#variable-lookup"><i class="fa fa-check"></i><b>1.1.6</b> Variable Lookup</a></li>
<li class="chapter" data-level="1.1.7" data-path="language-fundamentals.html"><a href="language-fundamentals.html#the-search-path"><i class="fa fa-check"></i><b>1.1.7</b> The Search Path</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="language-fundamentals.html"><a href="language-fundamentals.html#closures"><i class="fa fa-check"></i><b>1.2</b> Closures</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="language-fundamentals.html"><a href="language-fundamentals.html#tidy-closures"><i class="fa fa-check"></i><b>1.2.1</b> Tidy Closures</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="language-fundamentals.html"><a href="language-fundamentals.html#attributes"><i class="fa fa-check"></i><b>1.3</b> Attributes</a></li>
<li class="chapter" data-level="1.4" data-path="language-fundamentals.html"><a href="language-fundamentals.html#s3"><i class="fa fa-check"></i><b>1.4</b> S3</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="language-fundamentals.html"><a href="language-fundamentals.html#method-dispatch"><i class="fa fa-check"></i><b>1.4.1</b> Method Dispatch</a></li>
<li class="chapter" data-level="1.4.2" data-path="language-fundamentals.html"><a href="language-fundamentals.html#creating-objects"><i class="fa fa-check"></i><b>1.4.2</b> Creating Objects</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="language-fundamentals.html"><a href="language-fundamentals.html#other-object-systems"><i class="fa fa-check"></i><b>1.5</b> Other Object Systems</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="output-errors-and-bugs.html"><a href="output-errors-and-bugs.html"><i class="fa fa-check"></i><b>2</b> Output, Errors, and Bugs</a>
<ul>
<li class="chapter" data-level="2.1" data-path="output-errors-and-bugs.html"><a href="output-errors-and-bugs.html#printing-output"><i class="fa fa-check"></i><b>2.1</b> Printing Output</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="output-errors-and-bugs.html"><a href="output-errors-and-bugs.html#the-print-function"><i class="fa fa-check"></i><b>2.1.1</b> The <code>print</code> Function</a></li>
<li class="chapter" data-level="2.1.2" data-path="output-errors-and-bugs.html"><a href="output-errors-and-bugs.html#the-message-function"><i class="fa fa-check"></i><b>2.1.2</b> The <code>message</code> Function</a></li>
<li class="chapter" data-level="2.1.3" data-path="output-errors-and-bugs.html"><a href="output-errors-and-bugs.html#the-cat-function"><i class="fa fa-check"></i><b>2.1.3</b> The <code>cat</code> Function</a></li>
<li class="chapter" data-level="2.1.4" data-path="output-errors-and-bugs.html"><a href="output-errors-and-bugs.html#formatting-output"><i class="fa fa-check"></i><b>2.1.4</b> Formatting Output</a></li>
<li class="chapter" data-level="2.1.5" data-path="output-errors-and-bugs.html"><a href="output-errors-and-bugs.html#logging-output"><i class="fa fa-check"></i><b>2.1.5</b> Logging Output</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="output-errors-and-bugs.html"><a href="output-errors-and-bugs.html#the-conditions-system"><i class="fa fa-check"></i><b>2.2</b> The Conditions System</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="output-errors-and-bugs.html"><a href="output-errors-and-bugs.html#raising-conditions"><i class="fa fa-check"></i><b>2.2.1</b> Raising Conditions</a></li>
<li class="chapter" data-level="2.2.2" data-path="output-errors-and-bugs.html"><a href="output-errors-and-bugs.html#handling-conditions"><i class="fa fa-check"></i><b>2.2.2</b> Handling Conditions</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="output-errors-and-bugs.html"><a href="output-errors-and-bugs.html#global-options"><i class="fa fa-check"></i><b>2.3</b> Global Options</a></li>
<li class="chapter" data-level="2.4" data-path="output-errors-and-bugs.html"><a href="output-errors-and-bugs.html#debugging"><i class="fa fa-check"></i><b>2.4</b> Debugging</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="output-errors-and-bugs.html"><a href="output-errors-and-bugs.html#other-functions"><i class="fa fa-check"></i><b>2.4.1</b> Other Functions</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="output-errors-and-bugs.html"><a href="output-errors-and-bugs.html#measuring-performance"><i class="fa fa-check"></i><b>2.5</b> Measuring Performance</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="output-errors-and-bugs.html"><a href="output-errors-and-bugs.html#estimating-memory-usage"><i class="fa fa-check"></i><b>2.5.1</b> Estimating Memory Usage</a></li>
<li class="chapter" data-level="2.5.2" data-path="output-errors-and-bugs.html"><a href="output-errors-and-bugs.html#benchmarking"><i class="fa fa-check"></i><b>2.5.2</b> Benchmarking</a></li>
<li class="chapter" data-level="2.5.3" data-path="output-errors-and-bugs.html"><a href="output-errors-and-bugs.html#profiling"><i class="fa fa-check"></i><b>2.5.3</b> Profiling</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Cleaning Data &amp; Automating Tasks</b></span></li>
<li class="chapter" data-level="3" data-path="string-date-processing.html"><a href="string-date-processing.html"><i class="fa fa-check"></i><b>3</b> String &amp; Date Processing</a>
<ul>
<li class="chapter" data-level="3.1" data-path="string-date-processing.html"><a href="string-date-processing.html#the-tidyverse"><i class="fa fa-check"></i><b>3.1</b> The Tidyverse</a></li>
<li class="chapter" data-level="3.2" data-path="string-date-processing.html"><a href="string-date-processing.html#parsing-dates-times"><i class="fa fa-check"></i><b>3.2</b> Parsing Dates &amp; Times</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="string-date-processing.html"><a href="string-date-processing.html#the-lubridate-package"><i class="fa fa-check"></i><b>3.2.1</b> The lubridate Package</a></li>
<li class="chapter" data-level="3.2.2" data-path="string-date-processing.html"><a href="string-date-processing.html#case-study-ocean-temperatures"><i class="fa fa-check"></i><b>3.2.2</b> Case Study: Ocean Temperatures</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="string-date-processing.html"><a href="string-date-processing.html#string-fundamentals"><i class="fa fa-check"></i><b>3.3</b> String Fundamentals</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="string-date-processing.html"><a href="string-date-processing.html#printing"><i class="fa fa-check"></i><b>3.3.1</b> Printing</a></li>
<li class="chapter" data-level="3.3.2" data-path="string-date-processing.html"><a href="string-date-processing.html#escape-sequences-1"><i class="fa fa-check"></i><b>3.3.2</b> Escape Sequences</a></li>
<li class="chapter" data-level="3.3.3" data-path="string-date-processing.html"><a href="string-date-processing.html#raw-strings"><i class="fa fa-check"></i><b>3.3.3</b> Raw Strings</a></li>
<li class="chapter" data-level="3.3.4" data-path="string-date-processing.html"><a href="string-date-processing.html#character-encodings"><i class="fa fa-check"></i><b>3.3.4</b> Character Encodings</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="string-date-processing.html"><a href="string-date-processing.html#processing-strings"><i class="fa fa-check"></i><b>3.4</b> Processing Strings</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="string-date-processing.html"><a href="string-date-processing.html#the-stringr-package"><i class="fa fa-check"></i><b>3.4.1</b> The stringr Package</a></li>
<li class="chapter" data-level="3.4.2" data-path="string-date-processing.html"><a href="string-date-processing.html#regular-expressions"><i class="fa fa-check"></i><b>3.4.2</b> Regular Expressions</a></li>
<li class="chapter" data-level="3.4.3" data-path="string-date-processing.html"><a href="string-date-processing.html#replacing-parts-of-strings"><i class="fa fa-check"></i><b>3.4.3</b> Replacing Parts of Strings</a></li>
<li class="chapter" data-level="3.4.4" data-path="string-date-processing.html"><a href="string-date-processing.html#splitting-strings"><i class="fa fa-check"></i><b>3.4.4</b> Splitting Strings</a></li>
<li class="chapter" data-level="3.4.5" data-path="string-date-processing.html"><a href="string-date-processing.html#extracting-matches"><i class="fa fa-check"></i><b>3.4.5</b> Extracting Matches</a></li>
<li class="chapter" data-level="3.4.6" data-path="string-date-processing.html"><a href="string-date-processing.html#case-study-u.s.-warehouse-stocks"><i class="fa fa-check"></i><b>3.4.6</b> Case Study: U.S. Warehouse Stocks</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="string-date-processing.html"><a href="string-date-processing.html#regular-expression-examples"><i class="fa fa-check"></i><b>3.5</b> Regular Expression Examples</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="string-date-processing.html"><a href="string-date-processing.html#the-wildcard"><i class="fa fa-check"></i><b>3.5.1</b> The Wildcard</a></li>
<li class="chapter" data-level="3.5.2" data-path="string-date-processing.html"><a href="string-date-processing.html#escape-sequences-2"><i class="fa fa-check"></i><b>3.5.2</b> Escape Sequences</a></li>
<li class="chapter" data-level="3.5.3" data-path="string-date-processing.html"><a href="string-date-processing.html#anchors"><i class="fa fa-check"></i><b>3.5.3</b> Anchors</a></li>
<li class="chapter" data-level="3.5.4" data-path="string-date-processing.html"><a href="string-date-processing.html#character-classes"><i class="fa fa-check"></i><b>3.5.4</b> Character Classes</a></li>
<li class="chapter" data-level="3.5.5" data-path="string-date-processing.html"><a href="string-date-processing.html#quantifiers"><i class="fa fa-check"></i><b>3.5.5</b> Quantifiers</a></li>
<li class="chapter" data-level="3.5.6" data-path="string-date-processing.html"><a href="string-date-processing.html#groups"><i class="fa fa-check"></i><b>3.5.6</b> Groups</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="reshaping-data-automating-tasks.html"><a href="reshaping-data-automating-tasks.html"><i class="fa fa-check"></i><b>4</b> Reshaping Data &amp; Automating Tasks</a>
<ul>
<li class="chapter" data-level="4.1" data-path="reshaping-data-automating-tasks.html"><a href="reshaping-data-automating-tasks.html#tidy-datasets"><i class="fa fa-check"></i><b>4.1</b> Tidy Datasets</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="reshaping-data-automating-tasks.html"><a href="reshaping-data-automating-tasks.html#the-tidyr-package"><i class="fa fa-check"></i><b>4.1.1</b> The tidyr Package</a></li>
<li class="chapter" data-level="4.1.2" data-path="reshaping-data-automating-tasks.html"><a href="reshaping-data-automating-tasks.html#rows-into-columns"><i class="fa fa-check"></i><b>4.1.2</b> Rows into Columns</a></li>
<li class="chapter" data-level="4.1.3" data-path="reshaping-data-automating-tasks.html"><a href="reshaping-data-automating-tasks.html#columns-into-rows"><i class="fa fa-check"></i><b>4.1.3</b> Columns into Rows</a></li>
<li class="chapter" data-level="4.1.4" data-path="reshaping-data-automating-tasks.html"><a href="reshaping-data-automating-tasks.html#separating-values"><i class="fa fa-check"></i><b>4.1.4</b> Separating Values</a></li>
<li class="chapter" data-level="4.1.5" data-path="reshaping-data-automating-tasks.html"><a href="reshaping-data-automating-tasks.html#case-study-smart-ridership"><i class="fa fa-check"></i><b>4.1.5</b> Case Study: SMART Ridership</a></li>
<li class="chapter" data-level="4.1.6" data-path="reshaping-data-automating-tasks.html"><a href="reshaping-data-automating-tasks.html#without-tidyr"><i class="fa fa-check"></i><b>4.1.6</b> Without tidyr</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="reshaping-data-automating-tasks.html"><a href="reshaping-data-automating-tasks.html#iteration-strategies"><i class="fa fa-check"></i><b>4.2</b> Iteration Strategies</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="reshaping-data-automating-tasks.html"><a href="reshaping-data-automating-tasks.html#for-loops"><i class="fa fa-check"></i><b>4.2.1</b> For-loops</a></li>
<li class="chapter" data-level="4.2.2" data-path="reshaping-data-automating-tasks.html"><a href="reshaping-data-automating-tasks.html#while-loops"><i class="fa fa-check"></i><b>4.2.2</b> While-loops</a></li>
<li class="chapter" data-level="4.2.3" data-path="reshaping-data-automating-tasks.html"><a href="reshaping-data-automating-tasks.html#saving-multiple-results"><i class="fa fa-check"></i><b>4.2.3</b> Saving Multiple Results</a></li>
<li class="chapter" data-level="4.2.4" data-path="reshaping-data-automating-tasks.html"><a href="reshaping-data-automating-tasks.html#break-next"><i class="fa fa-check"></i><b>4.2.4</b> Break &amp; Next</a></li>
<li class="chapter" data-level="4.2.5" data-path="reshaping-data-automating-tasks.html"><a href="reshaping-data-automating-tasks.html#planning-for-iteration"><i class="fa fa-check"></i><b>4.2.5</b> Planning for Iteration</a></li>
<li class="chapter" data-level="4.2.6" data-path="reshaping-data-automating-tasks.html"><a href="reshaping-data-automating-tasks.html#case-study-the-collatz-conjecture"><i class="fa fa-check"></i><b>4.2.6</b> Case Study: The Collatz Conjecture</a></li>
<li class="chapter" data-level="4.2.7" data-path="reshaping-data-automating-tasks.html"><a href="reshaping-data-automating-tasks.html#case-study-u.s.-fruit-prices"><i class="fa fa-check"></i><b>4.2.7</b> Case Study: U.S. Fruit Prices</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Data Visualization and Analysis in R</b></span></li>
<li class="chapter" data-level="5" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html"><i class="fa fa-check"></i><b>5</b> Data Visualization in R</a>
<ul>
<li class="chapter" data-level="5.1" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#our-friend-ggplot2"><i class="fa fa-check"></i><b>5.1</b> Our Friend <code>ggplot2</code></a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#the-grammar-of-graphics"><i class="fa fa-check"></i><b>5.1.1</b> The Grammar of Graphics</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#example-palmer-penguins"><i class="fa fa-check"></i><b>5.2</b> Example: Palmer Penguins</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#examining-the-plot"><i class="fa fa-check"></i><b>5.2.1</b> Examining the Plot</a></li>
<li class="chapter" data-level="5.2.2" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#duplicating-the-palmer-penguins-plot"><i class="fa fa-check"></i><b>5.2.2</b> Duplicating the Palmer Penguins Plot</a></li>
<li class="chapter" data-level="5.2.3" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#analysis"><i class="fa fa-check"></i><b>5.2.3</b> Analysis</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#layers"><i class="fa fa-check"></i><b>5.3</b> Layers</a></li>
<li class="chapter" data-level="5.4" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#guidelines-for-graphics"><i class="fa fa-check"></i><b>5.4</b> Guidelines for Graphics</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#data"><i class="fa fa-check"></i><b>5.4.1</b> Data</a></li>
<li class="chapter" data-level="5.4.2" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#feature-types"><i class="fa fa-check"></i><b>5.4.2</b> Feature Types</a></li>
<li class="chapter" data-level="5.4.3" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#theme-guidelines"><i class="fa fa-check"></i><b>5.4.3</b> Theme Guidelines</a></li>
<li class="chapter" data-level="5.4.4" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#scale-guidelines"><i class="fa fa-check"></i><b>5.4.4</b> Scale Guidelines</a></li>
<li class="chapter" data-level="5.4.5" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#facet-guidelines"><i class="fa fa-check"></i><b>5.4.5</b> Facet Guidelines</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#case-studies"><i class="fa fa-check"></i><b>5.5</b> Case Studies</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#counting-penguins"><i class="fa fa-check"></i><b>5.5.1</b> Counting Penguins</a></li>
<li class="chapter" data-level="5.5.2" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#experimental-data-with-error-bars"><i class="fa fa-check"></i><b>5.5.2</b> Experimental Data with Error Bars</a></li>
<li class="chapter" data-level="5.5.3" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#bird-flu-mortality"><i class="fa fa-check"></i><b>5.5.3</b> Bird Flu Mortality</a></li>
<li class="chapter" data-level="5.5.4" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#small-business-loans"><i class="fa fa-check"></i><b>5.5.4</b> Small Business Loans</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV Backmatter</b></span></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="chapter" data-level="" data-path="assessment.html"><a href="assessment.html"><i class="fa fa-check"></i>Assessment</a></li>
<li class="chapter" data-level="6" data-path="joining-data.html"><a href="joining-data.html"><i class="fa fa-check"></i><b>6</b> Joining Data</a></li>
<li class="chapter" data-level="7" data-path="objective.html"><a href="objective.html"><i class="fa fa-check"></i><b>7</b> Objective:</a></li>
<li class="chapter" data-level="8" data-path="the-dplyr-package.html"><a href="the-dplyr-package.html"><i class="fa fa-check"></i><b>8</b> The <code>dplyr</code> Package</a></li>
<li class="chapter" data-level="9" data-path="gradebook-data.html"><a href="gradebook-data.html"><i class="fa fa-check"></i><b>9</b> Gradebook data</a></li>
<li class="chapter" data-level="10" data-path="left-and-right-joins.html"><a href="left-and-right-joins.html"><i class="fa fa-check"></i><b>10</b> Left and Right Joins</a>
<ul>
<li class="chapter" data-level="10.1" data-path="left-and-right-joins.html"><a href="left-and-right-joins.html#left-join"><i class="fa fa-check"></i><b>10.1</b> Left Join</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="other-joins.html"><a href="other-joins.html"><i class="fa fa-check"></i><b>11</b> Other Joins</a>
<ul>
<li class="chapter" data-level="11.1" data-path="other-joins.html"><a href="other-joins.html#right-join"><i class="fa fa-check"></i><b>11.1</b> Right Join</a></li>
<li class="chapter" data-level="11.2" data-path="other-joins.html"><a href="other-joins.html#inner-join"><i class="fa fa-check"></i><b>11.2</b> Inner Join</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="getting-clever-with-join_by.html"><a href="getting-clever-with-join_by.html"><i class="fa fa-check"></i><b>12</b> Getting Clever with <code>join_by</code></a>
<ul>
<li class="chapter" data-level="12.1" data-path="getting-clever-with-join_by.html"><a href="getting-clever-with-join_by.html#matching-multiple-columns"><i class="fa fa-check"></i><b>12.1</b> Matching multiple columns</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="examples.html"><a href="examples.html"><i class="fa fa-check"></i><b>13</b> Examples</a>
<ul>
<li class="chapter" data-level="13.1" data-path="examples.html"><a href="examples.html#three-or-more-tables"><i class="fa fa-check"></i><b>13.1</b> Three Or More Tables</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="be-explicit.html"><a href="be-explicit.html"><i class="fa fa-check"></i><b>14</b> Be Explicit</a>
<ul>
<li class="chapter" data-level="14.1" data-path="be-explicit.html"><a href="be-explicit.html#handling-duplicate-keys"><i class="fa fa-check"></i><b>14.1</b> Handling Duplicate Keys</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="be-explicit.html"><a href="be-explicit.html#specifying-the-expected-relationship"><i class="fa fa-check"></i><b>14.1.1</b> Specifying The Expected Relationship</a></li>
<li class="chapter" data-level="14.1.2" data-path="be-explicit.html"><a href="be-explicit.html#using-only-distinct-rows"><i class="fa fa-check"></i><b>14.1.2</b> Using Only Distinct Rows</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="be-explicit.html"><a href="be-explicit.html#ambiguous-columns"><i class="fa fa-check"></i><b>14.2</b> Ambiguous Columns</a></li>
<li class="chapter" data-level="14.3" data-path="be-explicit.html"><a href="be-explicit.html#missing-values"><i class="fa fa-check"></i><b>14.3</b> Missing Values</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="conclusion.html"><a href="conclusion.html"><i class="fa fa-check"></i><b>15</b> Conclusion</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Intermediate R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="be-explicit" class="section level1 hasAnchor" number="14">
<h1><span class="header-section-number">14</span> Be Explicit<a href="be-explicit.html#be-explicit" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Do you find it odd that we have to tell R exactly what kind of data join to do by calling one of <code>left_join()</code>, <code>right_join()</code>, <code>inner_join()</code>, or <code>full_join()</code>? Why isn’t there just one function called <code>join()</code> that assumes you’re doing a left join unless you specifically provide an argument <code>type</code> like <code>join(..., type="inner")</code>? If you think it would be confusing for R to make assumptions about what kind of data join we want, then you’re on the right track but you’ll want to watch out for these other cases where R has strong assumptions about what the default behavior should be.</p>
<p>A general principle of programming is that explicit is better than implicit because writing information into your code explicitly makes it easier to understand what the code does. Here are some examples of implicit assumptions R will make unless you provide explicit instructions.</p>
<div id="handling-duplicate-keys" class="section level2 hasAnchor" number="14.1">
<h2><span class="header-section-number">14.1</span> Handling Duplicate Keys<a href="be-explicit.html#handling-duplicate-keys" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Values in the key columns may not be unique. What do you think happens when you join using keys that aren’t unique?</p>
<div class="sourceCode" id="cb604"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb604-1"><a href="be-explicit.html#cb604-1" tabindex="-1"></a><span class="co"># Example datasets</span></span>
<span id="cb604-2"><a href="be-explicit.html#cb604-2" tabindex="-1"></a>students <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb604-3"><a href="be-explicit.html#cb604-3" tabindex="-1"></a>  <span class="at">student_id =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">4</span>),</span>
<span id="cb604-4"><a href="be-explicit.html#cb604-4" tabindex="-1"></a>  <span class="at">name =</span> <span class="fu">c</span>(<span class="st">&quot;Angel&quot;</span>, <span class="st">&quot;Beto&quot;</span>, <span class="st">&quot;Cici&quot;</span>, <span class="st">&quot;Desmond&quot;</span>, <span class="st">&quot;Erik&quot;</span>))</span>
<span id="cb604-5"><a href="be-explicit.html#cb604-5" tabindex="-1"></a></span>
<span id="cb604-6"><a href="be-explicit.html#cb604-6" tabindex="-1"></a>grades <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">student_id =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">5</span>),</span>
<span id="cb604-7"><a href="be-explicit.html#cb604-7" tabindex="-1"></a>                        <span class="at">grade =</span> <span class="fu">c</span>(<span class="dv">90</span>, <span class="dv">50</span>, <span class="dv">85</span>, <span class="dv">80</span>, <span class="dv">75</span>, <span class="dv">30</span>))</span>
<span id="cb604-8"><a href="be-explicit.html#cb604-8" tabindex="-1"></a></span>
<span id="cb604-9"><a href="be-explicit.html#cb604-9" tabindex="-1"></a><span class="co"># Left join</span></span>
<span id="cb604-10"><a href="be-explicit.html#cb604-10" tabindex="-1"></a>dupe_keys_result <span class="ot">=</span> <span class="fu">left_join</span>(students, grades, <span class="at">by =</span> <span class="st">&quot;student_id&quot;</span>)</span></code></pre></div>
<pre><code>## Warning in left_join(students, grades, by = &quot;student_id&quot;): Detected an unexpected many-to-many relationship between `x` and `y`.
## ℹ Row 2 of `x` matches multiple rows in `y`.
## ℹ Row 4 of `y` matches multiple rows in `x`.
## ℹ If a many-to-many relationship is expected, set `relationship = &quot;many-to-many&quot;` to silence this warning.</code></pre>
<div class="sourceCode" id="cb606"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb606-1"><a href="be-explicit.html#cb606-1" tabindex="-1"></a><span class="co"># View the results</span></span>
<span id="cb606-2"><a href="be-explicit.html#cb606-2" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;Duplicate Keys Result:&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Duplicate Keys Result:&quot;</code></pre>
<div class="sourceCode" id="cb608"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb608-1"><a href="be-explicit.html#cb608-1" tabindex="-1"></a><span class="fu">print</span>(dupe_keys_result)</span></code></pre></div>
<pre><code>##   student_id    name grade
## 1          1   Angel    NA
## 2          2    Beto    90
## 3          2    Beto    50
## 4          3    Cici    85
## 5          4 Desmond    80
## 6          4 Desmond    75
## 7          4    Erik    80
## 8          4    Erik    75</code></pre>
<p>We get one row in the result for every possible combination of the matching keys. Sometimes that is what you want, and other times not. In this case, it might be reasonable that Beto, Desmond, and Erik have multiple grades in the book, but it is probably not reasonable that both Desmond and Erik have student ID 4 and have the same grades as each other. This is a many-to-many match, with all the risks we’ve mentioned before.</p>
<div id="specifying-the-expected-relationship" class="section level3 hasAnchor" number="14.1.1">
<h3><span class="header-section-number">14.1.1</span> Specifying The Expected Relationship<a href="be-explicit.html#specifying-the-expected-relationship" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You can be explicit about what kind of relationship you expect in the join by specifying the <code>relationship</code> parameter. Your options are <code>one-to-one</code>, <code>one-to-many</code>, or <code>many-to-one</code>. Any of those will stop the code with an error if the data doesn’t match the relationship you told it to expect.</p>
<p>If you leave the <code>relationship</code> parameter blank, R will allow a many-to-many join but will raise a warning. Pay attention to your warning messages! If you know in advance that you want a many-to-many join, then you can provide the argument <code>relatonship='many-to-many'</code>, which will do the same as leaving <code>relationship</code> blank, except it will not raise the warning.</p>
</div>
<div id="using-only-distinct-rows" class="section level3 hasAnchor" number="14.1.2">
<h3><span class="header-section-number">14.1.2</span> Using Only Distinct Rows<a href="be-explicit.html#using-only-distinct-rows" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>An alternative to handling duplicate keys is to subset the data to avoid duplicates in the first place. The <code>dplyr</code> package provides a function, <code>distinct()</code>, which can help. When <code>distinct()</code> finds duplicated rows, it keeps the first one.</p>
<div class="sourceCode" id="cb610"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb610-1"><a href="be-explicit.html#cb610-1" tabindex="-1"></a><span class="co"># Example datasets</span></span>
<span id="cb610-2"><a href="be-explicit.html#cb610-2" tabindex="-1"></a>students <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb610-3"><a href="be-explicit.html#cb610-3" tabindex="-1"></a>  <span class="at">student_id =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">4</span>),</span>
<span id="cb610-4"><a href="be-explicit.html#cb610-4" tabindex="-1"></a>  <span class="at">name =</span> <span class="fu">c</span>(<span class="st">&quot;Angel&quot;</span>, <span class="st">&quot;Beto&quot;</span>, <span class="st">&quot;Cici&quot;</span>, <span class="st">&quot;Desmond&quot;</span>, <span class="st">&quot;Erik&quot;</span>))</span>
<span id="cb610-5"><a href="be-explicit.html#cb610-5" tabindex="-1"></a></span>
<span id="cb610-6"><a href="be-explicit.html#cb610-6" tabindex="-1"></a>grades <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">student_id =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">5</span>),</span>
<span id="cb610-7"><a href="be-explicit.html#cb610-7" tabindex="-1"></a>                        <span class="at">grade =</span> <span class="fu">c</span>(<span class="dv">90</span>, <span class="dv">50</span>, <span class="dv">85</span>, <span class="dv">80</span>, <span class="dv">75</span>, <span class="dv">30</span>))</span>
<span id="cb610-8"><a href="be-explicit.html#cb610-8" tabindex="-1"></a></span>
<span id="cb610-9"><a href="be-explicit.html#cb610-9" tabindex="-1"></a><span class="co"># Left join</span></span>
<span id="cb610-10"><a href="be-explicit.html#cb610-10" tabindex="-1"></a>distinct_keys_result <span class="ot">=</span> students <span class="sc">|&gt;</span> <span class="fu">distinct</span>(student_id, <span class="at">.keep_all=</span><span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb610-11"><a href="be-explicit.html#cb610-11" tabindex="-1"></a>  <span class="fu">left_join</span>(grades, <span class="at">by =</span> <span class="st">&quot;student_id&quot;</span>)</span>
<span id="cb610-12"><a href="be-explicit.html#cb610-12" tabindex="-1"></a></span>
<span id="cb610-13"><a href="be-explicit.html#cb610-13" tabindex="-1"></a><span class="co"># View the results</span></span>
<span id="cb610-14"><a href="be-explicit.html#cb610-14" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;Distinct Keys Result:&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Distinct Keys Result:&quot;</code></pre>
<div class="sourceCode" id="cb612"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb612-1"><a href="be-explicit.html#cb612-1" tabindex="-1"></a><span class="fu">print</span>(distinct_keys_result)</span></code></pre></div>
<pre><code>##   student_id    name grade
## 1          1   Angel    NA
## 2          2    Beto    90
## 3          2    Beto    50
## 4          3    Cici    85
## 5          4 Desmond    80
## 6          4 Desmond    75</code></pre>
</div>
</div>
<div id="ambiguous-columns" class="section level2 hasAnchor" number="14.2">
<h2><span class="header-section-number">14.2</span> Ambiguous Columns<a href="be-explicit.html#ambiguous-columns" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>When the two tables have columns with the same names, it is ambiguous which one to use in the result. R handles that situation by keeping both but changing the names to include the table names. So the column from the left table gets a <code>.x</code> appended by default and the column from the right table gets a <code>.y</code> appended by default. Let’s see an example. Suppose that the <code>date_created</code> column of the borrowers table had the name <code>date</code> instead. Then in the joined data it would be ambiguous with the <code>date</code> column of the checkouts table.</p>
<div class="sourceCode" id="cb614"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb614-1"><a href="be-explicit.html#cb614-1" tabindex="-1"></a><span class="co"># Rename the date_created column of borrowers</span></span>
<span id="cb614-2"><a href="be-explicit.html#cb614-2" tabindex="-1"></a>borrowers <span class="ot">=</span> <span class="fu">rename</span>(borrowers, <span class="at">date=</span>date_created)</span>
<span id="cb614-3"><a href="be-explicit.html#cb614-3" tabindex="-1"></a></span>
<span id="cb614-4"><a href="be-explicit.html#cb614-4" tabindex="-1"></a><span class="co"># Now create the list of checkouts</span></span>
<span id="cb614-5"><a href="be-explicit.html#cb614-5" tabindex="-1"></a><span class="fu">left_join</span>(checkouts, books, <span class="at">by=</span><span class="st">&quot;book_id&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb614-6"><a href="be-explicit.html#cb614-6" tabindex="-1"></a>  <span class="fu">left_join</span>(borrowers, <span class="at">by=</span><span class="st">&quot;borrower_id&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb614-7"><a href="be-explicit.html#cb614-7" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n=</span><span class="dv">10</span>, <span class="at">na.print=</span><span class="st">&quot;NA&quot;</span>)</span></code></pre></div>
<pre><code>##   borrower_id book_id checkout_date due_date
## 1           1       1      12/21/23  6/18/24
## 2           1       2        1/3/22   7/2/22
## 3           2       2      10/12/20  4/10/21
## 4           2       3        5/5/23  11/1/23
## 5           2       4      12/12/21  6/10/22
## 6           4       2        6/7/18  12/4/18
## 7           5       5       10/1/23  3/29/24
##                                     title       author subject Keywords
## 1                               my alaska     guy noir      NA       NA
## 2                                 jubilee       charro      NA       NA
## 3                                 jubilee       charro      NA       NA
## 4     the window ruiner ruined my windows    zipperman      NA       NA
## 5                    clowns in the clouds    dark doug      NA       NA
## 6                                 jubilee       charro      NA       NA
## 7 dogs walked, tigers tamed, bars emptied lucky pierre      NA       NA
##   minority_author Description. Contents. Series. Pages. Publisher.
## 1              NA           NA        NA      NA    100         NA
## 2              NA           NA        NA      NA    100         NA
## 3              NA           NA        NA      NA    100         NA
## 4              NA           NA        NA      NA    100         NA
## 5              NA           NA        NA      NA    100         NA
## 6              NA           NA        NA      NA    100         NA
## 7              NA           NA        NA      NA    100         NA
##   creation_date publication_date Edition. format venue Language. Source.
## 1            NA               NA       NA     NA    NA        NA      NA
## 2            NA               NA       NA     NA    NA        NA      NA
## 3            NA               NA       NA     NA    NA        NA      NA
## 4            NA               NA       NA     NA    NA        NA      NA
## 5            NA               NA       NA     NA    NA        NA      NA
## 6            NA               NA       NA     NA    NA        NA      NA
## 7            NA               NA       NA     NA    NA        NA      NA
##   Identifier. ISBN. location copies type Barcode. account_type major date
## 1          NA    NA       NA     NA   NA       NA      student    NA   NA
## 2          NA    NA       NA     NA   NA       NA      student    NA   NA
## 3          NA    NA       NA     NA   NA       NA        staff    NA   NA
## 4          NA    NA       NA     NA   NA       NA        staff    NA   NA
## 5          NA    NA       NA     NA   NA       NA        staff    NA   NA
## 6          NA    NA       NA     NA   NA       NA      student    NA   NA
## 7          NA    NA       NA     NA   NA       NA      faculty    NA   NA</code></pre>
<p>If you aren’t satisfied with appending <code>.x</code> and <code>.y</code> to the ambiguous columns, then you can specify the <code>suffix</code> argument with a pair of strings like this:</p>
<div class="sourceCode" id="cb616"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb616-1"><a href="be-explicit.html#cb616-1" tabindex="-1"></a><span class="co"># Now create the list of checkouts</span></span>
<span id="cb616-2"><a href="be-explicit.html#cb616-2" tabindex="-1"></a><span class="fu">left_join</span>(checkouts, books, <span class="at">by=</span><span class="st">&quot;book_id&quot;</span>, <span class="at">suffix=</span><span class="fu">c</span>(<span class="st">&quot;_checkout&quot;</span>, <span class="st">&quot;_book&quot;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb616-3"><a href="be-explicit.html#cb616-3" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n=</span><span class="dv">10</span>, <span class="at">na.print=</span><span class="st">&quot;NA&quot;</span>)</span></code></pre></div>
<pre><code>##   borrower_id book_id checkout_date due_date
## 1           1       1      12/21/23  6/18/24
## 2           1       2        1/3/22   7/2/22
## 3           2       2      10/12/20  4/10/21
## 4           2       3        5/5/23  11/1/23
## 5           2       4      12/12/21  6/10/22
## 6           4       2        6/7/18  12/4/18
## 7           5       5       10/1/23  3/29/24
##                                     title       author subject Keywords
## 1                               my alaska     guy noir      NA       NA
## 2                                 jubilee       charro      NA       NA
## 3                                 jubilee       charro      NA       NA
## 4     the window ruiner ruined my windows    zipperman      NA       NA
## 5                    clowns in the clouds    dark doug      NA       NA
## 6                                 jubilee       charro      NA       NA
## 7 dogs walked, tigers tamed, bars emptied lucky pierre      NA       NA
##   minority_author Description. Contents. Series. Pages. Publisher.
## 1              NA           NA        NA      NA    100         NA
## 2              NA           NA        NA      NA    100         NA
## 3              NA           NA        NA      NA    100         NA
## 4              NA           NA        NA      NA    100         NA
## 5              NA           NA        NA      NA    100         NA
## 6              NA           NA        NA      NA    100         NA
## 7              NA           NA        NA      NA    100         NA
##   creation_date publication_date Edition. format venue Language. Source.
## 1            NA               NA       NA     NA    NA        NA      NA
## 2            NA               NA       NA     NA    NA        NA      NA
## 3            NA               NA       NA     NA    NA        NA      NA
## 4            NA               NA       NA     NA    NA        NA      NA
## 5            NA               NA       NA     NA    NA        NA      NA
## 6            NA               NA       NA     NA    NA        NA      NA
## 7            NA               NA       NA     NA    NA        NA      NA
##   Identifier. ISBN. location copies type Barcode.
## 1          NA    NA       NA     NA   NA       NA
## 2          NA    NA       NA     NA   NA       NA
## 3          NA    NA       NA     NA   NA       NA
## 4          NA    NA       NA     NA   NA       NA
## 5          NA    NA       NA     NA   NA       NA
## 6          NA    NA       NA     NA   NA       NA
## 7          NA    NA       NA     NA   NA       NA</code></pre>
<p>By specifying the <code>suffix</code> argument, we get column names in the result with more meaningful names.</p>
</div>
<div id="missing-values" class="section level2 hasAnchor" number="14.3">
<h2><span class="header-section-number">14.3</span> Missing Values<a href="be-explicit.html#missing-values" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The <code>dplyr</code> package has a default behavior that I think is dangerous. In the conditions of a join, <code>NA==NA</code> evaluates to <code>TRUE</code>, which is unlike the behavior anywhere else in R. This means that keys identified as <code>NA</code> will match other <code>NA</code>s in the join. This is a very strong assumption that seems to contradict the idea of a missing value since if we actually don’t know two keys, how can we say that they match? And if we know two keys have the same value then they should be labeled in the data. In my opinion, it’s a mistake to have the computer make strong assumptions by default, and especially if it does so without warning the user. Fortunately, there is a way to make the more sensible decision that <code>NA</code>s don’t match anything: include the argument <code>na_matches='never'</code> in the join.</p>
<div class="sourceCode" id="cb618"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb618-1"><a href="be-explicit.html#cb618-1" tabindex="-1"></a><span class="co"># Example datasets</span></span>
<span id="cb618-2"><a href="be-explicit.html#cb618-2" tabindex="-1"></a>students <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb618-3"><a href="be-explicit.html#cb618-3" tabindex="-1"></a>  <span class="at">student_id =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="cn">NA</span>, <span class="dv">3</span>, <span class="dv">4</span>),</span>
<span id="cb618-4"><a href="be-explicit.html#cb618-4" tabindex="-1"></a>  <span class="at">name =</span> <span class="fu">c</span>(<span class="st">&quot;Angel&quot;</span>, <span class="st">&quot;Beto&quot;</span>, <span class="st">&quot;Cici&quot;</span>, <span class="st">&quot;Desmond&quot;</span>))</span>
<span id="cb618-5"><a href="be-explicit.html#cb618-5" tabindex="-1"></a></span>
<span id="cb618-6"><a href="be-explicit.html#cb618-6" tabindex="-1"></a>grades <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">student_id =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="cn">NA</span>, <span class="dv">4</span>, <span class="dv">5</span>),</span>
<span id="cb618-7"><a href="be-explicit.html#cb618-7" tabindex="-1"></a>                        <span class="at">grade =</span> <span class="fu">c</span>(<span class="dv">90</span>, <span class="dv">85</span>, <span class="dv">80</span>, <span class="dv">75</span>))</span>
<span id="cb618-8"><a href="be-explicit.html#cb618-8" tabindex="-1"></a></span>
<span id="cb618-9"><a href="be-explicit.html#cb618-9" tabindex="-1"></a><span class="co"># Left join</span></span>
<span id="cb618-10"><a href="be-explicit.html#cb618-10" tabindex="-1"></a>default_result <span class="ot">=</span> <span class="fu">left_join</span>(students, grades, <span class="at">by =</span> <span class="st">&quot;student_id&quot;</span>)</span>
<span id="cb618-11"><a href="be-explicit.html#cb618-11" tabindex="-1"></a>na_never_result <span class="ot">=</span> <span class="fu">left_join</span>(students, grades,</span>
<span id="cb618-12"><a href="be-explicit.html#cb618-12" tabindex="-1"></a>                            <span class="at">by =</span> <span class="st">&quot;student_id&quot;</span>, <span class="at">na_matches =</span> <span class="st">&quot;never&quot;</span>)</span>
<span id="cb618-13"><a href="be-explicit.html#cb618-13" tabindex="-1"></a></span>
<span id="cb618-14"><a href="be-explicit.html#cb618-14" tabindex="-1"></a><span class="co"># View the results</span></span>
<span id="cb618-15"><a href="be-explicit.html#cb618-15" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;Default Result:&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Default Result:&quot;</code></pre>
<div class="sourceCode" id="cb620"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb620-1"><a href="be-explicit.html#cb620-1" tabindex="-1"></a><span class="fu">print</span>(default_result)</span></code></pre></div>
<pre><code>##   student_id    name grade
## 1          1   Angel    NA
## 2         NA    Beto    85
## 3          3    Cici    NA
## 4          4 Desmond    80</code></pre>
<div class="sourceCode" id="cb622"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb622-1"><a href="be-explicit.html#cb622-1" tabindex="-1"></a><span class="co"># View the results</span></span>
<span id="cb622-2"><a href="be-explicit.html#cb622-2" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">na_matches = &#39;never&#39; Result:&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;\nna_matches = &#39;never&#39; Result:&quot;</code></pre>
<div class="sourceCode" id="cb624"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb624-1"><a href="be-explicit.html#cb624-1" tabindex="-1"></a><span class="fu">print</span>(na_never_result)</span></code></pre></div>
<pre><code>##   student_id    name grade
## 1          1   Angel    NA
## 2         NA    Beto    NA
## 3          3    Cici    NA
## 4          4 Desmond    80</code></pre>
<p>Notice that since Beto’s student ID is <code>NA</code>, none of the rows in the <code>grades</code> table can match him. As a result, his grade is left <code>NA</code> in the result.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="examples.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="conclusion.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/ucdavisdatalab/workshop_intermediate_r/edit/master/xx_joins.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/ucdavisdatalab/workshop_intermediate_r/blob/master/xx_joins.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
